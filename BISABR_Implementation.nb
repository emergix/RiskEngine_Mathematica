(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    454541,      11140]
NotebookOptionsPosition[    428568,      10750]
NotebookOutlinePosition[    429095,      10769]
CellTagsIndexPosition[    429052,      10766]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "\"\<C:\>\"", ",", " ", "\"\<Users\>\"", ",", "\"\<emerg\>\"", ",", 
     "\"\<Desktop\>\"", ",", "\"\<Mathematica\>\"", ",", 
     "\"\<Mathematica\>\"", ",", "\"\<Math\>\"", ",", 
     "\"\<NumericalIntegration.m\>\""}], " ", "}"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438084708463805*^9, 3.438084723338635*^9}, 
   3.4380853908756237`*^9, {3.9623550304193926`*^9, 3.9623550651062365`*^9}, {
   3.962355128261039*^9, 3.962355174202306*^9}, 3.96235526234984*^9, {
   3.962355341147415*^9, 3.9623553724224186`*^9}, {3.9623559083131924`*^9, 
   3.962355917518331*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"1e4a8107-9433-48f6-ab55-996258c0532d"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "\"\<C:\>\"", ",", " ", "\"\<Users\>\"", ",", "\"\<emerg\>\"", ",", 
     "\"\<Desktop\>\"", ",", "\"\<Mathematica\>\"", ",", 
     "\"\<Mathematica\>\"", ",", "\"\<Math\>\"", ",", "\"\<BS.m\>\""}], " ", 
    "}"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.438084743764517*^9, 3.4380853936989517`*^9, {3.962355392922822*^9, 
   3.962355423549549*^9}, {3.962355949729091*^9, 3.9623559635617776`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3440456b-ffb3-4599-9b7c-a8955091c046"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "\"\<C:\>\"", ",", " ", "\"\<Users\>\"", ",", "\"\<emerg\>\"", ",", 
     "\"\<Desktop\>\"", ",", "\"\<Mathematica\>\"", ",", 
     "\"\<Mathematica\>\"", ",", "\"\<Math\>\"", ",", "\"\<SABR.m\>\""}], " ",
     "}"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.4380847512765102`*^9, 3.438085396765018*^9, {3.9623554468444595`*^9, 
   3.9623554752114763`*^9}, {3.962355515994776*^9, 3.962355533171708*^9}, {
   3.962355971612458*^9, 3.9623559801578617`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d14e797b-9239-4702-8c03-f203d506efca"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "\"\<C:\>\"", ",", " ", "\"\<Users\>\"", ",", "\"\<emerg\>\"", ",", 
     "\"\<Desktop\>\"", ",", "\"\<Mathematica\>\"", ",", 
     "\"\<Mathematica\>\"", ",", "\"\<Math\>\"", ",", 
     "\"\<Heston_Definitif5.m\>\""}], " ", "}"}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380811045644245`*^9, 3.4380811183502607`*^9}, 
   3.438084760604393*^9, 3.438085401474907*^9, {3.9623561016821146`*^9, 
   3.9623561296669235`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"af84121c-77ce-4aac-ac7e-5ffd8f5ea89e"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "\"\<spell\>\""}], "]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"6c20c985-8b1e-429d-a82c-4d0e89a02638"],

Cell[BoxData[
 RowBox[{"Fonctions", " ", "utiles"}]], "Input",
 Background->RGBColor[
  0.372549, 0.709804, 
   0.988235],ExpressionUUID->"e59ce4ad-b927-4d5b-a7e6-7d5269d8e2d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Performs", " ", "the", " ", 
   RowBox[{"integral", " ", ":", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "x"], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], 
         SuperscriptBox["s", "2"]}], "-", 
        FractionBox[
         SuperscriptBox["b", "2"], 
         SuperscriptBox["s", "2"]]}]], 
      RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "=", 
  RowBox[{"GIntegralAnalytical", "[", 
   RowBox[{"a", ",", "b", ",", "x"}], "]"}]}]], "Input",
 Background->GrayLevel[0.900008],
 CellLabel->"In[22]:=",ExpressionUUID->"27c56f3a-56f1-4b31-9d34-2a5cfd0fcd56"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.962356344526764*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"0b609f85-4899-471e-b3f9-857e712b75be"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GIntegralAnalytical", "[", 
   RowBox[{"a1_", ",", "b1_", ",", "x1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"Abs", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Abs", "[", "b1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Abs", "[", "a1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "a", "]"}], ">", "0.001"}], ",", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SqrtBox["\[Pi]"], 
            RowBox[{" ", 
             RowBox[{"4", "a"}]}]], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", " ", "2"}], "a", "  ", "b"}]], "  ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"4", "  ", "a", " ", "b"}]], "+", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", "  ", "a", " ", "b"}]], " ", 
                RowBox[{"Erf", "[", 
                 RowBox[{
                  FractionBox["b", "x"], "+", 
                  RowBox[{"a", " ", "x"}]}], "]"}]}], "-", 
               RowBox[{"Erf", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{" ", "b"}], 
                  RowBox[{" ", "x"}]], "-", 
                 RowBox[{"a", " ", "x"}]}], "]"}]}], ")"}]}], ")"}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "b"}], " ", 
              SqrtBox["\[Pi]"]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]}]], " ", "x"}], "+", 
             RowBox[{"b", " ", 
              SqrtBox["\[Pi]"], " ", 
              RowBox[{"Erf", "[", 
               FractionBox["b", "x"], "]"}]}]}], ")"}], "+", 
           RowBox[{
            FractionBox["1", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                  FractionBox[
                   SuperscriptBox["b", "2"], 
                   SuperscriptBox["x", "2"]]}]]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["b", "3"], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   FractionBox[
                    SuperscriptBox["b", "2"], 
                    SuperscriptBox["x", "2"]]], " ", 
                  SqrtBox["\[Pi]"]}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"], " ", "x"}], "+", 
                 SuperscriptBox["x", "3"]}], ")"}]}], "+", 
              RowBox[{"2", 
               SuperscriptBox["b", "3"], " ", 
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"Erf", "[", 
                FractionBox["b", "x"], "]"}]}]}], ")"}], " ", 
            SuperscriptBox["a", "2"]}], "+", 
           RowBox[{
            FractionBox["1", "30"], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["b", "2"], 
               SuperscriptBox["x", "2"]]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               SuperscriptBox["b", "5"], " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]], " ", 
               SqrtBox["\[Pi]"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["b", "4"], " ", "x"}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["b", "2"], " ", 
               SuperscriptBox["x", "3"]}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["x", "5"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["b", "5"], " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]], " ", 
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"Erf", "[", 
                FractionBox["b", "x"], "]"}]}]}], ")"}], " ", 
            SuperscriptBox["a", "4"]}]}], ")"}]}]}], "\[IndentingNewLine]", 
       "]"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[23]:=",ExpressionUUID->"b043041e-acf1-497c-b2cd-85366584c727"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "If", " ", "we", " ", "use", " ", "the", " ", "No", " ", "function", " ", 
   "defined", " ", "by", "  ", 
   RowBox[{"No", "[", "x", "]"}]}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Erf", "[", 
     FractionBox["x", 
      SqrtBox["2"]], "]"}]}], "+", 
   FractionBox["1", "2"]}]}]], "Input",ExpressionUUID->"286058d7-1993-44df-\
b72e-f3cd0cfd50d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"the", " ", "ATM", " ", "is", " ", "caracterized", " ", 
   RowBox[{"by", " ", ":", " ", "b1"}]}], "=", "0"}]], "Input",ExpressionUUID->\
"599ee6b9-0cd9-4baf-9942-198bf2c9fc71"],

Cell[BoxData[
 RowBox[{"Implementation", " ", "of", " ", "GIntegralAnalytical", "  ", 
  "using", " ", "NormalCDF", " ", "function"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"fb12fc41-fddb-4996-806d-c7f67ceef7f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GIntegralAnalytical1", "[", 
   RowBox[{"a1_", ",", "b1_", ",", "x1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"Abs", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Abs", "[", "b1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Abs", "[", "a1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "a", "]"}], ">", "0.001"}], ",", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a", " ", "b"}]], " ", 
           SqrtBox["\[Pi]"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a", " ", "b"}]], "-", 
             RowBox[{"NormalCDF", "[", 
              RowBox[{
               SqrtBox["2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["b", "x"], "-", 
                 RowBox[{"a", " ", "x"}]}], ")"}]}], "]"}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"4", " ", "a", " ", "b"}]], " ", 
              RowBox[{"NormalCDF", "[", 
               RowBox[{
                SqrtBox["2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["b", "x"], "+", 
                  RowBox[{"a", " ", "x"}]}], ")"}]}], "]"}]}]}], ")"}], " "}], 
          RowBox[{"2", " ", "a"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"Sign", "[", "x1", "]"}], "30"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["b", "2"], 
               SuperscriptBox["x", "2"]]}]], " ", "x", " ", 
            RowBox[{"(", 
             RowBox[{"30", "+", 
              RowBox[{"10", " ", 
               SuperscriptBox["a", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"]}], "-", 
                 SuperscriptBox["x", "2"]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["a", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["b", "4"]}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"], " ", 
                  SuperscriptBox["x", "2"]}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["x", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", "b", " ", 
            RowBox[{"(", 
             RowBox[{"15", "+", 
              RowBox[{"10", " ", 
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox["b", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["a", "4"], " ", 
               SuperscriptBox["b", "4"]}]}], ")"}], " ", 
            SqrtBox["\[Pi]"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"NormalCDF", "[", 
               FractionBox[
                RowBox[{
                 SqrtBox["2"], " ", "b"}], "x"], "]"}]}], ")"}]}]}], 
          ")"}]}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[24]:=",ExpressionUUID->"238b16c6-adc6-4de2-90e2-96a693e4e899"],

Cell[BoxData[
 RowBox[{"Computes", "  ", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "A", "B"], 
   RowBox[{
    FractionBox[
     SuperscriptBox["r", "\[Gamma]"], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["r", 
        RowBox[{"2", " "}]], "-", " ", 
       RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], 
    RowBox[{"\[DifferentialD]", "r"}]}]}]}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"190b44bf-4909-44ba-962d-28b28b3e3f46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegral", "[", 
   RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<A=\>\"", ",", "A", ",", "\"\< B=\>\"", ",", "B", ",", 
       "\"\< G=\>\"", ",", "G", ",", "\"\< F=\>\"", ",", "F", ",", 
       "\"\< \[Gamma]=\>\"", ",", "\[Gamma]", ",", "\"\< roots=\>\"", ",", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["r", 
            RowBox[{"2", " "}]], "-", " ", 
           RowBox[{"r", " ", "G"}], " ", "+", "F"}], "\[Equal]", "0"}], ",", 
         "r"}], "]"}], ",", "\[IndentingNewLine]", "\"\< X1=\>\"", ",", 
       RowBox[{"AppellF1", "[", 
        RowBox[{
         RowBox[{"1", "+", "\[Gamma]"}], ",", 
         FractionBox["1", "2"], ",", 
         FractionBox["1", "2"], ",", 
         RowBox[{"2", "+", "\[Gamma]"}], ",", 
         FractionBox[
          RowBox[{"2", " ", "A"}], 
          RowBox[{"G", "-", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", "A"}], 
          RowBox[{"G", "+", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]]}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\< X2=\>\"", ",", 
       RowBox[{"AppellF1", "[", 
        RowBox[{
         RowBox[{"1", "+", "\[Gamma]"}], ",", 
         FractionBox["1", "2"], ",", 
         FractionBox["1", "2"], ",", 
         RowBox[{"2", "+", "\[Gamma]"}], ",", 
         FractionBox[
          RowBox[{"2", " ", "B"}], 
          RowBox[{"G", "-", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", "B"}], 
          RowBox[{"G", "+", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SqrtBox["F"], "  ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Gamma]"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["A", 
           RowBox[{"1", "+", "\[Gamma]"}]]}], "  ", 
         RowBox[{"AppellF1", "[", 
          RowBox[{
           RowBox[{"1", "+", "\[Gamma]"}], ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", 
           RowBox[{"2", "+", "\[Gamma]"}], ",", 
           FractionBox[
            RowBox[{"2", " ", "A"}], 
            RowBox[{"G", "-", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]], ",", 
           FractionBox[
            RowBox[{"2", " ", "A"}], 
            RowBox[{"G", "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["B", 
          RowBox[{"1", "+", "\[Gamma]"}]], "  ", 
         RowBox[{"AppellF1", "[", 
          RowBox[{
           RowBox[{"1", "+", "\[Gamma]"}], ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", 
           RowBox[{"2", "+", "\[Gamma]"}], ",", 
           FractionBox[
            RowBox[{"2", " ", "B"}], 
            RowBox[{"G", "-", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]], ",", 
           FractionBox[
            RowBox[{"2", " ", "B"}], 
            RowBox[{"G", "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]]}], "]"}]}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[25]:=",ExpressionUUID->"199b16a4-e0c3-4b7f-aee3-da2698fea49a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegral", "[", 
   RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], "}"}], ",", 
    RowBox[{"BiSABRIntegralN", "[", 
     RowBox[{
     "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", "legendrelst"}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[26]:=",ExpressionUUID->"d00e40ad-4744-469e-a17b-a8d9820ec32f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegralN", "[", 
   RowBox[{
   "A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_", ",", 
    "legendrelst_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoeffBasedIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["#", "\[Gamma]"], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["#", 
            RowBox[{"2", " "}]], "-", " ", 
           RowBox[{"#", "G"}], " ", "+", "F"}]]], ")"}], "&"}], ",", 
      RowBox[{"LegendreCoeffsFromLegendre", "[", 
       RowBox[{"legendrelst", ",", "A", ",", "B"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[27]:=",ExpressionUUID->"d4604c2d-b7be-4dda-9377-74a3ab5e789b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "1.2"}], ",", 
     RowBox[{"B", "=", "3.5"}], ",", 
     RowBox[{"F", "=", "3.4"}], ",", 
     RowBox[{"G", "=", "0.9"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.54"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BiSABRIntegralN", "[", 
      RowBox[{
      "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", 
       "legendrelst"}], "]"}], ",", 
     RowBox[{"BiSABRIntegral", "[", 
      RowBox[{"A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"a1ce52c0-938e-4f3d-85e5-e39b97e70ece"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3668051250803241`", ",", "1.3668051250803241`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9623563726289005`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"ad8355c0-5596-47b8-9103-acd264d5f2a3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\"\<A=\>\"", "\[InvisibleSpace]", "0.1445206290517883`", 
  "\[InvisibleSpace]", "\"\< B=\>\"", "\[InvisibleSpace]", 
  "0.14883523895735173`", "\[InvisibleSpace]", "\"\< G=\>\"", 
  "\[InvisibleSpace]", "0.24226344208464132`", "\[InvisibleSpace]", 
  "\"\< F=\>\"", "\[InvisibleSpace]", "0.022926396629179044`", 
  "\[InvisibleSpace]", "\"\< \[Gamma]=\>\"", "\[InvisibleSpace]", 
  "0.6666666666666667`", "\[InvisibleSpace]"}]], "Input",ExpressionUUID->\
"777ac47e-e4f2-430d-b84b-8408061e3ab9"],

Cell[BoxData[
 RowBox[{"Computation", " ", 
  RowBox[{"of", " ", ":"}]}]], "Input",ExpressionUUID->"41231391-4357-41d7-\
96e3-5b1c310e2d4d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "\[InvisibleSpace]", "0.1445206290517883"}], ",", 
     RowBox[{"B", "=", "\[InvisibleSpace]", "0.14883523895735173"}], ",", 
     RowBox[{"F", "=", "\[InvisibleSpace]", "0.022926396629179044"}], ",", 
     RowBox[{"G", "=", "0.24226344208464132"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.66666666666666674"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BiSABRIntegralN", "[", 
      RowBox[{
      "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", 
       "legendrelst"}], "]"}], ",", 
     RowBox[{"BiSABRIntegral", "[", 
      RowBox[{"A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"cd488d18-b8b7-4555-aa6b-f2bd9fc22809"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.012714488324704634`", ",", "0.012714488324704634`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.962356380996267*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"fc325c11-a8af-478b-96a5-3041d998fb1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "\[InvisibleSpace]", "0.1445206290517883"}], ",", 
     RowBox[{"B", "=", "\[InvisibleSpace]", "0.14883523895735173"}], ",", 
     RowBox[{"F", "=", "\[InvisibleSpace]", "0.022926396629179044"}], ",", 
     RowBox[{"G", "=", "0.24226344208464132"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.66666666666666674"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["r", "\[Gamma]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", 
         RowBox[{"2", " "}]], "-", " ", 
        RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "A", ",", "B"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"2a350150-f153-4b8e-8b4f-0c7abdfe5ccf"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwV0nsw1WkYB3Dtrn3DUS2z1FKcUCQVkllaz6vsRsUIFU4zOmsZm6kj0aol
jpxLte6Wjj2urY4ROXI50Y33F7ZEF+1pXDpd7Cxp5TLTqonss3+8885n5p3n
fb7P+/K/FwVFfaKnp+eP6/+dL3w+ejGVwZh1m5ifTGhgkGLRFbRRvW2KHfrU
9iCLG+iOxqQkB/Sw3e2AfrQn/+kRZ3TRuKp5Aa3MKgr3RhsniE6HpjGw7Xzk
JES/l35cZShm8KVzJFeOflhrue9wOoMdkqkaqxRC89v8pCIJA05rXup8itCP
GcdrveQMHot0rzemEnr2qq9m4SwDn/BR7do0Qu0vG2XMZTIw19i7uYoJPXKw
77uuHAbHNkT5OKYT2v1Y3NOTz6BpqyJ1y2lCva8MbuYKGUCHsZdnBqGRu10L
ZAoGIVy9vpME+69ObpYpGUwbm1c4SwlN6Oi8F1LGIOB0Q7yNjND47U1/mFYy
KKg4z18qJzRdli9dUsXAiZcRYHyGUA95vIdWxaCRZ0Peo/V3bVMP1DBYfCxw
9t+zhE4f1xjer2NQ5rH60ptzhEoi1gty1Qz2q2e9H/9CqKNh3uHsRgYpLg6t
PZmEnjg6mxjewkCkmYKGLEIHi/2psBXrsysHq7MJPeDkNxl2nUG2ThqjyCFU
muxTYHWLQfnPW58k5RLKMjd9sGYM1vAH5D/mEaoSWIZO3mYQd3Os1zef0Lq8
OkV9NwMvvw3BqwsI7Ty3seTSXQaxTs1dvF+xP++GwoReBg/Ndqz+Gx3aahN0
4gGDd6rMNQ8KCd1d7Dkj6sc8sf17mooIHXMPlrtqGbQ/S70mO09oYZHgucsA
g74fBn6KVRA60Ri5YWGIwfJOdalXMaFRX38hvKFjUFzT4sP7jdDJtPq9mhf4
frfvvXqF5kv86am/GDhGG/hrlIRG7xr+J22UgVVH5aGCEkKD+w5lB45jPavE
eGEpocK2UjOTCQbzbn9aOJQRKo7hIpZOMQjrXbFer5zQnf2jpQMzDAbNXU92
o+305suevcXzvsrxkgq8r1AjefIOvf/RyJFKnMfYUaHyAwMTl01xmy4Qmjxv
uaD8yGCPteldvd8JHerrzju0iANdev3LDrTAYLnRus84yLb/ZiilCvPqh31r
RzhYYvI6wPci/tdbisQJAw7SW2b6P1VhfveaF+/RGYvczAi6sr7N/3NDDiLE
B0IN0RblQ3ZWaBdrwfAy9BLxSm0gWqAzG1mJfrutYksTuj1Z/todzbqqZ08a
caDetncsFr3g1RopQ78Vea0Vobdq7tzPR9doedHx6GbVuKoWPRMYNpKErpav
D9WhTefVwxJ01k71VW8eB43Bgrtl6B7WbhuAdnI4Ty6gF3s+zAlHR3q0+VxE
ix1nYo6h85ddvlmLTuBtXlGFNskJaWhFN2T4SBrQcTuuTVxHv5kLmb6BrvMk
69rRMROJd7TomKGAyi50VZTUbQTtINupu4N++bSwYhIdEef4VS961T6V8Rza
uWh67wO0oE9zYrExB+yDMrcf/R+t+zUC
       "]]},
     Annotation[#, "Charting`Private`Tag$44812#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.1445206290517883, 2.9356107840468333`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0.1445206290517883, 0.14883523895735173`}, {
   2.9356107840468333`, 2.956946504214529}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9623563851779413`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"4d015b7e-6789-4414-bbde-271de994a755"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"z", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]"}]], " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "K", "f"], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"C", "[", "s", "]"}]], 
       RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "  ", ";", 
   RowBox[{"b1", "=", 
    RowBox[{
     SuperscriptBox["C", "\[Prime]",
      MultilineFunction->None], "[", "f", "]"}]}], ";", 
   RowBox[{"b2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["C", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "f", "]"}], 
      RowBox[{"C", "[", "f", "]"}]}], "+", 
     SuperscriptBox["b1", "2"]}]}], ";", 
   RowBox[{"B0B\[Alpha]z", "=", 
    RowBox[{
     RowBox[{"C", "[", "K", "]"}], 
     RowBox[{"C", "[", "f", "]"}]}]}]}]}]], "Input",
 Background->GrayLevel[0.900008],
 CellLabel->"In[31]:=",ExpressionUUID->"7b7fb29a-15af-426f-9e46-0b10811edae5"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"f"},
   "C"], " ", 
  TemplateBox[{"K"},
   "C"]}]], "Output",
 CellChangeTimes->{3.9623563883423195`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"3f506456-61ab-451b-acfd-3a9964f0a28b"]
}, Open  ]],

Cell[BoxData["with"], "Input",ExpressionUUID->"95011c91-8910-45e3-a1a1-14a93765129c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"C", "[", "f", "]"}], "=", 
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["F1", 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["F1", "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]]]}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"eb5c990e-1df2-493e-9a84-5c44329dd472"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRIntegral", "[", 
    RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], 
   "  ", "computes", "  ", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "A", "B"], 
    RowBox[{
     FractionBox[
      SuperscriptBox["r", "\[Gamma]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", 
         RowBox[{"2", " "}]], "-", " ", 
        RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], 
     RowBox[{"\[DifferentialD]", "r"}]}]}]}], " ", ";", "  ", 
  RowBox[{"so", " ", "..."}]}]], "Input",ExpressionUUID->"ec421e99-808b-4f84-\
9db6-b7aee7f77c38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRz", "[", 
   RowBox[{
   "K_", ",", "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", 
    "\[Rho]s_", ",", "\[Beta]1_", ",", "\[Beta]2_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[Alpha]1", " ", "\[Beta]1"}]], 
   RowBox[{"BiSABRIntegral", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"K", "+", "F2"}], ")"}], "\[Beta]1"], ",", 
     SuperscriptBox[
      RowBox[{"(", "F1", ")"}], "\[Beta]1"], ",", 
     FractionBox[
      RowBox[{"2", "  ", 
       SuperscriptBox["F2", "\[Beta]2"], "  ", "\[Alpha]2", " ", "\[Rho]s"}], 
      "\[Alpha]1"], ",", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Alpha]2", "\[Alpha]1"], ")"}], "2"]}], ",", 
     FractionBox[
      RowBox[{"1", "-", "\[Beta]1"}], "\[Beta]1"]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[32]:=",ExpressionUUID->"149d1178-bd69-4db0-a3a8-89327ed8a527"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRz", "[", 
   RowBox[{
   "K_", ",", "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", 
    "\[Rho]s_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", "legendrelst_"}], 
   "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[Alpha]1", " ", "\[Beta]1"}]], 
   RowBox[{"BiSABRIntegralN", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"K", "+", "F2"}], ")"}], "\[Beta]1"], ",", 
     SuperscriptBox[
      RowBox[{"(", "F1", ")"}], "\[Beta]1"], ",", 
     FractionBox[
      RowBox[{"2", "  ", 
       SuperscriptBox["F2", "\[Beta]2"], "  ", "\[Alpha]2", " ", "\[Rho]s"}], 
      "\[Alpha]1"], ",", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Alpha]2", "\[Alpha]1"], ")"}], "2"]}], ",", 
     FractionBox[
      RowBox[{"1", "-", "\[Beta]1"}], "\[Beta]1"], ",", "legendrelst"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[33]:=",ExpressionUUID->"83555f13-e44a-4517-8644-69671fdba21a"],

Cell[BoxData[""], "Input",ExpressionUUID->"28770d39-05ea-4947-8d2d-63a690ac07a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"-", "0.1"}]}], ",", 
     RowBox[{"F1", "=", "0.0418"}], ",", 
     RowBox[{"F2", "=", "0.00728"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0.041402972188513"}], ",", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.7"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"BiSABRz", "[", 
    RowBox[{
    "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
     "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"43496094-0a2f-4699-ae95-93e98ef0e9dd"],

Cell[BoxData[
 RowBox[{"5.592368775172879`", "\[VeryThinSpace]", "-", 
  RowBox[{"2.0603526551973053`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.9623564147346697`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"399eac90-3238-4fca-aa5f-b68141b78d79"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Csabr", "[", 
   RowBox[{
   "f_", ",", "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "F2_", ",", 
    "\[Alpha]2_", ",", "\[Beta]2_", ",", "\[Rho]s_"}], "]"}], ":=", 
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["F1", 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["F1", "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]]]}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"57617372-40ae-4718-964c-f464c2eba987"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"-", "0.1"}]}], ",", 
     RowBox[{"F1", "=", "0.0418"}], ",", 
     RowBox[{"F2", "=", "0.00728"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0.041402972188513"}], ",", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "f"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Csabr", "[", 
        RowBox[{
        "fx", ",", "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "F2", ",", 
         "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]s"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"fx", ",", 
        RowBox[{"K", "-", "0.01"}], ",", "f"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"5fa16a89-3039-4ca5-ba3d-df48400c574e"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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
gkX4IPj4eKS4hgsnwp1lhIT48D8VA5fk
       "]]},
     Annotation[#, "Charting`Private`Tag$46139#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 1.0000000496575314`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-0.11, 0.034519999999999995`}, {1.0000000496575314`, 
   7.025586910851553}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.962356423368765*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"23306dd9-68c0-4fbb-9fa0-719f6dc15260"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Definition", " ", "of", " ", "AppellF1"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"6e448eb0-f631-4fd7-83c9-3115a0e07a19"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "0"}], "\[Infinity]"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"l", "=", "0"}], "\[Infinity]"], 
     FractionBox[
      RowBox[{
       RowBox[{"Pochhammer", "[", 
        RowBox[{"a", ",", 
         RowBox[{"k", "+", "l"}]}], "]"}], " ", 
       RowBox[{"Pochhammer", "[", 
        RowBox[{
         SubscriptBox["b", "1"], ",", "k"}], "]"}], " ", 
       RowBox[{"Pochhammer", "[", 
        RowBox[{
         SubscriptBox["b", "2"], ",", "l"}], "]"}], " ", 
       SubsuperscriptBox["z", "1", "k"], " ", 
       SubsuperscriptBox["z", "2", "l"]}], 
      RowBox[{
       RowBox[{"Pochhammer", "[", 
        RowBox[{"c", ",", 
         RowBox[{"k", "+", "l"}]}], "]"}], " ", 
       RowBox[{"k", "!"}], " ", 
       RowBox[{"l", "!"}]}]]}]}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "1"], "]"}], "<", "1"}], "\[And]", 
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "2"], "]"}], "<", "1"}]}]}]],ExpressionUUID->"82ea0a7f-\
15a3-449a-9484-71f7d98bf7a9"],

Cell[BoxData[
 RowBox[{"low", " ", "order", " ", "development"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"9d2cab31-11a2-4db1-a8d7-3ac4ce06fcef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"a", " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["z", "1"]}], "c"], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubsuperscriptBox["z", "1", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      SubscriptBox["b", "2"], " ", 
      SubscriptBox["z", "2"]}], "c"], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["b", "2"], " ", 
      SubscriptBox["z", "1"], " ", 
      SubscriptBox["z", "2"]}], 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      SubsuperscriptBox["z", "1", "2"], " ", 
      SubscriptBox["z", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubscriptBox["z", "1"], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubsuperscriptBox["z", "1", "2"], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"4", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "c"}], ")"}]}]], "+", "\[Ellipsis]"}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "1"], "]"}], "<", "1"}], "\[And]", 
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "2"], "]"}], "<", "1"}]}]}]],ExpressionUUID->"c12a2338-\
427c-442e-817a-99be9bf67314"],

Cell[BoxData[
 RowBox[{"general", " ", "development"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"58f48ef9-061f-43fc-91bb-000de8fa528c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{"Gamma", "[", "c", "]"}], 
    RowBox[{" ", 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}], 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "2"], "]"}]}]}]], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "0"}], "\[Infinity]"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "0"}], "\[Infinity]"], 
     RowBox[{"Residue", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{"a", "-", "s", "-", "t"}], "]"}], 
          RowBox[{"Gamma", "[", "s", "]"}], 
          RowBox[{"Gamma", "[", 
           RowBox[{
            SubscriptBox["b", "1"], "-", "s"}], "]"}], " ", 
          RowBox[{"Gamma", "[", "t", "]"}], 
          RowBox[{"Gamma", "[", 
           RowBox[{
            SubscriptBox["b", "2"], "-", "t"}], "]"}]}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"c", "-", "s", "-", "t"}], "]"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", 
           SubscriptBox["z", "1"]}], ")"}], 
         RowBox[{"-", "s"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", 
           SubscriptBox["z", "2"]}], ")"}], 
         RowBox[{"-", "t"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", 
         RowBox[{"-", "j"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"-", "k"}]}], "}"}]}], "]"}]}]}]}]}]],ExpressionUUID->\
"a62a24f0-7a84-45a1-954f-31dec392737f"],

Cell[BoxData[
 RowBox[{"Integral", " ", "representation"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"74bf3061-403f-4f82-ad00-da47f9b7cba4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], " "}], 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}]}]], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "1"], 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", 
        RowBox[{"a", "-", "1"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "t"}], ")"}], 
        RowBox[{"c", "-", "a", "-", "1"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"t", " ", 
           SubscriptBox["z", "1"]}]}], ")"}], 
        RowBox[{"-", 
         SubscriptBox["b", "1"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"t", " ", 
           SubscriptBox["z", "2"]}]}], ")"}], 
        RowBox[{"-", 
         SubscriptBox["b", "2"]}]]}], 
      RowBox[{"\[DifferentialD]", "t"}]}]}]}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "a", "]"}], ">", "0"}], "\[And]", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"c", "-", "a"}], "]"}], ">", "0"}]}]}]],ExpressionUUID->\
"c8680777-aaa0-482b-b65a-31592842eee8"],

Cell[BoxData[
 RowBox[{"Differential", " ", "equation", " ", "followed"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"231a99bb-ac12-489f-b708-aa0b4fc6107f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "1"]}], ")"}], " ", 
       SubscriptBox["z", "1"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["z", "1"], ",", "2"}], "}"}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "1"]}], ")"}], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", 
            SubscriptBox["b", "1"], "+", "1"}], ")"}], " ", 
          SubscriptBox["z", "1"]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "1"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "2"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{"a", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"w", "[", 
        RowBox[{
         SubscriptBox["z", "1"], ",", 
         SubscriptBox["z", "2"]}], "]"}]}]}], "\[Equal]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "2"]}], ")"}], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["z", "2"], ",", "2"}], "}"}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       SubscriptBox["z", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{
       SubscriptBox["b", "2"], " ", 
       SubscriptBox["z", "1"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "1"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", 
            SubscriptBox["b", "2"], "+", "1"}], ")"}], " ", 
          SubscriptBox["z", "2"]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "2"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{"a", " ", 
       SubscriptBox["b", "2"], 
       RowBox[{"w", "[", 
        RowBox[{
         SubscriptBox["z", "1"], ",", 
         SubscriptBox["z", "2"]}], "]"}]}]}], "\[Equal]", "0"}]}], ")"}], "/;",
   " ", 
  RowBox[{
   RowBox[{"w", "[", 
    RowBox[{
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]],ExpressionUUID->"4e961a86-a73b-4f36-\
86a3-55462522130f"],

Cell[BoxData[
 RowBox[{"Integral", " ", "and", " ", "differential"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"68165ac4-9412-41ac-93a5-c522be73d232"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Integral]", 
   RowBox[{
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      RowBox[{"\[ScriptA]", " ", 
       SubscriptBox["z", "1"]}], ",", 
      SubscriptBox["z", "2"]}], "]"}], 
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["z", 
      RowBox[{" ", "1"}]]}]}]}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "-", "1"}], ")"}], " "}], 
    RowBox[{"\[ScriptA]", 
     RowBox[{"(", 
      RowBox[{"a", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["b", "1"], "-", "1"}], ")"}]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"a", "-", "1"}], ",", 
     RowBox[{
      SubscriptBox["b", "1"], "-", "1"}], ",", 
     SubscriptBox["b", "2"], ",", 
     RowBox[{"c", "-", "1"}], ",", 
     RowBox[{"\[ScriptA]", " ", 
      SubscriptBox["z", "1"]}], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]],ExpressionUUID->"bac2975d-58e4-4dd0-\
b397-ca8bf4d77ce0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["z", "1"], ",", "n"}], "}"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      SubscriptBox["z", "1"], ",", 
      SubscriptBox["z", "2"]}], "]"}]}], "\[Equal]", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Pochhammer", "[", 
       RowBox[{"a", ",", "n"}], "]"}], " ", 
      RowBox[{"Pochhammer", "[", 
       RowBox[{
        SubscriptBox["b", "1"], ",", "n"}], "]"}]}], 
     RowBox[{"Pochhammer", "[", 
      RowBox[{"c", ",", "n"}], "]"}]], " ", 
    RowBox[{"AppellF1", "[", 
     RowBox[{
      RowBox[{"a", "+", "n"}], ",", 
      RowBox[{
       SubscriptBox["b", "1"], "+", "n"}], ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"c", "+", "n"}], ",", 
      SubscriptBox["z", "1"], ",", 
      SubscriptBox["z", "2"]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"n", "\[Element]", "Integers"}], "\[And]", 
   RowBox[{"n", ">", "0"}]}]}]],ExpressionUUID->"db0b6e11-123c-4489-af8d-\
472a828d713d"],

Cell[BoxData[
 RowBox[{"Formule", " ", "asymptotiques"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"9cbeb0cf-c576-4217-8b92-fb7fd0e3658a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{
        SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      RowBox[{"1", "+", "a", "-", "c"}], ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"1", "+", "a", "-", 
       SubscriptBox["b", "1"]}], ",", 
      FractionBox["1", 
       SubscriptBox["z", "1"]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       SubscriptBox["z", "1"]]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"Gamma", "[", "c", "]"}], 
     RowBox[{"Gamma", "[", "a", "]"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"k", "=", "0"}], "\[Infinity]"], 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"a", "-", 
          SubscriptBox["b", "1"], "+", "k"}], "]"}], 
        RowBox[{"Pochhammer", "[", 
         RowBox[{
          SubscriptBox["b", "2"], ",", "k"}], "]"}]}], 
       RowBox[{
        RowBox[{"k", "!"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"c", "-", 
          SubscriptBox["b", "1"], "+", "k"}], "]"}]}]], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        SubscriptBox["b", "1"], ",", 
        RowBox[{"1", "-", "c", "+", 
         SubscriptBox["b", "1"], "-", "k"}], ",", 
        RowBox[{"1", "-", "a", "+", 
         SubscriptBox["b", "1"], "-", "k"}], ",", 
        FractionBox["1", 
         SubscriptBox["z", "1"]]}], "]"}], " ", 
      SubsuperscriptBox["z", "2", "k"]}]}]}]}]}]],ExpressionUUID->"f4a5c0c3-\
ec32-489a-9f5b-9fe7b72ad0dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{
        SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"1", "+", "a", "-", "c"}], ",", 
      RowBox[{"1", "+", "a", "-", 
       SubscriptBox["b", "1"]}], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       SubscriptBox["z", "1"]], ",", 
      FractionBox["1", 
       SubscriptBox["z", "1"]]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"a", "-", 
        SubscriptBox["b", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", 
        SubscriptBox["b", "1"]}], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "-", 
            SubscriptBox["b", "1"]}], ")"}], "2"], 
         SubscriptBox["b", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c", "-", 
           SubscriptBox["b", "1"]}], ")"}], "2"]], 
       SubscriptBox["z", "2"], 
       RowBox[{"HypergeometricPFQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", 
             RowBox[{
              SubscriptBox["b", "2"], "+", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["b", "1"], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", "1"}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", "-", 
             SubscriptBox["b", "1"], "+", "1"}], "}"}]}], "}"}], ",", 
         FractionBox[
          SubscriptBox["z", "2"], 
          SubscriptBox["z", "1"]], ",", 
         SubscriptBox["z", "2"]}], "]"}]}], "+", 
      RowBox[{"HypergeometricPFQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           SubscriptBox["b", "1"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["b", "2"], ",", 
            RowBox[{"a", "-", 
             SubscriptBox["b", "1"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "c", "+", 
             SubscriptBox["b", "1"]}], ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", "-", 
            SubscriptBox["b", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", "-", "a", "+", 
            SubscriptBox["b", "1"]}], "}"}]}], "}"}], ",", 
        FractionBox[
         SubscriptBox["z", "2"], 
         SubscriptBox["z", "1"]], ",", 
        FractionBox["1", 
         SubscriptBox["z", "1"]]}], "]"}]}], ")"}]}]}]}]],ExpressionUUID->\
"51537a92-2d0f-4c44-a20d-dcb53124f872"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Proportional]", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Gamma", "[", "c", "]"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{
         SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"c", "-", "a"}], "]"}], " ", 
       RowBox[{"Gamma", "[", 
        SubscriptBox["b", "1"], "]"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", 
        SubscriptBox["z", "1"]}], ")"}], 
      RowBox[{"-", "a"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"O", "[", 
        FractionBox["1", 
         SubscriptBox["z", "1"]], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Gamma", "[", "c", "]"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"a", "-", 
         SubscriptBox["b", "1"]}], "]"}]}], 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"c", "-", 
         SubscriptBox["b", "1"]}], "]"}], 
       RowBox[{"Gamma", "[", "a", "]"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", 
        SubscriptBox["z", "1"]}], ")"}], 
      RowBox[{"-", 
       SubscriptBox["b", "1"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"O", "[", 
        FractionBox["1", 
         SubscriptBox["z", "1"]], "]"}]}], ")"}]}]}]}], "/;", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Abs", "[", 
      SubscriptBox["z", "1"], "]"}], "\[Rule]", "\[Infinity]"}], ")"}], 
   "\[And]", 
   RowBox[{"a", "\[NotEqual]", "b"}]}]}]],ExpressionUUID->"a35e53fb-6bed-4367-\
b421-9472720efc98"],

Cell[BoxData[
 RowBox[{"Implementation", " ", "of", " ", "AppellF1"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"2bc87c64-1791-414b-b2ff-87427a8db278"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "x_", ",", "y_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "j", ",", "sumtotale", ",", "currentterm", ",", "firstTerm", 
      ",", "amnfirst", ",", "nx", ",", "cmnfirst", ",", "my", ",", "amn", ",",
       "cmn", ",", "b1n", ",", "b2m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"currentterm", "=", "1"}], ";", 
     RowBox[{"nx", "=", "1"}], ";", 
     RowBox[{"my", "=", "1"}], ";", 
     RowBox[{"b2m", "=", "b2"}], ";", 
     RowBox[{"firstTerm", "=", "1"}], ";", 
     RowBox[{"b1n", "=", "b1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sumtotale", "=", "0"}], ";", 
     RowBox[{"amnfirst", "=", "a"}], ";", 
     RowBox[{"cmnfirst", "=", "c"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"currentterm", "=", "firstTerm"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b2m", "=", "b2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"amn", "=", "amnfirst"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cmn", "=", "cmnfirst"}], ";", "\[IndentingNewLine]", 
        RowBox[{"my", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sumtotale", "+=", "currentterm"}], ";", 
           RowBox[{"currentterm", "*=", 
            RowBox[{"amn", " ", "b2m", " ", 
             RowBox[{
              RowBox[{"y", "/", "cmn"}], "/", "my"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<i=\>\"", ",", "i", ",", "\"\< j=\>\"", ",", "j", ",", 
               "\"\< currentterm=\>\"", ",", "currentterm", ",", 
               "\"\< sumtotal=\>\"", ",", "sumtotale"}], "]"}], ";"}], 
            "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"amn", "++"}], ";", 
           RowBox[{"b2m", "++"}], ";", 
           RowBox[{"cmn", "++"}], ";", 
           RowBox[{"my", "++"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Nb"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"firstTerm", "*=", 
         RowBox[{"x", " ", "amnfirst", " ", 
          RowBox[{
           RowBox[{"b1n", "/", "cmnfirst"}], "/", "nx"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amnfirst", "++"}], ";", 
        RowBox[{"cmnfirst", "++"}], ";", 
        RowBox[{"b1n", "++"}], ";", 
        RowBox[{"nx", "++"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Nb"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "sumtotale"}]}], "]"}]}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"ab7b86c3-7da8-4824-b419-7cfbb638697c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version1", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", "b1", ",", "b2", ",", "c", ",", 
       RowBox[{"z1", "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{"z2", "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"75be3cc6-6555-46d2-a865-409e0ec98488"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version2", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "a"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{"a", ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{"z1", "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"bf0c3a61-790b-4c2a-9310-cfeecfb27eaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version3", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "a"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{"a", ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z2", "-", "z1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{"z2", "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"ecefacb4-bb77-48a8-9097-ac08911502de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version4", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"c", "-", "a", "-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", "z1", 
       ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"3dcaee13-280d-4a25-b842-5f497a4ef7bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version5", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"c", "-", "a", "-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", "z2", ",", "Nb"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"6c045c6f-a02b-4b5c-ae0d-72172209224d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "1.4285714285714"}], ",", 
     RowBox[{"b1", "=", "0.5"}], ",", 
     RowBox[{"b2", "=", "0.5"}], ",", 
     RowBox[{"c", "=", "2.4285714285714"}], ",", 
     RowBox[{"z1", "=", 
      RowBox[{"1.1737504870683", "+", 
       RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ",", 
     RowBox[{"z2", "=", 
      RowBox[{"1.1737504870683", "-", 
       RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ",", 
     RowBox[{"Nb", "=", "150"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"HypergeometricAppellF1Version1", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version2", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version3", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", ",", 
     RowBox[{"HypergeometricAppellF1Version4", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version5", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"ccb3c6c6-6984-4a12-836b-65c5eb2a8612"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"8.191250777003515`*^57", "-", 
    RowBox[{"1.0679142980590642`*^43", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.5984880191933275`*^72", "+", 
    RowBox[{"1.438610271972039`*^71", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.618253165535406`*^72", "-", 
    RowBox[{"1.8268625400817523`*^71", " ", "\[ImaginaryI]"}]}], ",", "Null", 
   ",", 
   RowBox[{
    RowBox[{"-", "5.768091527866315`*^63"}], "-", 
    RowBox[{"4.6783968433701425`*^64", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.8415401009704103`*^64"}], "-", 
    RowBox[{"1.3862699191173552`*^65", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9623564597665176`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"c805cdad-f982-4638-9bda-e2c34b5704ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"HypergeometricAppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", "x", ",", "y", ",", "4"}], "]"}], 
   ",", "x"}], "]"}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"1ffe90ac-0e12-4199-8e11-bbc20bb5144f"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"a", " ", "y", " ", 
    SubscriptBox["b", "2"]}], "c"], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "a"}], ")"}], " ", 
    SuperscriptBox["y", "2"], " ", 
    SubscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["b", "2"]}], ")"}]}], 
   RowBox[{"2", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "a"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "a"}], ")"}], " ", 
    SuperscriptBox["y", "3"], " ", 
    SubscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["b", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      SubscriptBox["b", "2"]}], ")"}]}], 
   RowBox[{"6", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       SubscriptBox["b", "1"]}], "c"], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"4", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"12", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"12", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"36", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", "c"}], ")"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.9623564655268583`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"f839fea8-3eb9-4ca8-af93-afc4e2c5fa6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
HypergeometricAppellF1[1.4285714285714,0.50000000000000,0.50000000000000,2.\
4285714285714,
1.1737504870683+\[ImaginaryI] 0.88031286530120,1.1737504870683-\[ImaginaryI] \\
0.88031286530120,150]\
\>", "Input",
 CellLabel->"In[45]:=",ExpressionUUID->"5c16758f-e494-46bd-9cd9-c41d220b1998"],

Cell[BoxData[
 RowBox[{"1.118463960611519`*^45", "+", 
  RowBox[{"2.614529362970723`*^30", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.962356469578205*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"a4de0609-50f7-49e7-8e59-06b48c485d48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["AppellF1[1.1,2.09,3.7,4.12,0.19-0.5 \[ImaginaryI],0.9]", "Input",ExpressionUUID->"6e25a285-1398-44dc-b0dc-a27259259fcf"],

Cell[BoxData[
 RowBox[{"6.616499213883773`", "\[InvisibleSpace]", "-", 
  RowBox[{"5.8714598634635795`", " ", "\[ImaginaryI]"}]}]], "Output",Expressio\
nUUID->"acbb507b-aab0-4396-9165-6e803904f761"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppellF1", "[", 
  RowBox[{
  "1.4285714285714", ",", "0.50000000000000", ",", "0.50000000000000", ",", 
   "2.4285714285714", ",", "\[IndentingNewLine]", 
   RowBox[{"1.1737504870683", "+", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}], ",", 
   RowBox[{"1.1737504870683", "-", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], "]"}]], "Input",Ex\
pressionUUID->"d8c809d5-7956-413f-96a5-d66e8a6972a5"],

Cell[BoxData[
 RowBox[{"1.4301741471254665`", "\[InvisibleSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",ExpressionUUID->\
"a1191695-3bc7-42c6-a3ed-ec256f19cf42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SqrtBox[
  RowBox[{
   RowBox[{"0.19098042207655", "^", "2"}], "-", 
   RowBox[{"4", " ", "0.014247469381460"}]}]]], "Input",ExpressionUUID->\
"45f48484-a222-4697-ab8b-a3744269dfd7"],

Cell[BoxData[
 RowBox[{"0.`", "\[InvisibleSpace]", "+", 
  RowBox[{"0.14323531655741475`", " ", "\[ImaginaryI]"}]}]], "Output",Expressi\
onUUID->"cda60e07-a775-467f-9a81-ff255ba7e6ba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"z1", "=", 
   RowBox[{"1.1737504870683", "+", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ";", 
  RowBox[{"z2", "=", 
   RowBox[{"1.1737504870683", "-", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ";"}]], "Input",Ex\
pressionUUID->"d8af667a-3631-41b8-b86f-9682bcb2a17a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"z2", "-", "z1"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"z2", "-", "1"}], ")"}]}], "]"}]], "Input",ExpressionUUID->\
"8bb1ad86-077a-4f99-8783-fe75b9b04972"],

Cell[BoxData["1.9621461397679203`"], "Output",ExpressionUUID->"e0d979ac-9e6f-4e06-8629-182e4397f02c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", "z2", "]"}]], "Input",ExpressionUUID->"bf8d4ed0-32ac-4770-b373-62a8dc3d5069"],

Cell[BoxData["1.4671881088353598`"], "Output",ExpressionUUID->"80025349-6c1d-4dd6-9ef1-f02a4e3d923c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{"z2", "/", 
   RowBox[{"(", 
    RowBox[{"z2", "-", "1"}], ")"}]}], "]"}]], "Input",ExpressionUUID->\
"b8898a15-1cf8-4056-90f9-d0cc261cdd33"],

Cell[BoxData["1.6351217831399636`"], "Output",ExpressionUUID->"37990ac7-571f-460d-af78-85b832bd1825"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Power", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"z2", "-", "z1"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"z2", "-", "1"}], ")"}]}], ",", "10"}], "]"}]], "Input",Expressio\
nUUID->"dac291ca-dd28-4b7d-8132-f8499efe6555"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "312.1012926642466`"}], "-", 
  RowBox[{"786.2069686500461`", " ", "\[ImaginaryI]"}]}]], "Output",Expression\
UUID->"28664848-ac22-45fd-be7f-16ff5ff2e9c4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "We", " ", "extend", " ", "the", " ", "definition", " ", "of", " ", "the", 
   " ", "appell", " ", "function", " ", "to", " ", "x"}], ",", 
  RowBox[{
   RowBox[{
   "y", " ", "couple", " ", "outside", " ", "the", " ", "real", " ", "axis", 
    " ", "x"}], ">", 
   RowBox[{"1", " ", "or", " ", "y"}], ">", "1"}]}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"7fdc5b29-c814-47db-919b-fb88b877f4b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "1"]}], ")"}], 
    RowBox[{"c", "-", "a", "-", 
     SubscriptBox["b", "1"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "2"]}], ")"}], 
    RowBox[{"-", 
     SubscriptBox["b", "2"]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"c", "-", "a"}], ",", 
     RowBox[{"c", "-", 
      SubscriptBox["b", "1"], "-", 
      SubscriptBox["b", "2"]}], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     FractionBox[
      RowBox[{
       SubscriptBox["z", "2"], "-", 
       SubscriptBox["z", "1"]}], 
      RowBox[{
       SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}]],
 FontSize->16,ExpressionUUID->"a27379bd-fb3e-4bb4-a5ce-0352bd1a611d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "1"]}], ")"}], 
    RowBox[{"-", 
     SubscriptBox["b", "1"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "2"]}], ")"}], 
    RowBox[{"c", "-", "a", "-", 
     SubscriptBox["b", "2"]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"c", "-", "a"}], ",", 
     SubscriptBox["b", "1"], ",", 
     RowBox[{"c", "-", 
      SubscriptBox["b", "1"], "-", 
      SubscriptBox["b", "2"]}], ",", "c", ",", 
     FractionBox[
      RowBox[{
       SubscriptBox["z", "1"], "-", 
       SubscriptBox["z", "2"]}], 
      RowBox[{
       SubscriptBox["z", "1"], "-", "1"}]], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]],
 FontSize->16,ExpressionUUID->"376ec576-8b27-4a3f-b317-6ebb8af19266"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "2"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      RowBox[{"c", "-", 
       SubscriptBox["b", "1"], "-", 
       SubscriptBox["b", "2"]}], ",", "c", ",", 
      FractionBox[
       RowBox[{
        SubscriptBox["z", "2"], "-", 
        SubscriptBox["z", "1"]}], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16,ExpressionUUID->"56a488d3-0cad-49d0-9e56-e471e5abeb77"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      RowBox[{"c", "-", 
       SubscriptBox["b", "1"], "-", 
       SubscriptBox["b", "2"]}], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      FractionBox[
       SubscriptBox["z", "1"], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]], ",", 
      FractionBox[
       RowBox[{
        SubscriptBox["z", "1"], "-", 
        SubscriptBox["z", "2"]}], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16,ExpressionUUID->"e812cfb4-d7e9-495a-92c2-0ac66047aa10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "2"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "2"]}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{
      RowBox[{"c", "-", "a"}], ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      FractionBox[
       SubscriptBox["z", "1"], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16,ExpressionUUID->"5645b6e7-b686-4e2e-90d7-932e08a311b7"],

Cell[BoxData[
 RowBox[{"Generic", " ", "Algorithm", " ", "For", " ", "Generic", " ", "SABR",
   " "}]], "Input",
 Background->RGBColor[
  0.372549, 0.709804, 
   0.988235],ExpressionUUID->"a97038be-3764-404c-86ab-7d02fa700f1e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"C", "[", "f_", "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"f", "+", "A"}], ")"}], "\[Beta]"]}], "        ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "determine", " ", "z"}], ",", "b1", ",", "b2"}], " ",
    "*)"}], " ", "*)"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"a0c001c3-a317-4b71-9197-27d13e02b0d8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"C", "[", "f", "]"}], "=", 
    RowBox[{
     RowBox[{"B", "[", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]", " ", "z"}], "]"}], " ", 
     "determines", " ", "B"}]}], ",", " ", 
   RowBox[{"so", " ", ":"}]}], " ", "*)"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"51ab8b6e-ce12-4ef5-819b-40580bb68967"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"z", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]"}]], " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "K", "f"], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"C", "[", "s", "]"}]], 
       RowBox[{"\[DifferentialD]", "s"}], "  ", "determines", " ", 
       "z"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"b1", "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["B", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
       RowBox[{"B", "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}]], "=", 
      RowBox[{
       SuperscriptBox["C", "\[Prime]",
        MultilineFunction->None], "[", "f", "]"}]}]}], " ", ",", " ", 
    RowBox[{"b2", "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["B", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
       RowBox[{"B", "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}]], " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["C", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "f", "]"}], 
        RowBox[{"C", "[", "f", "]"}]}], "+", 
       SuperscriptBox["b1", "2"]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"SqB0B\[Alpha]z", " ", "represente", " ", "bien", " ", "sur", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
      RowBox[{"B", "[", "0", "]"}]}]]}], "  ", "*)"}], "\[IndentingNewLine]", 
  " "}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"ab439d59-49a1-4d87-b91e-e9c6798ed6f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRgeneric5", "[", 
   RowBox[{
   "intrinsec_", ",", "z_", ",", "b1_", ",", "b2_", ",", "zavg_", ",", 
    "SqB0B\[Alpha]z_", ",", "T_", ",", "\[Mu]_", ",", "\[Alpha]_", ",", 
    "\[Rho]_", ",", "\[Nu]_", ",", "printflag_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x", ",", "I0", ",", "I1", ",", "I2", ",", "\[Kappa]", ",", "f1overf0"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Rho]"}], "+", 
          RowBox[{"\[Nu]", " ", "z"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["\[Nu]", "2"], " ", 
             SuperscriptBox["z", "2"]}]}]]}], 
         RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I0", "=", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"zavg", " ", "\[Nu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"zavg", " ", "\[Nu]"}], "-", 
           RowBox[{"2", " ", "\[Rho]"}]}], ")"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I1", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"zavg", " ", "\[Nu]"}], "-", "\[Rho]"}], "I0"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I2", "=", 
      FractionBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}], 
       SuperscriptBox["I0", "3"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"12", "  ", "\[Mu]"}], "+", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["b1", "2"], " ", 
           SuperscriptBox["\[Alpha]", "2"]}], "+", 
          RowBox[{"2", " ", "b2", " ", 
           SuperscriptBox["\[Alpha]", "2"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox["\[Mu]", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["I1", "2"], " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          RowBox[{"2", " ", "I0", " ", "I2", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          RowBox[{
          "6", " ", "b1", " ", "\[Alpha]", " ", "\[Nu]", " ", "\[Rho]"}], "-", 
          RowBox[{
          "16", " ", "z", " ", "\[Mu]", " ", "\[Nu]", " ", "\[Rho]"}]}], 
         ")"}]}], 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"z", "  ", "\[Nu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "  ", "\[Nu]"}], "-", 
             RowBox[{"2", " ", "\[Rho]"}]}], ")"}]}]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f1overf0", "=", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Mu]"}], "+", 
           RowBox[{"b1", " ", "\[Alpha]", "  ", "\[Nu]", " ", "\[Rho]"}]}], 
          ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Rho]", " ", 
            RowBox[{"ArcTan", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"z", "  ", "\[Nu]"}], "-", "\[Rho]"}], 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}]]], "]"}]}], "+", 
           RowBox[{"2", " ", "\[Rho]", " ", 
            RowBox[{"ArcTan", "[", 
             FractionBox["\[Rho]", 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}]]], "]"}]}], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["\[Rho]", "2"]}]], " ", 
            RowBox[{"Log", "[", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["z", "2"], "  ", 
               SuperscriptBox["\[Nu]", "2"]}], "-", 
              RowBox[{"2", " ", "z", "  ", "\[Nu]", " ", "\[Rho]"}]}], 
             "]"}]}]}], ")"}]}], 
        RowBox[{"4", "  ", 
         SuperscriptBox["\[Nu]", "2"], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[Rho]", "2"]}]]}]]]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<z=\>\"", ",", "z", ",", "\"\< zavg=\>\"", ",", "zavg", ",", 
         "\"\< x=\>\"", ",", "x", ",", "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", 
         ",", "\"\< f1overf0=\>\"", ",", "f1overf0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "+", 
      RowBox[{
       FractionBox["\[Alpha]", "2"], 
       SqrtBox[
        FractionBox["2", "\[Pi]"]], " ", "SqB0B\[Alpha]z", "  ", "f1overf0", 
       " ", 
       SqrtBox["I0"], " ", 
       RowBox[{"GIntegralAnalytical", "[", 
        RowBox[{
         SqrtBox[
          RowBox[{"-", "\[Kappa]"}]], ",", 
         FractionBox["x", 
          SqrtBox["2"]], ",", 
         SqrtBox["T"]}], "]"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[46]:=",ExpressionUUID->"4084cbca-a905-456a-ab34-75dce5bd58dc"],

Cell[BoxData[
 RowBox[{"Regles", " ", "pour", " ", "la", " ", "transcription", " ", "en", 
  " ", 
  RowBox[{"C", "++"}]}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"c2e8b74e-e237-4d9d-9753-fb6eebf9aefc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rulesz", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]1", "\[Rule]", "alpha1"}], ",", 
     RowBox[{"\[Alpha]2", "\[Rule]", "alpha2"}], ",", 
     RowBox[{"\[Beta]1", "\[Rule]", "beta1"}], ",", 
     RowBox[{"\[Beta]2", "\[Rule]", "beta2"}], ",", 
     RowBox[{"\[Rho]1", "\[Rule]", "rho1"}], ",", 
     RowBox[{"\[Rho]2", "\[Rule]", "rho2"}], ",", 
     RowBox[{"\[Nu]1", "\[Rule]", "nu1"}], ",", 
     RowBox[{"\[Nu]2", "\[Rule]", "nu2"}], ",", 
     RowBox[{"\[Rho]s", "\[Rule]", "rhos"}], ",", 
     RowBox[{"\[Rho]v", "\[Rule]", "rhov"}], ",", 
     RowBox[{"\[Rho]c12", "\[Rule]", "rhoc12"}], ",", 
     RowBox[{"\[Rho]c21", "\[Rule]", "rhoc21"}], ",", 
     RowBox[{"\[Alpha]s", "\[Rule]", "alphas"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleszz1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["X1", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1SQ", "*", "X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2SQ", "*", "X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1", "*", "X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2", "*", "X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1SQ", "*", "alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2SQ", "*", "alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1", "*", "alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2", "*", "alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]1", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2", "*", "alpha2SQ"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleszz2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "2"], "\[Rule]", "alpha1SQ"}],
      ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "2"], "\[Rule]", "alpha2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Beta]1", "2"], "\[Rule]", "beta1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Beta]2", "2"], "\[Rule]", "beta2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]1", "2"], "\[Rule]", "rho1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]2", "2"], "\[Rule]", "rho2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Nu]1", "2"], "\[Rule]", "nu1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Nu]2", "2"], "\[Rule]", "nu2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]s", "2"], "\[Rule]", "rhosSQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]v", "2"], "\[Rule]", "rhovSQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]c12", "2"], "\[Rule]", "rhoc12SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]c21", "2"], "\[Rule]", "rhoc21SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]s", "2"], "\[Rule]", "alphasSQ"}], ",", 
     RowBox[{
      SuperscriptBox["X1", "2"], "\[Rule]", "X1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["X2", "2"], "\[Rule]", "X2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["F1", "2"], "\[Rule]", "F1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["F2", "2"], "\[Rule]", "F2SQ"}]}], "}"}]}], 
  ";"}]}], "Input",ExpressionUUID->"7a21539e-6bf8-4165-90ca-bcb839f7839c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CTranform", "[", "x_", "]"}], ":=", 
  RowBox[{"CForm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", " ", "/.", "ruleszz1"}], " ", "/.", " ", "ruleszz2"}], " ", 
    "/.", "rulesz"}], "  ", "]"}]}]], "Input",ExpressionUUID->"e5d7ca6a-e0e2-\
4123-be85-dcd34bf5d475"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CTranform", "[", 
  RowBox[{"2", " ", 
   SuperscriptBox["X1", 
    RowBox[{"3", " "}]], " ", "X2", " ", 
   SuperscriptBox["\[Alpha]1", "3"], " ", "\[Alpha]2", " ", "\[Rho]s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["X1", "F1"], ")"}], "2"], " ", 
      SuperscriptBox["\[Alpha]1", "2"], " ", 
      SuperscriptBox["\[Beta]1", "2"]}], "+", 
     RowBox[{
      FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "\[Nu]1", " ", "\[Rho]1"}], "+", 
        RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
        RowBox[{
         FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
         "\[Rho]s"}]}], ")"}]}], "+", 
     RowBox[{"\[Nu]1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Nu]1", "+", 
        RowBox[{
         FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
         "\[Rho]c21"}], "+", 
        RowBox[{"\[Nu]2", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}], 
  "]"}]], "Input",ExpressionUUID->"7d063000-6fcb-4260-a113-ac7f0eba1fce"],

Cell["\<\
2*Power(alpha1,3)*alpha2*rhos*Power(X1,3)*X2*
   ((alpha1SQ*beta1SQ*X1SQ)/Power(F1,2) + nu1*(nu1 + nu2*rhov + \
(alpha2*beta2*rhoc21*X2)/F2) + 
     (alpha1*beta1*X1*(2*nu1*rho1 + nu2*rhoc12 + \
(alpha2*beta2*rhos*X2)/F2))/F1)\
\>", "Output",ExpressionUUID->"0854de80-39d1-4d7b-a36e-1885c9427fa4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Precalcul", " ", "pour", " ", "le", " ", "spreadoption"}]], "Input",
 Background->RGBColor[
  0.372549, 0.709804, 
   0.988235],ExpressionUUID->"4464f32a-b7a9-4d3d-9599-f52d279144ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"term1", ",", "term2", ",", "term3"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"term1", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"4", " "}]], " ", 
       SuperscriptBox["\[Alpha]1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"]}], "+", 
         SuperscriptBox["\[Nu]1", "2"], "+", 
         RowBox[{"2", " ", 
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          "\[Nu]1", " ", "\[Rho]1"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term2", "=", 
      RowBox[{
       SuperscriptBox["X2", 
        RowBox[{"4", " "}]], " ", 
       SuperscriptBox["\[Alpha]2", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X2", "F2"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"]}], "+", 
         SuperscriptBox["\[Nu]2", "2"], "+", 
         RowBox[{"2", 
          FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
          "\[Nu]2", " ", "\[Rho]2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term3", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X2", "F2"], ")"}], "2"], "  ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Nu]1", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Nu]2", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{"2", " ", 
          FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", 
             SuperscriptBox["\[Rho]s", "2"]}], "+", 
            RowBox[{"\[Nu]1", " ", "\[Rho]c21", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", 
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
             SuperscriptBox["\[Rho]s", "2"]}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]s", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}], "+", 
         RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", 
          SuperscriptBox["\[Rho]s", "2"], " ", "\[Rho]v"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"term4", "=", 
      RowBox[{"2", " ", "X1", "  ", 
       SuperscriptBox["X2", 
        RowBox[{"3", " "}]], " ", "\[Alpha]1", " ", 
       SuperscriptBox["\[Alpha]2", "3"], " ", "\[Rho]s", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["F2", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"2", " ", "\[Beta]2"}]}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["F2", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]2"}]], " ", "\[Alpha]2", " ", 
           "\[Beta]2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "F1", " ", "\[Nu]2", " ", "\[Rho]2"}], "+", 
             RowBox[{"F1", " ", "\[Nu]1", " ", "\[Rho]c21"}], "+", 
             RowBox[{
              SuperscriptBox["F1", "\[Beta]1"], " ", "\[Alpha]1", " ", 
              "\[Beta]1", " ", "\[Rho]s"}]}], ")"}]}], "F1"], "+", 
         RowBox[{"\[Nu]2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Nu]2", "+", 
            RowBox[{
             FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
             "\[Rho]c12"}], "+", 
            RowBox[{"\[Nu]1", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"term5", "=", 
      RowBox[{"2", " ", 
       SuperscriptBox["X1", 
        RowBox[{"3", " "}]], " ", "X2", " ", 
       SuperscriptBox["\[Alpha]1", "3"], " ", "\[Alpha]2", " ", "\[Rho]s", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"]}], "+", 
         RowBox[{
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Nu]1", " ", "\[Rho]1"}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]s"}]}], ")"}]}], "+", 
         RowBox[{"\[Nu]1", " ", 
          RowBox[{"(", 
           RowBox[{"\[Nu]1", "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]c21"}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     FractionBox[
      SqrtBox[
       RowBox[{
       "term1", "+", "term2", "+", "term3", "-", "term4", "-", "term5"}]], 
      SuperscriptBox["\[Alpha]s", "2"]]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[47]:=",ExpressionUUID->"93ee2591-8419-40bf-a5a5-e220eca0feac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "\[Nu]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["X1", "3"], " ", 
        SuperscriptBox["\[Alpha]1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"X1", " ", "\[Alpha]1", " ", "\[Beta]1"}], "F1"], "+", 
          RowBox[{"\[Nu]1", " ", "\[Rho]1"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["X2", "3"], " ", 
        SuperscriptBox["\[Alpha]2", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Beta]2"}], "F2"], "+", 
          RowBox[{"\[Nu]2", " ", "\[Rho]2"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["X1", "2"], " ", "X2", " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", "X1", " ", "\[Alpha]1", " ", "\[Beta]1"}], 
              "F1"], "+", 
             RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
             FractionBox[
              RowBox[{
              "X2", " ", "\[Alpha]2", " ", "\[Beta]2", " ", "\[Rho]s"}], 
              "F2"]}], ")"}]}], "+", 
          RowBox[{"\[Nu]1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]c21", "+", 
             RowBox[{"\[Rho]1", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"X1", " ", 
        SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
        SuperscriptBox["\[Alpha]2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", "X2", " ", "\[Alpha]2", " ", "\[Beta]2"}], 
              "F2"], "+", 
             RowBox[{"\[Nu]1", " ", "\[Rho]c21"}], "+", 
             FractionBox[
              RowBox[{
              "X1", " ", "\[Alpha]1", " ", "\[Beta]1", " ", "\[Rho]s"}], 
              "F1"]}], ")"}]}], "+", 
          RowBox[{"\[Nu]2", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]c12", "+", 
             RowBox[{"\[Rho]2", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"\[Nu]s", " ", 
       SuperscriptBox["\[Alpha]s", "3"]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[48]:=",ExpressionUUID->"e5e4d286-9a8e-49f5-b86e-c87eb2223cea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", " ", "=", "0.040908314711852"}], ",", 
     RowBox[{"alpha1", "=", " ", "0.013242339206841"}], ",", 
     RowBox[{"beta1", " ", "=", "0.40000000000000"}], ",", 
     RowBox[{"rho1", "=", " ", "0.35242800000000"}], ",", 
     RowBox[{"nu1", " ", "=", "0.25283800000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"F2", "=", " ", "0.044141630651630"}], ",", 
     RowBox[{"alpha2", " ", "=", "0.014300324948643"}], ",", 
     RowBox[{"beta2", "=", " ", "0.40000000000000"}], ",", 
     RowBox[{"rho2", "=", " ", "0.37737400000000"}], ",", 
     RowBox[{"nu2", "=", " ", "0.23093200000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rhos", " ", "=", "0.90400000000000"}], ",", 
     RowBox[{"rhov", "=", " ", "0.60000000000000"}], ",", 
     RowBox[{"rhoc12", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"rhoc21", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"X1", " ", "=", "0.27843551868880"}], ",", 
     RowBox[{"X2", "=", " ", "0.28703796939008"}], ",", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", " ", "0.0017550658859387"}], ",", 
     RowBox[{"nus", " ", "=", "0.25040352068222"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Nu]BiSABR1", "[", 
    RowBox[{
    "F1", ",", "alpha1", ",", "beta1", ",", "rho1", ",", "nu1", ",", "F2", 
     ",", "alpha2", ",", "beta2", ",", "rho2", ",", "nu2", ",", "rhos", ",", 
     "rhov", ",", "rhoc12", ",", "rhoc21", ",", "X1", ",", "X2", ",", 
     "alphas"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"4d90bf3a-5d45-4004-ac15-6b63f00f7ea6"],

Cell[BoxData["0.2504035206821801`"], "Output",
 CellChangeTimes->{3.962356496639382*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"ecb226a1-fbe5-4b96-ad20-d7e7f421fab5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", " ", "=", "0.040908314711852"}], ",", 
     RowBox[{"alpha1", "=", " ", "0.013242339206841"}], ",", 
     RowBox[{"beta1", " ", "=", "0.40000000000000"}], ",", 
     RowBox[{"rho1", "=", " ", "0.35242800000000"}], ",", 
     RowBox[{"nu1", " ", "=", "0.25283800000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"F2", "=", " ", "0.044141630651630"}], ",", 
     RowBox[{"alpha2", " ", "=", "0.014300324948643"}], ",", 
     RowBox[{"beta2", "=", " ", "0.40000000000000"}], ",", 
     RowBox[{"rho2", "=", " ", "0.37737400000000"}], ",", 
     RowBox[{"nu2", "=", " ", "0.23093200000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rhos", " ", "=", "0.90400000000000"}], ",", 
     RowBox[{"rhov", "=", " ", "0.60000000000000"}], ",", 
     RowBox[{"rhoc12", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"rhoc21", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"X1", " ", "=", "0.27843551868880"}], ",", 
     RowBox[{"X2", "=", " ", "0.28703796939008"}], ",", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", " ", "0.0017550658859387"}], ",", 
     RowBox[{"nus", " ", "=", "0.25040352068222"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Rho]BiSABR1", "[", 
    RowBox[{
    "F1", ",", "alpha1", ",", "beta1", ",", "rho1", ",", "nu1", ",", "F2", 
     ",", "alpha2", ",", "beta2", ",", "rho2", ",", "nu2", ",", "rhos", ",", 
     "rhov", ",", "rhoc12", ",", "rhoc21", ",", "X1", ",", "X2", ",", 
     "alphas", ",", "nus"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"ca6cac89-1aa5-40fe-a9f3-0e292db21c20"],

Cell[BoxData[
 RowBox[{"-", "1.0279990989437175`"}]], "Output",
 CellChangeTimes->{3.962356499438593*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"3a646bb2-4e5b-4372-8ca7-950b64e3fb9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CTranform", "[", 
  RowBox[{
   SuperscriptBox["X1", 
    RowBox[{"2", " "}]], " ", 
   SuperscriptBox["X2", "2"], " ", "F2", "  ", 
   SuperscriptBox["\[Alpha]1", "2"], " ", 
   SuperscriptBox["\[Alpha]2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["X1", "2"], " ", "F2", " ", 
      SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "\[Beta]1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Beta]1"}], ")"}], " ", 
         SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "X1", " ", "F1", " ", "\[Alpha]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "F1"}], " ", "\[Beta]2", " ", "\[Nu]2", " ", "\[Rho]2", 
         " ", "\[Rho]s"}], "+", 
        RowBox[{"F2", " ", "\[Beta]1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
           RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}],
      "-", 
     RowBox[{
      SuperscriptBox["F1", "2"], " ", "F2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Rho]s", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Nu]1", "2"], "+", 
        SuperscriptBox["\[Nu]2", "2"], "-", 
        RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}]}], 
       ")"}]}]}], ")"}]}], "]"}]], "Input",ExpressionUUID->"93c1b321-9d4c-\
4e45-b01b-97cd9f01c8b5"],

Cell["\<\
alpha1SQ*alpha2SQ*F2*X1SQ*(-(F1SQ*F2*(-1 + rhosSQ)*(nu1SQ + nu2SQ - \
2*nu1*nu2*rhov)) + 
     2*alpha1*F1*(-(beta2*F1*nu2*rho2*rhos) + beta1*F2*(nu2*rhoc12*(-1 + \
rhosSQ) + nu1*rho1*(2 + rhosSQ)))*X1 + 
     alpha1SQ*beta1*F2*(-1 + 2*beta1 + (-2 + beta1)*rhosSQ)*X1SQ)*X2SQ\
\>", "Output",ExpressionUUID->"6066c890-2d39-4c15-95b0-6ca0bda8fbb2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"term1", ",", "term2", ",", "term3", ",", "term4"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"term1", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", 
         RowBox[{"6", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "6"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", "\[Beta]2"}], 
       "+", 
       RowBox[{
        SuperscriptBox["X1", 
         RowBox[{"5", " "}]], " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]1", "5"], " ", "\[Beta]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "+", 
          RowBox[{"2", " ", "F1", " ", "\[Nu]1", " ", "\[Rho]1"}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        SuperscriptBox["X1", 
         RowBox[{"4", " "}]], " ", "X2", " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]1", "4"], " ", "\[Alpha]2", " ", "\[Beta]1", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "+", 
          RowBox[{"2", " ", "F1", " ", "\[Nu]1", " ", "\[Rho]1"}]}], ")"}], 
        " ", "\[Rho]s"}], "+", 
       RowBox[{
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", 
         RowBox[{"5", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "5"], " ", "\[Beta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "F2", " ", "\[Nu]2", " ", "\[Rho]2"}], "-", 
          RowBox[{"3", " ", "X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", "\[Rho]s"}]}],
          ")"}]}], "+", 
       RowBox[{"X1", " ", 
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", "4"], " ", "\[Alpha]1", " ", 
        SuperscriptBox["\[Alpha]2", "4"], " ", "\[Beta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", "F2", " ", "\[Nu]2", " ", "\[Rho]2", " ", 
           "\[Rho]s"}], "+", 
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "\[Beta]2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Beta]2"}], ")"}], " ", 
              SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}]}], ")"}]}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"term3", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", "3"], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X1", " ", "\[Alpha]1", " ", "\[Rho]s", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["F2", "2"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
             "\[Beta]1"}], "-", 
            RowBox[{
             SuperscriptBox["F1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", 
             "\[Beta]2"}], "+", 
            RowBox[{
            "2", " ", "F1", " ", "F2", " ", "\[Beta]1", " ", "\[Beta]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "F1", " ", "F2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "F2"}], " ", "\[Beta]1", " ", "\[Nu]1", " ", 
             "\[Rho]1", " ", "\[Rho]s"}], "+", 
            RowBox[{"F1", " ", "\[Beta]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Nu]1", " ", "\[Rho]c21", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
               RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term4", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", "2"], " ", "F2", "  ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", "2"], " ", "F2", " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "\[Beta]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Beta]1"}], ")"}], " ", 
             SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "X1", " ", "F1", " ", "\[Alpha]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "F1"}], " ", "\[Beta]2", " ", "\[Nu]2", " ", 
             "\[Rho]2", " ", "\[Rho]s"}], "+", 
            RowBox[{"F2", " ", "\[Beta]1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
               RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["F1", "2"], " ", "F2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[Rho]s", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Nu]1", "2"], "+", 
            SuperscriptBox["\[Nu]2", "2"], "-", 
            RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"term1", "+", "term2", "+", "term3", "+", "term4"}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]s", "3"]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[51]:=",ExpressionUUID->"01e3e208-d87e-4f21-8f2c-86f6a762a8eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"], 
     ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "F2", ",", "2"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input",ExpressionUUID->"4a5408b1-8099-4475-9ae2-ec025b02645e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["2", "\[Beta]1"]}], " ", 
     SuperscriptBox["F2", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", 
     RowBox[{"(", 
      RowBox[{"F2", "-", "s"}], ")"}], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["2", "\[Beta]1"], " ", 
        SuperscriptBox["F2", "\[Beta]1"], " ", "\[Alpha]1"}], "-", 
       RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["4", "\[Beta]1"], " ", 
        SuperscriptBox["F2", 
         RowBox[{"2", " ", "\[Beta]1"}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["X2", "2"], " ", 
        SuperscriptBox["\[Alpha]2", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "+", "\[Beta]1"}]], " ", 
        SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
      SuperscriptBox["F2", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "-", "s"}], ")"}], "2"], " ", "\[Alpha]1", " ", 
      "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["8", "\[Beta]1"], " ", 
         SuperscriptBox["F2", 
          RowBox[{"3", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["4", "\[Beta]1"], " ", 
         SuperscriptBox["F2", 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", "X2", " ", 
         SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Rho]s"}], 
        "-", 
        RowBox[{
         SuperscriptBox["X2", "3"], " ", 
         SuperscriptBox["\[Alpha]2", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Rho]s"}], 
        "+", 
        RowBox[{
         SuperscriptBox["2", "\[Beta]1"], " ", 
         SuperscriptBox["F2", "\[Beta]1"], " ", 
         SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
         SuperscriptBox["\[Alpha]2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Rho]s", "2"]}], "+", 
           RowBox[{"\[Beta]1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["4", "\[Beta]1"], " ", 
       SuperscriptBox["F2", 
        RowBox[{"2", " ", "\[Beta]1"}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["X2", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "+", "\[Beta]1"}]], " ", 
       SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", "\[Alpha]s", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["4", "\[Beta]1"], " ", 
       SuperscriptBox["F2", 
        RowBox[{"2", " ", "\[Beta]1"}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["X2", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "+", "\[Beta]1"}]], " ", 
       SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}]}]], "Output",ExpressionUUID->\
"afe968b0-a139-4a1b-b620-7b24f3f667aa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadC", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"s", "+", "F2"}], "]"}], "<", 
       RowBox[{"2", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}], "F2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["2", "\[Beta]1"]}], " ", 
          SuperscriptBox["F2", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", 
          RowBox[{"(", 
           RowBox[{"F2", "-", "s"}], ")"}], " ", "\[Alpha]1", " ", "\[Beta]1",
           " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["2", "\[Beta]1"], " ", 
             SuperscriptBox["F2", "\[Beta]1"], " ", "\[Alpha]1"}], "-", 
            RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["4", "\[Beta]1"], " ", 
             SuperscriptBox["F2", 
              RowBox[{"2", " ", "\[Beta]1"}]], " ", 
             SuperscriptBox["\[Alpha]1", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["X2", "2"], " ", 
             SuperscriptBox["\[Alpha]2", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["2", 
              RowBox[{"1", "+", "\[Beta]1"}]], " ", 
             SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
             " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
           SuperscriptBox["F2", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"F2", "-", "s"}], ")"}], "2"], " ", "\[Alpha]1", " ", 
           "\[Beta]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["8", "\[Beta]1"], " ", 
              SuperscriptBox["F2", 
               RowBox[{"3", " ", "\[Beta]1"}]], " ", 
              SuperscriptBox["\[Alpha]1", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["4", "\[Beta]1"], " ", 
              SuperscriptBox["F2", 
               RowBox[{"2", " ", "\[Beta]1"}]], " ", "X2", " ", 
              SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
              "\[Rho]s"}], "-", 
             RowBox[{
              SuperscriptBox["X2", "3"], " ", 
              SuperscriptBox["\[Alpha]2", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
              "\[Rho]s"}], "+", 
             RowBox[{
              SuperscriptBox["2", "\[Beta]1"], " ", 
              SuperscriptBox["F2", "\[Beta]1"], " ", 
              SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
              SuperscriptBox["\[Alpha]2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "-", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Rho]s", "2"]}], "+", 
                RowBox[{"\[Beta]1", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox["4", "\[Beta]1"], " ", 
            SuperscriptBox["F2", 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", "2"], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"1", "+", "\[Beta]1"}]], " ", 
            SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
            " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "\[Alpha]s", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["4", "\[Beta]1"], " ", 
            SuperscriptBox["F2", 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", "2"], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"1", "+", "\[Beta]1"}]], " ", 
            SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
            " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{"2", " ", "\[Beta]1"}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[52]:=",ExpressionUUID->"8fc1ef57-6b08-4ebc-8db6-3ec3aee21152"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRspreadC", "[", 
    RowBox[{
    "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_",
      ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
     "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"]}], 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"0c73431a-9ecd-\
483c-8acf-6fe6fa7a11e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{" ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", "+", "F2"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", " ", 
      RowBox[{"X2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", "+", "F2"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}]}], 
    RowBox[{"\[Alpha]s", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{"2", " ", "\[Beta]1"}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["X2", 
         RowBox[{"2", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
        "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{"-", "F2"}], ",", "1"}], "}"}]}], "]"}]], "Input",ExpressionUUID->\
"2a487785-4592-4f46-9c82-333c98e683c3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"F2", "+", "s"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
    SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"F2", "+", "s"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "X2", " ", "\[Alpha]1", 
    " ", "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}], 
  RowBox[{"\[Alpha]s", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "+", "s"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["X2", "2"], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "+", "s"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
      "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]], "Output",Express\
ionUUID->"97a8834e-439e-43e8-9adb-d87a088c4c09"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadCderivative", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", " ", 
       RowBox[{"X2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}]}], 
     RowBox[{"\[Alpha]s", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[53]:=",ExpressionUUID->"6452263b-4da0-4c0a-b395-3caa72f12239"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadCderivative2", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", 
         RowBox[{"2", " ", "X2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
          "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}], ")"}], "2"], 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", "F2"}], ")"}], 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", 
             RowBox[{"2", " "}]], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
            "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], ")"}], 
        "3"]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["F2", "\[Beta]2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Beta]1", " ", 
        "\[Rho]s"}]}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{"2", " ", "\[Beta]1"}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[54]:=",ExpressionUUID->"b32464af-147f-40f5-8c29-2d741d6f7525"],

Cell[BoxData["Spreadoption"], "Input",
 Background->RGBColor[
  0.372549, 0.709804, 
   0.988235],ExpressionUUID->"c5942ab4-5e81-4d5d-a994-ba25e5504604"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Utilise", " ", "une", " ", "integration", " ", "numerique", " ", "pour", 
   " ", "le", " ", "calcul", " ", "du", " ", "z"}], ",", " ", 
  RowBox[{"Fait", " ", "des", " ", "tas", " ", 
   RowBox[{"d", "'"}], "affichage"}]}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"e887ab26-9432-4460-929c-83e076e1f85f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "zb", ",", "b1", ",", "b2", ",", 
      "SqB0B\[Alpha]z", ",", "favg", ",", "zavg", ",", "Ck", ",", 
      "\[Alpha]sp", ",", "\[Nu]sp", ",", "\[Rho]sp", ",", "\[Mu]sp", ",", 
      "X1", ",", "X2", ",", "Qs", ",", "Q1", ",", "Q2", ",", "Qb", ",", "C1", 
      ",", "C2", ",", "C1p", ",", "C2p", ",", "Q", ",", "COV", ",", "COV1", 
      ",", "COV0", ",", "\[Rho]sb", ",", "\[Rho]s\[Alpha]1", ",", 
      "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", 
      ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<X1=\>\"", ",", "X1", ",", "\"\< X2=\>\"", ",", "X2", ",", 
         "\"\< \[Alpha]sp=\>\"", ",", "\[Alpha]sp"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"BiSABRz", "[", 
        RowBox[{
        "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
         "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zb", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:z=\>\"", ",", "z", ",", "\"\<zb=\>\"", ",", 
         "zb"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"favg", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"F1", "-", "F2", "+", "K"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zavg", "=", "z"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b1", "=", 
      RowBox[{"BiSABRspreadCderivative", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Csecond", "=", 
      RowBox[{"BiSABRspreadCderivative2", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cfavg", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ck", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       RowBox[{"Csecond", " ", "Cfavg"}], "+", 
       SuperscriptBox["b1", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SqB0B\[Alpha]z", "=", 
      SqrtBox["Ck"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"F1", "-", "F2", "-", "K"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:K=\>\"", ",", "K", ",", 
         "\"\< b1:Cprime[favg]=\>\"", ",", "b1", ",", 
         "\"\< Csecond[favg]=\>\"", ",", "Csecond", ",", " ", "\"\< b2=\>\"", 
         ",", "b2", ",", "\"\< Cfavg=\>\"", ",", "Cfavg"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:\[Alpha]=\>\"", ",", "\[Alpha]sp", ",", 
         "\"\< \[Nu]=\>\"", ",", "\[Nu]sp", ",", "\"\< \[Rho]=\>\"", ",", 
         "\[Rho]sp", ",", "\"\<  \[Mu]=\>\"", ",", "\[Mu]sp"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:intrinsec Value=\>\"", ",", "intrinsec", ",", 
         "\"\<  z=\>\"", ",", "z", ",", "\"\< SqB0B\[Alpha]z=\>\"", ",", 
         "SqB0B\[Alpha]z"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"C1", "=", 
         RowBox[{"F1", "^", "\[Beta]1"}]}], ";", 
        RowBox[{"C2", "=", 
         RowBox[{"F2", "^", "\[Beta]2"}]}], ";", 
        RowBox[{"C1p", "=", 
         RowBox[{"\[Beta]1", " ", 
          RowBox[{"F1", "^", 
           RowBox[{"(", 
            RowBox[{"\[Beta]1", "-", "1"}], ")"}]}]}]}], ";", 
        RowBox[{"C2p", "=", 
         RowBox[{"\[Beta]2", " ", 
          RowBox[{"F2", "^", 
           RowBox[{"(", 
            RowBox[{"\[Beta]2", "-", "1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Alpha]1", "2"], " ", 
            SuperscriptBox["C1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["\[Alpha]2", "2"], " ", 
            SuperscriptBox["C2", "2"]}], "-", 
           RowBox[{
           "2", "\[Rho]s", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", "C1", " ",
             "C2"}]}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Qs", "=", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]1", "2"], " ", "C1", "  ", "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C2", "  ", 
           "C1p"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Qb", "=", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]1", "2"], " ", "C1", " ", "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C2", "  ", 
           "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C1", " ", 
           "C2p"}], "+", 
          RowBox[{
           SuperscriptBox["\[Alpha]2", "2"], " ", "C2", " ", "C2p"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Q1", "=", 
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           SuperscriptBox["C1", "2"]}], "-", 
          RowBox[{"\[Alpha]2", " ", "\[Rho]s", " ", "C1", " ", "C2"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Q2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]1"}], " ", "\[Rho]s", " ", "C1", " ", "C2"}],
           "+", 
          RowBox[{"\[Alpha]2", " ", 
           SuperscriptBox["C2", "2"]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]sb", "=", 
         FractionBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
            RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], "Q"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]s\[Alpha]1", "=", 
         FractionBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
            RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
          "Q"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]s\[Alpha]2", "=", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
            RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], "Q"]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]b\[Alpha]1", "=", "\[Rho]c21"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]b\[Alpha]2", "=", "\[Rho]2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"COV0", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Alpha]1", "2"], " ", 
              SuperscriptBox["C1", "2"]}], ",", 
             "                                                          ", 
             RowBox[{
             "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ", 
              "C2"}], " ", ",", "                         ", 
             RowBox[{
             "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                    ", 
             RowBox[{
             "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ", 
              "C2"}], " ", ",", "                                         ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             "                                       ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                 ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", 
             "                                            ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
              "\[Alpha]1"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             "                                                ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                        ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], " ", ",", "                           ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                    ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Alpha]1", "2"], " ", 
                SuperscriptBox["C1", "2"]}], ",", 
               "                                                          ", 
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", "                         ", 
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                    ", 
               RowBox[{
               "rc12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", 
               "                                         ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
               "                                       ", 
               RowBox[{
               "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                 ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", 
               "                                            ", 
               RowBox[{
               "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
                "\[Alpha]1"}], ",", "                       ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
               "                                                ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "rc12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], ",", 
               "                                        ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], " ", ",", "                           ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}], ",", "                                    ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}],
             "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"rc12", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Alpha]1", "2"], " ", 
                SuperscriptBox["C1", "2"]}], ",", 
               "                                                          ", 
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", "                         ", 
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                    ", 
               RowBox[{
               "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", 
               "                                         ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
               "                                       ", 
               RowBox[{
               "rc21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                 ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", 
               "                                            ", 
               RowBox[{
               "rc21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
                "\[Alpha]1"}], ",", "                       ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
               "                                                ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], ",", 
               "                                        ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], " ", ",", "                           ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}], ",", "                                    ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}],
             "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"rc21", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial Eigenvalues=\>\"", ",", 
          RowBox[{"Eigenvalues", "[", "COV0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial Det=\>\"", ",", 
          RowBox[{"Det", "[", "COV0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"COV1", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Alpha]1", "2"], " ", 
               SuperscriptBox["C1", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["\[Alpha]2", "2"], " ", 
               SuperscriptBox["C2", "2"]}], "-", 
              RowBox[{
              "2", "\[Rho]s", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", "C1", 
               " ", "C2"}]}], ",", "       ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
                RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], " ", "\[Alpha]2", "  ",
               "C2"}], " ", ",", "     ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              "\[Nu]1", " ", "\[Alpha]1"}], ",", "     ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]2", " ", "\[Alpha]2"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
                RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], " ", "\[Alpha]2", "  ",
               "C2"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             "                                       ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                 ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]1", "  ", "\[Alpha]1"}], ",", "             ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
              "\[Alpha]1"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             "                                                ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]2", " ", "\[Alpha]2"}], ",", "                ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], " ", ",", "                           ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                    ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"COV", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["Q", "2"], ",", 
             RowBox[{"\[Rho]sb", " ", "Q", " ", "\[Alpha]2", "  ", "C2"}], 
             " ", ",", 
             RowBox[{
             "\[Rho]s\[Alpha]1", " ", "Q", " ", "\[Nu]1", " ", "\[Alpha]1"}], 
             ",", 
             RowBox[{
             "\[Rho]s\[Alpha]2", " ", "Q", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Rho]sb", " ", "Q", " ", "\[Alpha]2", "  ", "C2"}], 
             ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             RowBox[{
             "\[Rho]b\[Alpha]1", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", 
              " ", "\[Alpha]1"}], ",", 
             RowBox[{
             "\[Rho]b\[Alpha]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", 
              " ", "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\[Rho]s\[Alpha]1", " ", "Q", " ", "\[Nu]1", "  ", "\[Alpha]1"}],
              ",", 
             RowBox[{
             "\[Rho]b\[Alpha]1", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ",
               "\[Alpha]1"}], ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\[Rho]s\[Alpha]2", " ", "Q", " ", "\[Nu]2", " ", "\[Alpha]2"}], 
             ",", 
             RowBox[{
             "\[Rho]b\[Alpha]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", 
              " ", "\[Alpha]2"}], " ", ",", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< COV1-COV=\>\"", ",", 
          RowBox[{"COV1", "-", "COV"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"N1", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}], ".", 
          RowBox[{"(", 
           RowBox[{"COV", ".", 
            RowBox[{"{", 
             RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"N2", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qs", "/", "Q"}], ",", 
            RowBox[{"Qb", "/", "Q"}], ",", 
            RowBox[{"Q1", "/", "Q"}], ",", 
            RowBox[{"Q2", "/", "Q"}]}], "}"}], ".", 
          RowBox[{"(", 
           RowBox[{"COV", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Qs", "/", "Q"}], ",", 
              RowBox[{"Qb", "/", "Q"}], ",", 
              RowBox[{"Q1", "/", "Q"}], ",", 
              RowBox[{"Q2", "/", "Q"}]}], "}"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Nu]spZ", "=", 
         FractionBox[
          SqrtBox["N2"], "Q"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]spZ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}], ".", 
            RowBox[{"(", 
             RowBox[{"COV", ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Qs", "/", "Q"}], ",", 
                RowBox[{"Qb", "/", "Q"}], ",", 
                RowBox[{"Q1", "/", "Q"}], ",", 
                RowBox[{"Q2", "/", "Q"}]}], "}"}]}], ")"}]}], ")"}], "/", 
          SqrtBox[
           RowBox[{"N2", " ", "N1"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:N1=\>\"", ",", "N1"}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:N2=\>\"", ",", "N2"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:\[Nu]spZ=\>\"", ",", "\[Nu]spZ"}], 
         "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:\[Rho]spZ=\>\"", ",", "\[Rho]spZ"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:ds=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<BiSABRSpreadOption:\!\(\*SubscriptBox[\(d\[Alpha]\), \(11\)]\)=\
\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qs", "/", "Q"}], ",", 
            RowBox[{"Qb", "/", "Q"}], ",", 
            RowBox[{"Q1", "/", "Q"}], ",", 
            RowBox[{"Q2", "/", "Q"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:COV=\>\"", ",", "COV"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:eigenvalues=\>\"", ",", 
          RowBox[{"Eigenvalues", "[", "COV", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption: Det=\>\"", ",", 
          RowBox[{"Det", "[", "COV", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"SABRgeneric5", "[", 
       RowBox[{
       "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "zavg", ",", 
        "SqB0B\[Alpha]z", ",", "T", ",", "\[Mu]sp", ",", "\[Alpha]sp", ",", 
        "\[Rho]sp", ",", "\[Nu]sp", ",", "printflag"}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[55]:=",ExpressionUUID->"6f86bee1-258d-468f-92e8-3ff3cf098366"],

Cell[BoxData[
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "\"\<spell\>\""}], "]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"06caebed-0622-443d-83d8-82504378dfd0"],

Cell[BoxData[
 RowBox[{"Utilise", " ", "une", " ", "integration", " ", "numerique", " ", 
  "pour", " ", "le", " ", "calcul", " ", "du", " ", "z"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"5447409c-36e7-4a73-8cf4-1c63f6d01804"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"favg", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"F1", "-", "F2", "+", "K"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zavg", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "favg", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b1", "=", 
      RowBox[{"BiSABRspreadCderivative", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Csecond", "=", 
      RowBox[{"BiSABRspreadCderivative2", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cfavg", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ck", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       RowBox[{"Csecond", " ", "Cfavg"}], "+", 
       SuperscriptBox["b1", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SqB0B\[Alpha]z", "=", 
      SqrtBox["Ck"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"F1", "-", "F2", "-", "K"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:X1=\>\"", ",", "X1", ",", "\"\< X2=\>\"", ",",
          "X2", ",", "\"\< z=\>\"", ",", "z"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:b1=\>\"", ",", "b1", ",", "\"\< b2=\>\"", ",",
          "b2", ",", "\"\< SqB0B\[Alpha]z=\>\"", ",", "SqB0B\[Alpha]z"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:\[Alpha]=\>\"", ",", "\[Alpha]sp", ",", 
         "\"\< \[Nu]=\>\"", ",", "\[Nu]sp", ",", "\"\< \[Rho]=\>\"", ",", 
         "\[Rho]sp", ",", "\"\<  \[Mu]=\>\"", ",", "\[Mu]sp"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"SABRgeneric5", "[", 
       RowBox[{
       "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "zavg", ",", 
        "SqB0B\[Alpha]z", ",", "T", ",", "\[Mu]sp", ",", "\[Alpha]sp", ",", 
        "\[Rho]sp", ",", "\[Nu]sp", ",", "printflag"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<BiSABRSpreadOption:res=\>\"", ",", "res"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", "res", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[56]:=",ExpressionUUID->"1b05f5c0-6324-4c5c-81e7-a4410c2bce19"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRSpreadOptionVol", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
     "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
     ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"NormalImplicitVol", "[", 
    RowBox[{
     RowBox[{"F1", "-", "F2"}], ",", "K", ",", "T", ",", 
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[57]:=",ExpressionUUID->"fab906c4-36f8-45a5-9567-411b9291e0a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOptionNormalCorrelation", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", " ", "=", "\"\<Arithmetic\>\""}], ",", 
      "\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
      "implicitNormalvols"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001"}], ",", "T"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001"}], ",", "T"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"BiSABRSpreadOptionVol", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormalImplicitCorrelation", "[", 
      RowBox[{
      "\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
       "implicitNormalvols"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[58]:=",ExpressionUUID->"36ad0d67-98ef-4f5f-a89f-d48cb2ec9c85"],

Cell[BoxData[
 RowBox[{"Debiaisage", " ", 
  RowBox[{"(", 
   RowBox[{
   "symetrisation", " ", "du", " ", "role", " ", "S1", " ", "et", " ", "S2"}],
    ")"}]}]], "Input",
 Background->RGBColor[
  0.372549, 0.709804, 
   0.988235],ExpressionUUID->"2a2715d2-b192-4eff-96fb-36f8148f6b56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOptionCorrected", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "printflag"}], 
      "]"}], "+", "\[IndentingNewLine]", 
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", "\[Nu]2", 
       ",", "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
       "\[Nu]1", ",", 
       RowBox[{"-", "K"}], ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c21", ",", "\[Rho]c12", ",", "legendrelst", ",", "printflag"}], 
      "]"}], "+", "F1", "-", "F2", "-", "K"}], ")"}], "/", "2"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"eff7ff41-d820-4c3c-9844-d784f07892b7"],

Cell[BoxData[
 RowBox[{"Extended", " ", "BISABR", " ", "spreadoption", " ", 
  RowBox[{"(", 
   RowBox[{"with", " ", "coefficients"}], ")"}]}]], "Input",
 Background->RGBColor[
  0.372549, 0.709804, 
   0.988235],ExpressionUUID->"09019b49-3e06-4bf4-8c80-aa07094a07a9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"compute", " ", 
   RowBox[{"E", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", "*", "S1"}], "-", 
       RowBox[{"a2", "*", "S2"}], "-", "K"}], ")"}], 
     SubscriptBox["1", 
      RowBox[{
       RowBox[{
        RowBox[{"a1", "*", "S1"}], "-", 
        RowBox[{"a2", "*", "S2"}], "-", "K"}], ">", "0"}]]}], "]"}]}], " ", 
  "*)"}]], "Input",ExpressionUUID->"35116c6f-f12c-4178-aaa5-c7994097041c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralizedBiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "a1_", ",", "a2_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BiSABRSpreadOption", "[", 
     RowBox[{
      RowBox[{"a1", " ", "F1"}], ",", 
      RowBox[{"\[Alpha]1", " ", 
       SuperscriptBox["a1", 
        RowBox[{"1", "-", "\[Beta]1"}]]}], ",", "\[Beta]1", ",", "\[Rho]1", 
      ",", "\[Nu]1", ",", 
      RowBox[{"a2", " ", "F2"}], ",", 
      RowBox[{"\[Alpha]2", " ", 
       SuperscriptBox["a2", 
        RowBox[{"1", "-", "\[Beta]2"}]]}], ",", "\[Beta]2", ",", "\[Rho]2", 
      ",", "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
      "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[59]:=",ExpressionUUID->"748016e8-38d7-4df8-9dbe-697547646af6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralizedBiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "a1_", ",", "a2_", 
    ",", "legendrelst_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BiSABRSpreadOption", "[", 
     RowBox[{
      RowBox[{"a1", " ", "F1"}], ",", 
      RowBox[{"\[Alpha]1", " ", 
       SuperscriptBox["a1", 
        RowBox[{"1", "-", "\[Beta]1"}]]}], ",", "\[Beta]1", ",", "\[Rho]1", 
      ",", "\[Nu]1", ",", 
      RowBox[{"a2", " ", "F2"}], ",", 
      RowBox[{"\[Alpha]2", " ", 
       SuperscriptBox["a2", 
        RowBox[{"1", "-", "\[Beta]2"}]]}], ",", "\[Beta]2", ",", "\[Rho]2", 
      ",", "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
      "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "printflag"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[60]:=",ExpressionUUID->"2c3ee06f-5053-4d45-8f25-6f5b88ae758f"],

Cell[BoxData[
 RowBox[{"Application", " ", "numerique"}]], "Input",
 Background->RGBColor[
  1, 1, 0],ExpressionUUID->"238da538-496d-4c6b-babb-8ba4918317af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TestCorrelation", "[", 
     RowBox[{
     "\[Rho]1_", ",", "\[Rho]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
      "\[Rho]c12_", ",", "\[Rho]c21_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Test Correlation : Eigenvalues=\>\"", ",", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "\[Rho]1", ",", "\[Rho]s", ",", "\[Rho]c12"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]1", ",", "1", ",", "\[Rho]c21", ",", "\[Rho]v"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]s", ",", "\[Rho]c21", ",", "1", ",", "\[Rho]2"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]c12", ",", "\[Rho]v", ",", "\[Rho]2", ",", "1"}], 
            "}"}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[61]:=",ExpressionUUID->"33840c2a-a95a-4c65-9283-c1c96fde7080"],

Cell[BoxData[
 RowBox[{"Simple", " ", "execution"}]], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"2f061f29-e049-4657-8a47-35e16c09c408"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"-", "0.002"}]}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRSpreadOptionCorrected", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "}"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[62]:=",ExpressionUUID->"720dc7ab-f411-4cc0-962a-d46ca8f04882"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.007576542898443041`", ",", 
   RowBox[{"BiSABRSpreadOptionCorrected", "[", 
    RowBox[{"0.0418`", ",", "0.0435`", ",", "0.6`", ",", 
     RowBox[{"-", "0.1819`"}], ",", "0.3798`", ",", "0.0363`", ",", "0.0671`",
      ",", "0.7`", ",", 
     RowBox[{"-", "0.1136`"}], ",", "0.3797`", ",", 
     RowBox[{"-", "0.002`"}], ",", "1", ",", "0.808`", ",", "0.`", ",", 
     RowBox[{"-", "0.2`"}], ",", "0.`", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "-", "0.97390652851717172007796401208445205343`15.98851727710739"}], 
         ",", "0.06667134430868813759356880989333179286`14.82393921198711"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "-", "0.86506336668898451073209668842349304853`15.93704792110113"}], 
         ",", "0.1494513491505805931457763396576973324`15.17449983992403"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "-", "0.67940956829902440623432736511487357577`15.83213165885754"}], 
         ",", "0.21908636251598204399553493422816319246`15.340615344843284"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "-", "0.4333953941292471907992659431657841622`15.636884291582595"}], 
         ",", "0.26926671930999635509122692156946935286`15.430182679021605"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "-", "0.14887433898163121088482600112971998462`15.172819846180055"}],
          ",", "0.29552422471475287017389299465133832942`15.47059308666814"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.14887433898163121088482600112971998462`15.172819846180055", ",", 
         "0.29552422471475287017389299465133832942`15.47059308666814"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.4333953941292471907992659431657841622`15.636884291582595", ",", 
         "0.26926671930999635509122692156946935286`15.430182679021605"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.67940956829902440623432736511487357577`15.83213165885754", ",", 
         "0.21908636251598204399553493422816319246`15.340615344843284"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.86506336668898451073209668842349304853`15.93704792110113", ",", 
         "0.1494513491505805931457763396576973324`15.17449983992403"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
        "0.97390652851717172007796401208445205343`15.98851727710739", ",", 
         "0.06667134430868813759356880989333179286`14.82393921198711"}], 
        "}"}]}], "}"}], ",", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.3881481805504236`*^9, 3.3881485054545937`*^9, 
  3.3881485477199483`*^9, 3.438081141342285*^9, 3.43808230947945*^9, 
  3.438083372315612*^9, 3.438085614254923*^9, 3.4380856798160267`*^9, 
  3.962356539269951*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"608a92c6-d0bf-40ae-b003-c527d6276fc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.8"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0.5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.5"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", 
      RowBox[{"-", "0."}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", "0.0035"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOptionNormalCorrelation", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRSpreadOptionVol", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "}"}]}], "]"}]], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"38faf354-686c-4760-bbcc-87bd4717929d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8421595707239923`", ",", "0.004119050219556402`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.962356562802148*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"b7cd2380-7fa9-454d-8ead-15d04450bbde"]
}, Open  ]],

Cell[BoxData["Smile"], "Input",
 Background->GrayLevel[
  0.900008],ExpressionUUID->"60197d04-ba6f-448e-a56e-75fc043172a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "30"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", 
          ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
         ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}]}], 
        "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}]}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{
  3.388148567172949*^9, {3.388148635406887*^9, 3.3881486512974105`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"d7ba749c-ed81-41c9-b5e0-89c6ff839aca"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.962356568699998*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"28ab8934-29c4-4fa2-8fef-c9cb0386715e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.962356568729918*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"1d40a781-07c9-423e-b6ac-bffcb009a8d7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.010220202625056234`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.010858755238711893`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.010220202625056234`, "  \[Sigma]ATMnormal2=", 
   0.010858755238711893`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.962356568770079*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"116b9921-17e2-41af-8e8d-1362edab65c3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.8645184922281944`", ",", "0.8695172159508082`", ",", 
     "0.8743670616831828`", ",", "0.8790766770862387`", ",", 
     "0.8836545561721881`", ",", "0.8881090818288572`", ",", 
     "0.8924485304783196`", ",", "0.8966810308099487`", ",", 
     "0.9008144641056228`", ",", "0.9048562890212374`", ",", 
     "0.9088132691706357`", ",", "0.9126910783339546`", ",", 
     "0.9164937571409256`", ",", "0.9202229991009933`", ",", 
     "0.9238772562448457`", ",", "0.9274506792638926`", ",", 
     "0.9309319471237076`", ",", "0.9343030968617404`", ",", 
     "0.9375385294695825`", ",", "0.9406044265383875`", ",", 
     "0.9434588389207951`", ",", "0.9460526740954392`", ",", 
     "0.9483316971559674`", ",", "0.9502394883867672`", ",", 
     "0.9517211268011669`", ",", "0.9527272715881687`", ",", 
     "0.9532258225876741`", ",", "0.9532339533286935`", ",", 
     "0.9527461195628966`", ",", "0.9517666845880283`", ",", 
     "0.9503144661832967`", ",", "0.9484192657282366`", ",", 
     "0.9461184651652974`", ",", "0.9434538486089176`", ",", 
     "0.9404687613134888`", ",", "0.937205714173119`", ",", 
     "0.9337045241048997`", ",", "0.9300010333585885`", ",", 
     "0.9261263878072089`", ",", "0.922106798118906`", ",", 
     "0.9179636735351463`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADPCF2vIqrrP4YqusQV0+s/0x/UodD66z89
YFhpZSHsP/cRd+vlRuw/dYm3vGNr7D+GkHg48I7sP6q2yGqcsew/CB7j2njT
7D/toh0tlfTsP3pHqJD/FO0/LHOZ68M07T/1ET236lPtP0NOxYB3cu0/198i
CWeQ7T/I7AIMra3tP2hVdssxyu0/hVOym8/l7T8t+lnNUADuPxKRTnRuGe4/
qy5Jl9Aw7j9zEPFBEEbuPxpxIbe7WO4/X6W/pFxo7j+4vlDdf3TuP9RPL+e9
fO4/r++2cNOA7j8Sed995IDuP8Y7HW7lfO4/MUv3Z9907j/eiCXi+WjuPxxf
JlxzWe4/dtpAO5pG7j+78CEgxjDuP7gImPFRGO4/je5/1pb97T+ZDGVP6ODt
P9eu8IaRwu0/wwZzztOi7T8U4aod5oHtP7H7l1r1X+0/4tqy1A==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9, 3.9623565687722564`*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"d9d9d4dd-60ee-44cc-a20a-b79e880f7d78"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.09375`", ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[{{}, {{}, {}, 
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.012833333333333334`], AbsoluteThickness[1.6], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9ixO/TPo4p8z+9s+6rD0lk/f/mKv5
cqZRmb3Nff/e6XmT9j/VNOSuPVlqP+eIwoaijIn7d0pOOlidWGr/Z+XHS75J
E/Z7cGvKlf4qsd8h1/o6cEff/scJnxXcppTYV75UM+RY07P/58R93Sf1Suyt
tpwo2ze/a//fv6e+Xz9ZbP8LbF3H/m1acV4eqcX2uzx5mLTb2/YfdKjZ+IGh
2B7ivpb9BmFNCSvmFEHd07R/7TuvEC+LIqj9Dfs9VBeU7rxcaF8Btq9mf7FW
XdWzvEKo+RX7F35zfnyds9C+BmxeyX5Og6MhW5YUQPUX7O9IYvE5b19g/wOs
PmO/mtCdiPzt+fY/wPIJ+/s5em/0fsqzZ1gF4gfsn/pxUVSsMZAPBbE7GESZ
a3Nh8vZvjtxxSLucA9Nvv8R+ZbeYdQ7MfHvbl7xPhXZmw+y3X5OhY5oflA1z
n/3dnNqfd7mB8hD322cu/f5j4YssmP/sp6ywqOED8qH+t9+w5NjZTq5sWPjY
qz8/r+non21fBQk/+4762dGvNmfDwtfe8HPKO23THFj420/7vvYN9/kcWPzY
t5b+XxsK9E8VJP7sg7bt2fzGOs9+FyR+7asEDopwsOfb/4XEvz3TB+/2sNv5
9rMh6cNe5FGPLHt0gb01JP3YV169srzsVAEsfdnLyCX/F7cuhMbvFHvHk8fq
HNYU2gMAIoxFvg==
          "]]}}, {{}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0.0031602432404407286`},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      Method->{
       "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox["\"Implicit Normal Vol\"", TraditionalForm],
      PlotRange->{{-0.02, 0.02}, {0.0031602432404407286`, 
       0.005520766876792402}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], ",", 
     GraphicsBox[{{}, {{}, {}, 
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.012833333333333334`], AbsoluteThickness[1.6], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT95zli1yutem1/+2dd1p6SyfvbtHYd
Eb382t7mvn/v9LxJ+y/LX1l44ddr+zlHFDYUZUzcb5sQkZmq+Mb+z8qPl3yT
Juz/Llj++qnbG/sdcq2vA3f07S/t3L4nOfuNfeVLNUOONT372yZUWHzoe2Nv
teVE2b75XftXbTuRNWfjG/tfYOs69nPIPb5VcfmN/S5PHibt9rb9bxfJ6k79
8sYe4r6W/VXuKyb8F3kLdU/Tfp3ima8Pm7yF2t+w/6ug7fZXwW/tK8D21ex3
9jvaUF70Fmp+xf7r95U40ye8ta8Bm1ey/8QbJp61a2H6C/ZnhJadNjz11v4H
WH3G/tbgTbPPPwXywfIJ+3V/RZ4NYHhnz7AKxA/YLzTRryRPEsiHgtV6ntMv
GMDl7YsFPjoKuL2D6beXKlTcvjviHcx8+/il+5fEZLyD2W+/Y1/A3fqSdzD3
2V/x13++twYoD3G//fr32wouN7yD+c9eqPJ+7ZMGmP4G+2PWsnlPgeqh4WNv
6P09/T7QvCpI+Nnf61B99BNoHzR87WXi1WKKI9/Bwt++7JaD9Syge6HxY7/7
g6LCMaB/qiDxZ7+DY8bHQAmgfkj82ve+q7827e9b+7+Q+LefyZPq/+LBW/vZ
kPRhf33dh7aJh97aW0PSj/1htuJzlxe9haUve5GHq2SfNb6Fxu8U+42/p0d9
jX9rDwAHY12H
          "]]}}, {{}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0.8595898555003891},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      Method->{
       "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
      PlotRange->{{-0.02, 0.02}, {0.8595898555003891, 0.9532339533286935}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.3881485594698734`*^9, 3.3881485686885643`*^9}, 
   3.3881486537973948`*^9, 3.4380857081178303`*^9, 3.962356568847081*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"7a6bd1c4-f230-47f4-9b2c-93547312937c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Nouvelle", " ", "implementation", " ", "bas\[EAcute]e", " ", "sur", 
  " ", "normalheston"}]], "Input",
 Background->RGBColor[
  0.823529, 0.972549, 
   0.380392],ExpressionUUID->"2ea65a7c-6130-400b-b20b-384f8ccb5273"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Strategie", " ", "1"}],
  FontColor->RGBColor[0, 0, 1]]], "Input",ExpressionUUID->"f6a230e7-3dfb-436c-\
af66-0ddcadda147d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ", ",", "\[Lambda]", ",", "\[Theta]", ",", "S0", ",", 
      "\[Kappa]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "\[Mu]sp", " ", 
               SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
              RowBox[{
               SuperscriptBox["\[Nu]sp", "2"], " ", 
               SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
          SuperscriptBox["\[Alpha]sp", "2"]], "]"}], ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "8"}], ")"}]}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], 
          RowBox[{"2", "\[Lambda]"}]], "]"}], ",", 
        RowBox[{"100", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[Alpha]sp", "^", "2"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Mu]sp", " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Nu]sp", "2"], " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
       SuperscriptBox["\[Alpha]sp", "2"]]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Lambda]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S0", "=", 
      RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRNormalHestonSpreadOption: \[Lambda]=\>\"", ",", 
         "\[Lambda]", ",", "\"\< \[Theta]=\>\"", ",", "\[Theta]", ",", 
         "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", ",", "\"\< \[Alpha]sp=\>\"", 
         ",", "\[Alpha]sp"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"HestonNormalCall", "[", 
      RowBox[{
      "\[Rho]sp", ",", "\[Lambda]", ",", "\[Theta]", ",", "\[Kappa]", ",", 
       SuperscriptBox["\[Alpha]sp", "2"], ",", "S0", ",", "K", ",", "T"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380827912939*^9, 3.43808286061928*^9}, {
   3.438082932774144*^9, 3.4380829370396876`*^9}, {3.4380829679922185`*^9, 
   3.4380829855387564`*^9}, {3.4380833318158712`*^9, 3.438083353206359*^9}, 
   3.438083385768651*^9},
 Background->RGBColor[0.94902, 0.843137, 0.615686],
 CellLabel->"In[65]:=",ExpressionUUID->"c8007728-6047-4f4d-ade2-99f68f1f06d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[66]:=",ExpressionUUID->"d18ed378-bde6-423a-842f-b4fa37b016e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[67]:=",ExpressionUUID->"b4578f31-2782-4243-84bb-60f0ac26b4ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]sp", "=", 
       RowBox[{"\[Nu]BiSABR1", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "X1", ",", "X2", ",", 
         "\[Alpha]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[68]:=",ExpressionUUID->"a2011413-ddf0-4e2e-a104-f851532300d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Mu]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[69]:=",ExpressionUUID->"1c92858c-4a4a-4b2b-bdd8-8797f326e7ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Kappa]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]sp", "=", 
       RowBox[{"\[Nu]BiSABR1", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "X1", ",", "X2", ",", 
         "\[Alpha]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[70]:=",ExpressionUUID->"95a1288a-d8de-4b30-9d16-30d50321b488"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      SuperscriptBox["\[Alpha]sp", "2"]}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Mu]sp", " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Nu]sp", "2"], " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
       SuperscriptBox["\[Alpha]sp", "2"]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[71]:=",ExpressionUUID->"c0dfa895-6653-4de9-9642-74039fb88225"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Kappa]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\[Alpha]=\>\"", ",", "\[Alpha]", ",", "\"\< \[Nu]=\>\"", ",", 
        "\[Nu]", ",", "\"\< \[Rho]=\>\"", ",", "\[Rho]", ",", 
        "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", ",", "\"\< \[Lambda]=\>\"", 
        ",", "\[Lambda]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[72]:=",ExpressionUUID->"0f1e77b3-989e-4855-8f68-021739871632"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Strategie", " ", "2", " "}],
  FontColor->RGBColor[0, 0, 1]]], "Input",ExpressionUUID->"b823a046-6685-485f-\
9b0b-8e7512b83484"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ", ",", "\[Lambda]", ",", "\[Kappa]", ",", "\[Theta]", ",", 
      "S0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      SuperscriptBox["\[Alpha]sp", "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Theta]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]2", "=", "0.5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"S0", "=", 
      RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"HestonNormalCall", "[", 
       RowBox[{
       "\[Rho]sp", ",", "\[Lambda]", ",", "\[Theta]", ",", "\[Kappa]", ",", 
        SuperscriptBox["\[Alpha]sp", "2"], ",", "S0", ",", "K", ",", "T"}], 
       "]"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083427205886*^9, 3.4380834528464575`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"5b3dfbb0-d059-4fd8-8220-93a1f9f55974"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", "0.0"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"f633be31-4a60-44f8-ae6f-5388ee977790"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.008362738853775715`", ",", "0.008953837411903592`", ",", 
   "0.008323358079840325`"}], "}"}]], "Output",
 CellChangeTimes->{3.962356596457178*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"7f99471f-83a4-4f4c-a8e6-27b69e913c5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "30"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
       "\[Rho]c21", ",", "printflag"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.4380834943620825`*^9},ExpressionUUID->"52c5ec61-40a6-4425-802e-\
6928e65181cb"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 
  3.438085774098433*^9}},ExpressionUUID->"4983f109-a8c4-4c07-9ebb-\
9ea554837a1f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233638`", ",", "1.1794737833590507`", ",", 
     "0.5621491608076291`", ",", "0.1355382895996812`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233638, 1.1794737833590507`, 
   0.5621491608076291, 0.1355382895996812}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 
  3.4380857741004457`*^9}},ExpressionUUID->"b9c265b5-4cc6-4a59-b29f-\
ec9fcc88906f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Alpha]=\"\>", "\[InvisibleSpace]", "0.0041315812903778585`", 
   "\[InvisibleSpace]", "\<\" \[Nu]=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`", "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}], 
   "\[InvisibleSpace]", "\<\" \[Kappa]=\"\>", "\[InvisibleSpace]", 
   "0.0026301956208849187`", "\[InvisibleSpace]", "\<\" \[Lambda]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$26681"}]}], ")"}]}]}],
  SequenceForm[
  "\[Alpha]=", 0.0041315812903778585`, " \[Nu]=", 0.31830374813276047`, 
   " \[Rho]=", -0.1166587353908298, " \[Kappa]=", 0.0026301956208849187`, 
   " \[Lambda]=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$26681)],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 
  3.4380857741029177`*^9}},ExpressionUUID->"1a248160-7e0b-481c-9764-\
ce256cd7fe3a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.010220202625056234`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.010858755238711893`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.010220202625056234`, "  \[Sigma]ATMnormal2=", 
   0.010858755238711893`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 
  3.4380857748476267`*^9}},ExpressionUUID->"8037da12-a2eb-4bb4-8d57-\
9f015964b9d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.8671861963373699`", ",", "0.8679974523136006`", ",", 
     "0.868792519329466`", ",", "0.8695709157598699`", ",", 
     "0.8703321539228686`", ",", "0.8710757409677405`", ",", 
     "0.8718011798930735`", ",", "0.8725079706709811`", ",", 
     "0.8731956114862023`", ",", "0.8738636000703581`", ",", 
     "0.8745114351924252`", ",", "0.8751386182000065`", ",", 
     "0.8757446547111747`", ",", "0.8763290563882572`", ",", 
     "0.8768913428067899`", ",", "0.877431043404032`", ",", 
     "0.8779476995114112`", ",", "0.8784408664062913`", ",", 
     "0.8789101154497354`", ",", "0.8793550362080338`", ",", 
     "0.8797752385871939`", ",", "0.8801703549423286`", ",", 
     "0.8805400421398475`", ",", "0.8808839835380665`", ",", 
     "0.8812018909001675`", ",", "0.8814935061445286`", ",", 
     "0.8817586029798888`", ",", "0.8819969883586538`", ",", 
     "0.8822085037414494`", ",", "0.8823930261498057`", ",", 
     "0.8825504690041321`", ",", "0.8826807826934734`", ",", 
     "0.8827839549359093`", ",", "0.882860010853728`", ",", 
     "0.8829090128076748`", ",", "0.882931059974015`", ",", 
     "0.8829262876782551`", ",", "0.8828948664817237`", ",", 
     "0.8828370010748535`", ",", "0.8827529289283452`", ",", 
     "0.8826429187881252`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADy+BlE/b/rP+9X1peixus/s/Ew+CXN6z+m
uZdihtPrP9AwONHC2es/BnR5O9rf6z+pKIiWy+XrP4T/8NWV6+s/ugFL7Dfx
6z/C8e7LsPbrP8gkxGf/++s/UFcUtCIB7D+sM3SnGQbsP3sbtzvjCuw/ogXw
bn4P7D+QS31E6hPsP4//H8YlGOw/6uoVBTAc7D/IXT8bCCDsP8zDQiytI+w/
xwCyZh4n7D85WiwFWyrsPzTkeU9iLew/5bebmzMw7D/W3dJOzjLsPzbekN4x
New/GX1Y0V037D8aeIW/UTnsP+VS+lMNO+w/OwWxTJA87D+UJi572j3sP6E8
z8TrPuw/vEP8IsQ/7D/TAzKjY0DsP5FI62bKQOw/lsBmo/hA7D/aakuh7kDs
P50MK7ysQOw/ORbqYTNA7D8rQQYSgz/sPx+2x1ycPuw/J7SosA==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 
  3.4380857748508263`*^9}},ExpressionUUID->"49f2d6d8-fbac-4aad-858d-\
dbac7b04a17d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7748719999999949`", ",", 
   GraphicsBox[
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9n35Iuvzd/9r+9s+6rD0lk/e/D782
fdGx1/Y29/17p+dN2r/5o8EP1bOv7eccUdhQlDFx/7Kd05PaLr+2/7Py4yXf
pAn7LxhYXDx087X9DrnW14E7+vazlVRa37r/2r7ypZohx5qe/Ss1Oqadfvra
3mrLibJ987v2t/z/cHXq69f2v8DWdezfxej9xvzja/tdnjxM2u1t+w99fHd6
w7fX9hD3tew/oXIk/f9vmHua9geEi2xRYnwDtb9h/xrjkuWSbG/sK8D21eyv
lt5u/ZjrDdT8iv2LWD/k1fG/sa8Bm1eyf4J3rcsrYZj+gv39/+WPqUq8sf8B
Vp+x/9UrUVYDGSAfLJ+w/0SsvTSHwht7hlUgfsD+M4eddNYqA/lQcJxhU5qc
Olze3jJKhzVaC67f3uRJpX+SLtx8+6fbZ882NoDbb3/t7iW/c0Zw99mb3Ztw
z9AUKA9xv71kbcTFWHO4/+ylKlr3B1rC/W//NOhXMK/1G1j42FuzbvSZYPPG
vgoSfvZT1PSqb9m+gYWv/UKb80de28HCp8N+j/MfpSP2b2DxY3+Z2WhxsgNQ
PyT+7Cd6vE47BeTvgsSv/bQDaYt/APl/IfFvfyvLe+E7IH82JH3Yz+XR3rMG
yLeGpB97S7FXicZAPjR92Ws7sgk1A+2Dpj97+W3HY+YA3QMAsPZTYw==
      "]]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
    PlotRangeClipping->True]}], "}"}]], "Output",
 CellChangeTimes->{{3.4380834809558325`*^9, 3.4380834963777075`*^9}, {
  3.438085759101242*^9, 
  3.4380857748561373`*^9}},ExpressionUUID->"f5d40895-53ee-44cc-9ab7-\
9eb3697cb967"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "10"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
       "\[Rho]c21", ",", "printflag"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.4380835046902075`*^9},ExpressionUUID->"fc4722dc-5726-4bcd-a0c1-\
244a455bd6e9"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 
  3.43808578112087*^9},ExpressionUUID->"a17f4abd-c389-4747-bfa8-0492e86da790"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233638`", ",", "1.1794737833590507`", ",", 
     "0.5621491608076291`", ",", "0.1355382895996812`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233638, 1.1794737833590507`, 
   0.5621491608076291, 0.1355382895996812}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 
  3.438085781122747*^9},ExpressionUUID->"1f0ade3a-0b02-444a-97e0-\
85b191db48af"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Alpha]=\"\>", "\[InvisibleSpace]", "0.0041315812903778585`", 
   "\[InvisibleSpace]", "\<\" \[Nu]=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`", "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}], 
   "\[InvisibleSpace]", "\<\" \[Kappa]=\"\>", "\[InvisibleSpace]", 
   "0.0026301956208849187`", "\[InvisibleSpace]", "\<\" \[Lambda]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$32710"}]}], ")"}]}]}],
  SequenceForm[
  "\[Alpha]=", 0.0041315812903778585`, " \[Nu]=", 0.31830374813276047`, 
   " \[Rho]=", -0.1166587353908298, " \[Kappa]=", 0.0026301956208849187`, 
   " \[Lambda]=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$32710)],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 
  3.438085781125614*^9},ExpressionUUID->"b413d7eb-caa4-4679-b631-\
25012ba387d4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.007236307082792201`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.007413518035210933`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.007236307082792201, "  \[Sigma]ATMnormal2=", 
   0.007413518035210933],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 
  3.438085782396525*^9},ExpressionUUID->"b951ac38-9a23-43d0-8f9b-\
dad2758cb5b9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.7329452356224138`", ",", "0.7366278726449398`", ",", 
     "0.7402754620240658`", ",", "0.7438845993757446`", ",", 
     "0.747451557837655`", ",", "0.7509722617641598`", ",", 
     "0.7544422597766575`", ",", "0.7578566980017771`", ",", 
     "0.7612102940499842`", ",", "0.7644973129691721`", ",", 
     "0.7677115467289758`", ",", "0.7708462975016053`", ",", 
     "0.7738943692410436`", ",", "0.7768480677845266`", ",", 
     "0.7796992133066234`", ",", "0.7824391681176202`", ",", 
     "0.7850588831199719`", ",", "0.7875489661734003`", ",", 
     "0.7898997754994498`", ",", "0.7921015401976008`", ",", 
     "0.7941445092078206`", ",", "0.7960191274279995`", ",", 
     "0.7977162362033088`", ",", "0.7992272918562047`", ",", 
     "0.8005445936699145`", ",", "0.8016615092398296`", ",", 
     "0.8025726842007613`", ",", "0.803274221425358`", ",", 
     "0.8037638168116656`", ",", "0.8040408403624433`", ",", 
     "0.8041063562694951`", ",", "0.8039630799395857`", ",", 
     "0.8036152760775339`", ",", "0.8030686058671125`", ",", 
     "0.8023299354441954`", ",", "0.8014071209985787`", ",", 
     "0.8003087795131458`", ",", "0.7990440670253651`", ",", 
     "0.7976224658462632`", ",", "0.7960535941385506`", ",", 
     "0.794347040698086`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACmOxiRSXTnP1Cgyp10kuc/wZZtKlaw5z/s
I0oT583nPzA5iIcf6+c/8V0P+/YH6D8rwQ4YZCToPxwcn7BcQOg/3VfKsNVb
6D+ao6IRw3boPwXNPs4Xkeg/+GLA2sWq6D/SXM4fvsPoP/gMo3rw2+g/1M27
w0vz6D+GlsXdvQnpP/bnjc4zH+k/4tO245kz6T+Badzk20bpP05RSFTlWOk/
1Q7rvqFp6T8cZuka/XjpP9BnPzPkhuk/PPoSHUWT6T8YqRmyD57pP8y0lAk2
p+k/P8Tp6Kyu6T+fvNcjbLTpP3JBXeVuuOk/YClA27O66T/T3NVAPbvpP8UF
8ccQuuk/aDUqYje36T8PmNTuvLLpPyG1KtSvrOk/mg3viyCl6T+IvVYoIZzp
PxD6/dzEkek/nqqrjB+G6T/RBhZjRXnpPwkgL3xKa+k/tZOxFA==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 
  3.4380857823996553`*^9},ExpressionUUID->"121d9ca5-ad13-426e-9bd3-\
b4bbfc9df9b4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3108289999999982`", ",", 
   GraphicsBox[
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9y6wlJnqWPLe//bMua0/J5P0BC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdhvYNnRLv/6uf0OudbXgTv69n+M5f/9jf2FfeVLNUOONT37tQ/ySaSovLC3
2nKibN/8rv0yMvM3xDi8sP8Ftq5j/93wUxuuRr+w3+XJw6Td3rZ/1uJFgofL
XthD3Neyn/Ws3TnxiS+g7mna/yPpwK2jq15A7W/YfynmnPy+wy/sK8D21ez/
wbO46sNtmPkV+6+c3X3Y+/ML+xqweSX726YdvbuX8yVUf8H+b897zxnLv7T/
AVafsf/R5W2PZxoD+WD5hP2NmXee3HZ7ac+wCsQP2O8X6BHyNALIh4KrfK/3
LcyEy9vLpL2U+lsB129/Id3e+Ekb3Hx7m19Csq6T4fbbS6yU3MQ/7yXMffZn
tkzhNFsOlIe4397+yMsXa9a9hPnPfv6e68o5W2D6G+yLHGOf5u14CQsf+wRN
h9ubd720r4KEn/3lO1cdbHe/hIWv/VHWj8cFgPLQ8LfPMNVKMt/+EhY/9vwz
rrzbswmoHxJ/9opbta6sXwPUD4lf+1m877sVlr60/wuJf/uOvWEainNe2s+G
pA97gV9/7xyZ+NLeGpJ+7OetWt0jD/Q/NH3ZX2QTS3atfAmN3yn2nAr6NV7Z
L+0BsDRbxw==
      "]]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
    PlotRangeClipping->True]}], "}"}]], "Output",
 CellChangeTimes->{3.4380835073464575`*^9, 
  3.4380857824060087`*^9},ExpressionUUID->"189810e4-233b-479f-a6b4-\
fd3878264e69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "10"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"\[Rho]c12x1", "=", 
      RowBox[{"-", "0.3`"}]}], ";", 
     RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ";", 
     RowBox[{"\[Rho]c21x2", "=", 
      RowBox[{"-", "0.3`"}]}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<BiSabrHeston:Implicit Normal Correlation T=\>\"", "<>", 
         RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
         "}"}]}]}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.4380835187370825`*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"ad490b0a-5b4c-4bac-b7ca-9d4dc7c123c0"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.962356613134202*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"a13589ce-ea13-48bf-adf1-c8cafce63240"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.962356613136197*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"c352eb0a-efca-4fdc-8bef-534c7484e1d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.962356613471301*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"bf409200-7346-4c87-aa43-a1c4fa0d1507"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9, 
  3.9623566139101267`*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"8b4028bd-c4d5-4902-9f86-d02f5b5973a8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.234375`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {{}, {}, 
         {RGBColor[1, 0., 0], PointSize[0.009166666666666668], Thickness[
          0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9C60lJnqWPLe//bMua0/J5P0eC07N
LZn03N7mvn/v9LxJ+/dMy9UK2/Dcfs4RhQ1FGRP3v1X2En5+9rn9n5UfL/km
TdhvYdnRLv/6uf0OudbXgTv69v+J5f/9jf2FfeVLNUOONT371Q/ySaSovLC3
2nKibN/8rv2SMvM3xDi8sP8Ftq5j/43wUxuuRr+w3+XJw6Td3rZ/1uJFgofL
XthD3Neyn/us3TnxiS+g7mna/zvpwK2jq15A7W/YfzHmnPy+wy/sK8D21ez/
wbO46sNtmPkV+y+e3X3Y+/ML+xqweSX726YdvbuX8yVUf8H+L897zxnLv7T/
AVafsf/x5W2PZxoD+WD5hP2NmXee3HZ7ac+wCsQP2O8f6BHyNALIh4KrfK/3
LcyEy9vLpr2U+lsB129/Pt3e+Ekb3Hx7m19Csq6T4fbbS6yU3MQ/7yXMffZn
t0zhNFsOlIe43972yMsXa9a9hPnPft6e68o5W2D6G+wLHGOf5u14CQsf+3hN
h9ubd720r4KEn/3lO1cdbHe/hIWv/VHWj8cFgPLQ8LfPMtVKMt/+EhY/9rwz
rrzbswmoHxJ/9spbta6sXwPUD4lf+9m877sVlr60/wuJf/v2vWEainNe2s+G
pA97vl9/7xyZ+NLeGpJ+7BesWt0jD/Q/NH3ZX2QTS3atfAmN3yn2nAr6NV7Z
L+0BnqRbvw==
           "]]}, 
         {RGBColor[0., 1, 0.], PointSize[0.009166666666666668], Thickness[
          0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9U582CPlIPbW//bMua0/J5P3XNx36
keD51N7mvn/v9LxJ+3fN3i1VWPHUfs4RhQ1FGRP377zKk1e1/Kn9n5UfL/km
TdgvXv1madW1p/Y75FpfB+7o25/hxK2dz/rMvvKlmiHHmp796muLhUJNntlb
bTlRtm9+137lhfrCmsnP7H+BrevYn/dqV9Xzic/sd3nyMGm3t+2vu5iv0HPg
mT3EfS379cIvhwm9fwZ1T9P+lt1PbpfIPofa37B/3wGf42u9n9tXgO2r2W90
73jZtsrnUPMr9neUra5oX/7cvgZsXsl+7l2BJRJXYfoL9ivtmiiQwPTC/gdY
fcb+lK12N4L1gXywfML+26vZZF9Ev7BnWAXiB+yXDXt7g78DyIeC0Kd2/Xs2
w+Xt9729oXvvHly/fcEK6Q9JnC9h5tt3PV3ham78Ema//cFV4ftdY17C3Gef
svsYa3kLUB7ifnv//kN3N65+CfOf/d0fkva3L8L0N9gfOzSr+dq3l7Dwsf/w
ddbmVqlX9lWQ8LOvuhX+9aTNK1j42ps+KlNqiX0FC3/74tx5LVNrXsHix35a
ZdfWBzOB+iHxZ39jz9OZXluB+iHxa98UGZix+9wr+7+Q+Lf3nV+8Qv7ZK/vZ
kPRhv/2LqHDm71f21pD0Y/+76L51P99rWPqyr5r17GO//Gto/E6x79m+2jtf
77U9AM6JXGM=
           "]]}, 
         {RGBColor[0, 0, 1], PointSize[0.009166666666666668], Thickness[0.01],
           LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9qnVhEjObX9nf/lmXtadk8v6fMrpL
DXpe2dvc9++dnjdp/0xe4wcvJr+yn3NEYUNRxsT9WdkKfOtmvbL/s/LjJd+k
CfsVIuINsxe8st8h1/o6cEff/kNHXRS4lr6yr3ypZsixpmf/hamXthSveGVv
teVE2b75XfsTd3zmnbDqlf0vsHUd+036Lz9zW/3KfpcnD5N2e9v+Er0Ejgag
PMR9Lfs5TJMuKq+Auadpv7RG3BXpJTD7G/YnP/7cEjzvlX0F2L6a/QxR0m92
TIOZX7Ffb+KmcNveV/Y1YPNK9qusZf1xtRGmv2D/6+TJsTUlr+x/gNVn7E+U
Ujqtlwrkg+UT9sdPXhf8IfiVPcMqED9gv98pjoMnHIB8KDg+Ndv1iDZc3j6d
6d7/TyJw/faqphfjMv68hJlvH/f6WJ7Vo5cw++1tWhuUGo+9hLnPvp/344LQ
lUB5iPvtOXvFFl3segnzn32IkuBDvmyY/gb7hPNly9S8XsLCx76me2+2ocZL
+ypI+NlnilhNc2N9CQtfe+vqJveahy9g4W+vde2x/fM9L2DxYz/724rzs6a/
sK+CxJ/9p78ZV1YUvrDfBYlfe7eOw/sUvV/Y/4XEv33ZvnvzRFRe2M+GpA/7
ytdWpv1/nttbQ9KPvXu6O9u8K89h6ct+38mJ+T5rnkPjd4r9lVtVe5c0P7cH
AOuGU9U=
           "]]}}, {{}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{None, None},
       AxesOrigin->{0, 0.6489068687682136},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       Method->{
        "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
         "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
             Identity[
              Part[#, 1]], 
             Identity[
              Part[#, 2]]}& ), "CopiedValueFunction" -> ({
             Identity[
              Part[#, 1]], 
             Identity[
              Part[#, 2]]}& )}},
       PlotLabel->FormBox[
        "\"BiSabrHeston:Implicit Normal Correlation T=10\"", TraditionalForm],
       PlotRange->{{-0.02, 0.02}, {0.6489068687682136, 0.8494183042473522}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {
          Scaled[0.05], 
          Scaled[0.05]}},
       Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
       {GrayLevel[0], 
        RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
        GraphicsGroupBox[{
          RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
           GraphicsBox[{{{InsetBox[
                GraphicsBox[{
                  {RGBColor[0, 0, 1], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 0.58},
                 ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
               InsetBox[
                GraphicsBox[{
                  {RGBColor[0., 1, 0.], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
                 ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
               InsetBox[
                GraphicsBox[{
                  {RGBColor[1, 0., 0], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 2.9},
                 ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
            AspectRatio->1.0952380952380953`,
            FormatType->TraditionalForm,
            PlotRange->{{-0.1, 3.26}, {-0.1, 
             3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
           Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->{511., Automatic},
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.4380835274089575`*^9, 3.43808579513346*^9, 
  3.9623566157319517`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"874db9a4-b840-41ca-89e8-fab0d560a3ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", " ", "=", "\"\<Arithmetic\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
      RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
      RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]s", "=", "0.8"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]v", "=", "0.5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}], ",", "callvalues2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.020"}], ",", "0.02", ",", "0.001"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikevalues", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
             "\[Rho]2", ",", "\[Nu]2", ",", 
             RowBox[{"strikevalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "T", ",", "\[Rho]s", ",", 
             "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}],
            "-", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"F1", "-", "F2", "-", 
              RowBox[{"strikevalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"callvalues2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikevalues", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BiSABRSpreadOption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
             "\[Rho]2", ",", "\[Nu]2", ",", 
             RowBox[{"strikevalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "T", ",", "\[Rho]s", ",", 
             "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", 
             "legendrelst", ",", "0"}], "]"}], "-", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"F1", "-", "F2", "-", 
              RowBox[{"strikevalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"callvalues", ",", 
          RowBox[{"PlotLabel", "->", "\"\<Heston BiSABR\>\""}]}], "]"}], 
        "\[RawEscape]"}], "]"}], "\[RawEscape]"}], ";", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"callvalues2", ",", 
         RowBox[{"PlotLabel", "->", "\"\<BiSABR\>\""}]}], "]"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<correlation \[Rho] spread=\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
          "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Nu] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Mu] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Mu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Lambda] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}]}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.438085824272683*^9, 3.438085866155608*^9}, {
  3.438085901336306*^9, 3.4380859221525373`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"77459da3-e078-4156-b223-7bc87bf8e6c5"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.962356629912611*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"c27ec56f-9638-491f-8b65-deee22e87538"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.962356629915608*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"66cbdd06-5bb1-487d-bfd5-392f38a60544"],

Cell[BoxData[
 RowBox[{"\[RawEscape]", " ", 
  GraphicsBox[{{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9DeVtBcXRBva3f9Zl7SmZvJ9BceNV
16lG9jb3/Xun503a7xD/+W6BlKn9nCMKG4oyJu4/ULxRsvSLuf2flR8v+SZN
2H/A7XLnK11r+x1yra8Dd/TtZ7h2e//MS3b2lS/VDDnW9OxPONu59FS5o73V
lhNl++Z37V9Q9T555Uln+19g6zr2O9QGhz1Mc7Pf5cnDpN3etr8h4OBVowhP
e4j7WvZv+LtNQn+5D9Q9TfstRG155fUDoPY37FeIme0V4BJkXwG2r2a/gHZl
mtnMEKj5FfsdnmolOpmE29eAzSvZ7/DNRNVJJgqqv2D/idL6Q0ERsfY/wOoz
9l/5VTjpWXmC/Q+wfML+kDSVGLHSJHuGVSB+wP4l63dfL1+eYs8ABS2pHs07
hNJh8vbLcgPy43ZlwvTby128ZL5hYQ7MfPtFWxX3zT6dD7Pf/rKkS5nf3EKY
++y3taayB1cU2/+BuN/ehK3wt3V2Mcx/9gwXeTbGlBXC/G+/SG72trfe+bDw
sS/adZzd53O2fRUk/OwnpFz4G/4wAxa+9mb/HareCafBwt9+9oWFlREdybD4
sXfntd6fZJ1oXwWJP/vuEw0iH4Pi7HdB4tdenqeToX5ulP1fSPzbO8XzG6X5
hdvPhqQPe/eNlU41sSH21pD0Y58p82DKokOBsPRlz9t3Z8KN137Q+J1i/6ve
+0vFfS97AE6hOu0=
      "]]}, {{}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   Method->{
    "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
     "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& )}},
   PlotLabel->FormBox["\"Heston BiSABR\"", TraditionalForm],
   PlotRange->{{-0.02, 0.02}, {0, 0.004753422099697804}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}]}]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.9623566301559935`*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"01caaf7d-2d67-484f-b17b-ace25b47153f"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9DXYi87mSXexv/6zL2lMyef8B77iN
62td7W3u+/dOz5u0/0GF45WKrW72c44obCjKmLg/QaT18mxeD/s/Kz9e8k2a
sF/hWUHkjk5P+x1yra8Dd/Ttb7hnKvFU19u+8qWaIceanv0KydmL9/3zsbfa
cqJs3/yu/Q8uCqhXMPrb/wJb17Hf4Ee+9Pe5Afa7PHmYtNvb9m9o9GaOuxVo
D3Ffy36PCxv3r7QMhrqnaX/AN6F8ngMhUPsb9gdM5slxLAqzrwDbV7P/Ru3D
iAWhEVDzK/Y/mBArZVIQZV8DNq9k/4OYN++unYiB6i/YbzHhztmQ9Hj7H2D1
GfsNHvqGemkl2v8Ayyfs3zH31eHks0n2DKtA/ID9exwio84sSrFngIIURUVD
rY1pMHn7ik1XCn78z4Dpt0+by5+fNz0bZr69yYSnvOYNeTD77bPfsf8uflgA
c5/9H2vumTM3F9n/gbjf/k4nb/7kNUUw/9l3sE2IrzlVAPO/fa7wkQmKRnmw
8LFP+W/d76ebbV8FCT97+e7dc1obMmDha79o+8s9EippsPC3v7oi48JE/hRY
/Nhn/G+9XWCVZF8FiT97H81nj9fOSbDfBYlf+7LzonLMcXH2fyHxb39pSd1+
pmvR9rMh6cO+aCNLoe20SHtrSPqx72JT99aeGg5LX/aVraWZK0+FQuN3in2q
o4f4cf0QewCqfT1z
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"BiSABR\"", TraditionalForm],
  PlotRange->{{-0.02, 0.02}, {0, 0.00456581114913401}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.962356630202256*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"45fe8763-7443-4c90-9546-cee648d778af"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"correlation \[Rho] spread=\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}]}],
  SequenceForm["correlation \[Rho] spread=", -0.1166587353908298],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.962356630207275*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"f87def0e-284d-4204-8aeb-559b52a0a5f7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Nu] spread=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`"}],
  SequenceForm["\[Nu] spread=", 0.31830374813276047`],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.9623566302092743`*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"4c1cf9ea-5535-4c42-8c38-db4faf788031"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Mu] spread=\"\>", "\[InvisibleSpace]", 
   "0.000781149540185173`"}],
  SequenceForm["\[Mu] spread=", 0.000781149540185173],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.9623566302122917`*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"1145cffd-fe7a-4e16-8840-cda52bde9f10"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Lambda] spread=\"\>", "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$92165"}]}], ")"}]}]}],
  SequenceForm[
  "\[Lambda] spread=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$92165)],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9, 3.962356630214286*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"4c16ba2e-06a7-439c-af17-ddf09534819c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.25`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.4380859255048656`*^9, 3.9623566302152863`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"939439e9-1bbe-4744-8012-cf8f70945872"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Rho]", "=", 
       RowBox[{"-", "0.11665"}]}], ",", 
      RowBox[{
      "\[Lambda]v", "=", "\[InvisibleSpace]\[InvisibleSpace]", 
       "0.09975497699499274"}], ",", 
      RowBox[{"StdDev", "=", "0.00413158"}], ",", 
      RowBox[{"\[Kappa]", "=", "\[InvisibleSpace]", "0.00263019"}], ",", 
      RowBox[{"S0", "=", "0.005"}], ",", "V", ",", 
      RowBox[{"\[Tau]1", "=", "3"}], ",", 
      RowBox[{"\[Tau]2", "=", "10"}], ",", 
      RowBox[{"\[Tau]3", "=", "30"}], ",", "Vinfini"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      SuperscriptBox["StdDev", "2"]}], ";", 
     RowBox[{"Vinfini", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Lambda]v"}]]}], ";", 
     RowBox[{"Plot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{"S0", ",", "k", ",", "\[Tau]1", ",", 
           RowBox[{"HestonNormalCall", "[", 
            RowBox[{
            "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", ",",
              "V", ",", "S0", ",", "k", ",", "\[Tau]1"}], "]"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{"S0", ",", "k", ",", "\[Tau]2", ",", 
           RowBox[{"HestonNormalCall", "[", 
            RowBox[{
            "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", ",",
              "V", ",", "S0", ",", "k", ",", "\[Tau]2"}], "]"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{"S0", ",", "k", ",", "\[Tau]3", ",", 
           RowBox[{"HestonNormalCall", "[", 
            RowBox[{
            "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", ",",
              "V", ",", "S0", ",", "k", ",", "\[Tau]3"}], "]"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{
          RowBox[{"-", "8"}], " ", "StdDev"}], ",", 
         RowBox[{"8", " ", "StdDev"}]}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.5", ",", "0.5", ",", "0."}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0.5", ",", "0.5"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.5", ",", "0.", ",", "0.5"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<T=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Tau]1", "]"}]}], ",", 
          RowBox[{"\"\<T=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Tau]2", "]"}]}], ",", 
          RowBox[{"\"\<T=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Tau]3", "]"}]}]}], "}"}]}], ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0."}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "->", "\"\<NormalHeston: imp. vol.\>\""}]}], 
      "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4380835763464575`*^9, 3.4380836581902075`*^9}, {
  3.4380836916589575`*^9, 3.4380837012527075`*^9}, {3.4380841849089575`*^9, 
  3.4380842056902075`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"ff3f5f4a-214a-4079-a048-382b52ea6740"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.21875`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{{}, {}, 
         TagBox[
          {RGBColor[1, 0, 0], AbsoluteThickness[1.6], Opacity[1.], 
           LineBox[{{-0.03305263865091265, 
            0.0059725973840056975`}, {-0.03303236432598039, 
            0.005971712101559965}, {-0.03301209000104812, 
            0.005970826682061648}, {-0.03297154135118359, 
            0.005969055431633967}, {-0.03289044405145453, 
            0.005965511068971821}, {-0.03272824945199641, 
            0.005958416392419381}, {-0.032403860253080174`, 
            0.005944200282774937}, {-0.0317550818552477, 
            0.0059156610278792475`}, {-0.030348381600525772`, 
            0.005853289542329702}, {-0.029034900988787696`, 
            0.005794436232018614}, {-0.028411983104713462`, 
            0.005766314837148426}}], LineBox[CompressedData["
1:eJwd13k8VN//B3AVbXyQSiX9mKz1SfmESpa3iCKlELLLHqk7c83YZrU2iOy7
qci+tOCTbSKlPmRfUraEEiJJZet7/P6Yxzyej/uYM/ece87r/b6EqzeMndfz
8PB8Rp+1b2FJzYJFgXSuSG+8kkcaBb4o2TLillK48WFnvd6oUYCqqVvfk53M
ra7Xa+Esk8H8V0dwgFISN5X75jmxggzRlzCbj40J3N3falRbiGRQ1r4sUonH
c3f6HXSXOkoGiZGhs/O8cVz5IMqdy5Pe4L2n1DqjKIYr4W60mJ7rDQdno4O2
2Nzhpt51mM1z8QbDKUXr0qEo7spI6V/s//MGMbkmd4VjkdysZiOJl+9wID97
5IeZsLlEfmuxz9E4RCdVPT5OC+XWrKgc3nsWB0amUc5AXxC3+lbyu328OKzy
/pNhsMzk8jMlDBmVJMg6qpZ5OJPGTZn+SlUkk8B9d8lms04f7mCs2U4+BRLk
+TvXM/eTuKT1UnzJ40Q46Os00vfAg+sXM+Dd8oAIat5K55ul7LliZbvbM5yI
EPGoOmwhWpdLtTkpkXuQCD8Cte4S4k/Ds+22OokLGBwi7Dy12VAXKjl5iXU/
MLhaOzH8db0eOLr/bTM1j0HLrxjJ6ptnwMrzlobOdwxyr49lmhkawJ9vVXYL
MxgU/63b+mLdReCxr2ITJzBw2PnlzeK/l+F7/dvgF/0YOM0nOz+KtQeh5n9i
vzZg0OA2vs221h6eDbS/OI0sPXC0dsuEPTj/NiWlPsdg7EWTqIOmA/C3X9cy
qMfAJXGlUWjCAZ46NBQWcTFwO+lw8LqmI/ARGsQjKjHwZMjPyE04wybN4td5
pRg0z+OpndtdYIPPAp8w8iH3ujN0TRcYvX7yFbkEg+lLlpyeWBcwuCw0rFuM
gZdUxKVgTVfgjzJ3+VKAwc2XM49HYt0gu1909/kcDHCBCp90TQ/o012y9M/A
YCq/5Um/pweEne2M+ZSOgaP++OzeVA8wDTPETZGNQ3a6p/z0AKPmahXFNAyO
8OBXEks94cBQcM1MMgZfviuevLPfCyIsao9FxWNQer2bqh14E5Kr5tyMI9H4
6h/2Xk25CXaFmtFdERjICUw/ZT68CS9spjzNkTPyeReeDd0E/MbzM3bhGER+
UvICdbSO2zMiKLcwuOYQY6uOnqNcgEjqf8EYyFw2gmOuJCA0tU4u09B1MbHm
CSoJ9mjWHE9CLh0atUiPI8GbtIdqysjq1/yIvPUkiEvI8fSiYmBCz87uEMeh
JeaG76Q/Bsy8Jf4bHTjsoAdgm30xeOn1Mmn/BA4qzNQrJT4YCCjfken5g8MN
Z5MVM+SkWlnQUPAGYqunTy4Fg5LOS0T+MG9I4N7VNiVjMLCS8zZHgwxt730v
tpIw2P+c6GxlSgaDoNXNLGS3MI05QQ8ypPluYKggz4t08pOTyDC5qpCfQcSA
X35V8/R3MixhKt99MQxUjU2zh3Mp4LfTlGJ6AwPaLomjcVwKJLG2HNiO3NA/
UXumhwI9lq6pHV4YXHSlvy3e4AOdbeH1JsiuAfn8VFsfiHW5ss/uOgbxD3iI
e3b4wtF/2XtSPNB+FvnJo3fAFybTG2+4ISvTpqOImr4wNtTldRy54/K7oiY3
X3g8G+Paew0DQb4nE9QaX1A1GjgtgTxwM98nv8MX7uh9GJlzx6Cwn7Op95Mv
HNrNf7AR2eBJpIyiiB8kVM08xpBDHF0dRlz8IIVbUd7ihsHlVptZwQA/+Gyb
l5GDLK1mSle74wcS52aPMJHrRU6lx1X5gaEG+8Ix5NU6sT49YX+QfyEVkOuK
wRuFbW4kGX8Qa/lVHIKclrzpZ+ZJf2CaHwp3Rj6Jze/47eQPRpALMsgUyZaL
BU/9QTTzQVKhCwZ6EQ1DvS3+oFUjJRqNLPqr0ot31B8SE0fUceQnrTkRNoIB
4DzCH6KJPEtjvhJyDIBbtBMb3ztjwP1CMVf3CQC5i9+bnyPfNvMad4sMgLdP
S9WLkA8dtuKtrwiAFLMfoixktwFlLVyACjmrHmVKyMf1/27lEKjAammtJyBv
LCPYvjlGBQ/9Rh9h5KwIwQBZByrYKmoMzjhhQPrFy29CpkJuVnrkMLK201Iy
PZwKZ7yNxtqRh9U+V7wto0Ksv1dkOXJJzqAeXxMV2n6UDuQh07Z3d/8zTIWG
xZXudOTz9CYn2x9UKJXSIccgi0/WfWdvpcGenU61ociTZv+yKiRooHnWo5iK
XFlfvG1UmQY94XO6OPKVlNQjGnY0kN79w8MRWTmVEqJEpkHKVg0HK2TBNJOB
A5E0aFrastcUeSLtiLJkFg12Gwcln0duSOcPF62igWRTeP8Z5IyMTx8EOmjQ
5vDnozayb+bzExsmaKBiVFOiiWzKyYz6/YcGAjkPQA358F3/8RlROlQ5LUaf
QN58z1xjXIEOUt+sCo4hf7ynFNd/mg6bQkdCVJBr7wtNdljRwV//j8yak7Im
T70m0kFvPjxszcTsxiTuLTqsD3EoXvv9+Qf3Z8o4dBA5ZZG4Nr58Dl2vsIIO
VwvP6Kz9//pcq/R7LXSQjdv4aO3++nOPzyeN0SF5q8f/339F3vZzUct06HIz
6F2bn373z7b6LQyIMvKNXJt/ebfzssZOBuzJbeJbWx/pnk65p5IMmMnaobW2
fnd6TpkoH2LAk3pZ9bX1Xe0poZUcZ4DY687fHsievfvyD+owILVpyscbua83
vDv7AgOcDmo/pSPrvf3NQ7BkgHrs/Uo2MqGv23wXxoDTz1/8uYd8u08nMCaA
Ae+x/TqlyMt9D4v/CmOA0FK9Xi1yz7tIPt5MBuRP/YnsR9Z5v6RIz2eA9Juj
7VPIpe/drRfL0Hh+PZ0ryOH9uo9nmxng1xUvuh/t31/9jwc93jLAPVfbTAXZ
ZYCw9dNHBjQksUz1kbUGV+wHFhlQO9sTTkIuHvSIsNjIBKXzlIZbyHuH+io6
tzGh8WF9JQd5YahM8D95JghTPYbakAs+XK8uN2NCGNli/Ul0PnePvP/0z1Um
nBjLJZghh4zoby+6zgS5K4+Wicj2H2Wu3Q9iQvRlnrHitfM+NrAr+hETKCQV
yhGUD4zP50nugiygc8guJihvjla3SxD2sODgRBPFB3k06nLzWykWNJ1ckc9A
PnvcRuasKgtOWfFem0QWDvHslXVigf4qj30kyjuOVLja6FMWPBo0HvuK8tL4
p+Dn1AYWcFtZvftQvvI2xcSZtLLA9Fau83lkN2LKdP0o8gauaTGyYl1e5l2h
QOjd1UymeKK8sX21wc45EGR3zN2WRfl+86hhqejNQJg6lCJph7x/Y5t1i18g
fJ2d1k9CDinqLdOIDgQdmYCrAqheXFgedxWvCoQGtvX9JeTBZL7mPuEg+LrI
ll5A9Wa1SzvOtDoI1o117bmC6lmZlOyJnpdB0FNVl3AP2ZO4pd+8PQjqEjzT
ppDfCbVJWY0HAY94pxYL1cNyA5vHDsLBkK1cM/YY1UuvZ5QOL6dgWJf3l60i
qreDBYXCtwRCoH2AMBfOQPVoMerJ1l0hIJ4x+n0M2VCfZBFBCAFD1U5ci4ny
ZlyVE3UsBLY2/J5bQE4gNB5JsA+BvrDOXvdANJ/EDxfuPwmBhAXvVZcQdL5Z
opE11qHAd0Mkthr1F0upUzuk3UIhVYDRfxj1IyfK6tPYpFBgWVaV3EV++Mmr
0JwdCsECiXNht1HeGjY2fasIhQL1C4M20RiwRX22ym4Pg+svUxck4zAwy+8L
vf06DOSzmRZbUD80057GsjvGBrENXfcNi9DzqA0LX3+KDWXneIO7kOfy8bjs
c2xYpVu+skb92Xyg4YNJezZIu8riXqh/W1RZfk0JZ4OxXZh5wkOU/ylW26KH
2XAxSGHzrzIM9l0V4zxjh0NftNo0D+oXz80l1hCGIqC3e054dwfa7090f4jX
RYG9d9DmmD8YhEkpq4qr3oFAVtyy/GEiZL958vEzOwaE7R0/dtgSwf/VbQHj
37Hg66eVI5dAhPG/pSzOGcXD/ibif/FNRNg6LLz/Q10CuNJfRIxvJEHr/HRv
mUISlLZNWkhrk+AAMbhUjJkMPws9Wev8SKCuRd4k/i0FfFP1DiyVk2CUTGAW
nU2D8vITj/fMkkBBsHqcmpwON1LcD0vL43BkoeS/Lxszgfxjp9OQEw6OUiWf
vytwoG6Mx9YxHYfSdnGlaUUOyG48pGuXgd4n6GzquBIHQq1/ylll4pDU7yzS
p8qBXZKWw8Z3UR8XL65eq8uBVe26vdrZOJzczI4Ks+GALSOqUqIIB+Fpp2P7
IjnAK7TLvbcaB9vUDoZoNPLxp5UdNTgU6Gs1CcVyoBEcNrXU4qD3YK/9+mQO
lH8rvdPwDAd/u45bn7I44L+rw/1hAw7j7TDwsJoDBiWjMuxmHJQZRXIFXA7U
S1TLBL/BgXl4LzGrngPar4wlGS04iIcvbEx8xYGppiV9chsOl04XKQZ0cSA6
/ivNoQuHjDkxf+9eDpySljWx7sZhihP2wusdB3wNjNTMe3AIWXG0dBjmQMx9
vmbDtzh0FbRnWX7kQEGLesSZPhwIljBjMs4BpR3rzmij9zWvzUWq5yc4EGhw
YVn9PQ7V5WJBelMc6LSQLDzej8P/AMel2iA=
            "]]},
          Annotation[#, "Charting`Private`Tag$93077#1"]& ], 
         TagBox[
          {RGBColor[0, 1, 0], AbsoluteThickness[1.6], Opacity[1.], 
           LineBox[CompressedData["
1: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
FBL6riqVkeD//x8Ag43VGmPI/wee7NmA
            "]]},
          Annotation[#, "Charting`Private`Tag$93077#2"]& ], 
         TagBox[
          {RGBColor[0, 0, 1], AbsoluteThickness[1.6], Opacity[1.], 
           LineBox[CompressedData["
1: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
Tg==
            "]]},
          Annotation[#, "Charting`Private`Tag$93077#3"]& ], {}}, {}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{None, None},
       AxesOrigin->{0, 0.004245956049958695},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImagePadding->All,
       Method->{
        "DefaultBoundaryStyle" -> Automatic, 
         "DefaultGraphicsInteraction" -> {
          "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
           "Effects" -> {
            "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2},
              "Droplines" -> {
              "freeformCursorMode" -> True, 
               "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
         "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> 
         None, "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& ), "CopiedValueFunction" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& )}},
       PlotLabel->FormBox["\"NormalHeston: imp. vol.\"", TraditionalForm],
       PlotRange->{{-0.03305264, 0.03305264}, {0.004245956049958695, 
        0.0059725973840056975`}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {
          Scaled[0.05], 
          Scaled[0.05]}},
       Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
       {GrayLevel[0], 
        RectangleBox[{1.05, -0.05}, {1.780434782608696, 0.7500000000000001}]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
        GraphicsGroupBox[{
          RectangleBox[{1, 0.}, {1.7304347826086959, 0.8000000000000002}], 
          InsetBox[
           GraphicsBox[{{{InsetBox[
                GraphicsBox[
                 {RGBColor[0, 0, 1], 
                  LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"T=30\"\>", {1.2100000000000002, 0.58}, 
                ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
               InsetBox[
                GraphicsBox[
                 {RGBColor[0, 1, 0], 
                  LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"T=10\"\>", {1.2100000000000002, 1.74}, 
                ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
               InsetBox[
                GraphicsBox[
                 {RGBColor[1, 0, 0], 
                  LineBox[{{0, 0}, {1, 0}}]}], {0.08, 2.4}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"T=3\"\>", {1.2100000000000002, 2.9}, 
                ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
            AspectRatio->1.0952380952380953`,
            FormatType->TraditionalForm,
            
            PlotRange->{{-0.1, 3.26}, {-0.1, 
             3.5799999999999996`}}], {1, 0.}, {
           Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->{607., Automatic},
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.4380836694870825`*^9, 3.4380837070808325`*^9, 
  3.4380842289870825`*^9, 3.4380859635563183`*^9, 3.9623566475482454`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"b3943c73-5453-4042-84a2-506f7fcf583e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
       RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
       RowBox[{"F1", "=", "0.0418`"}], ",", 
       RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
       RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
       RowBox[{"\[Rho]1", "=", 
        RowBox[{"-", "0.1819`"}]}], ",", 
       RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
       RowBox[{"F2", "=", "0.0363`"}], ",", 
       RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
       RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{"-", "0.1136`"}]}], ",", 
       RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
       RowBox[{"T", "=", "10"}], ",", 
       RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
       RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
       RowBox[{"\[Rho]c12", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"legendrelst", "=", 
        RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<money=\>\"", ",", 
        RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F1", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"F2", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
             "\[Nu]2", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", 
      RowBox[{"strikevalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"\[Rho]c12x1", "=", 
       RowBox[{"-", "0.3`"}]}], ";", 
      RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ";", 
      RowBox[{"\[Rho]c21x2", "=", 
       RowBox[{"-", "0.3`"}]}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}]}]}], "]"}], ";"}], "]"}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"72de2c13-5933-42c8-a709-5860cab4ef04"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.9623566476567683`*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"690733f4-8d26-4408-aa1d-b55ef25c1a3f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9623566476597595`*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"2f92085d-25e9-489f-8493-35b8d33a625a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9623566479938397`*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"d95cd74c-17e9-45e4-8a28-c05dfb0552da"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.962356648446663*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"cc1762fc-6381-4048-b25f-0980dc416db1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.234375`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.962356650308922*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"14d9f36b-3bf5-4036-835a-3235a0b540fe"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestExecution", "[", "T_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
       RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
       RowBox[{"F1", "=", "0.0418`"}], ",", 
       RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
       RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
       RowBox[{"\[Rho]1", "=", 
        RowBox[{"-", "0.1819`"}]}], ",", 
       RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
       RowBox[{"F2", "=", "0.0363`"}], ",", 
       RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
       RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{"-", "0.1136`"}]}], ",", 
       RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
       RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
       RowBox[{"\[Rho]v", "=", "0.5`"}], ",", "callvalues", ",", 
       "implicitNormalvols", ",", "strikevalues", ",", "k", ",", 
       "implicitcorrelations", ",", "implicitcorrelations2", ",", 
       "implicitcorrelations3", ",", 
       RowBox[{"\[Rho]c12", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c12x1", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ",", 
       RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ",", 
       RowBox[{"\[Rho]c21x2", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"legendrelst", "=", 
        RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<money=\>\"", ",", 
        RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F1", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"F2", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
             "\[Nu]2", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", 
      RowBox[{"strikevalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", 
           ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", 
           "legendrelst", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", 
           "legendrelst", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<BiSabr:Implicit Normal Correlation T=\>\"", "<>", 
          RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<BiSabrHeston:Implicit Normal Correlation T=\>\"", "<>", 
          RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.438085992778808*^9, 3.43808599361532*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"2e527f97-2254-419f-a482-fa41d6660d51"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "2", "]"}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"ef14f015-6312-47ab-892c-4e3d374adc93"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.9623566911229506`*^9},
 CellLabel->
  "During evaluation of \
In[80]:=",ExpressionUUID->"d40c1ec7-d665-4b8b-87bb-e71a2b7ef7e9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233637`", ",", "1.17947378335905`", ",", 
     "0.5621491608076284`", ",", "0.13553828959968103`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233637, 1.17947378335905, 
   0.5621491608076284, 0.13553828959968103`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.962356691125943*^9},
 CellLabel->
  "During evaluation of \
In[80]:=",ExpressionUUID->"01c73546-9dc3-4453-8bfa-c89f917f5435"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781151`", ",", "1.529398307100142`", ",", 
     "0.49188807768772164`", ",", "0.06921597823402129`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781151`, 1.529398307100142, 
   0.49188807768772164`, 0.06921597823402129}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9623566911319523`*^9},
 CellLabel->
  "During evaluation of \
In[80]:=",ExpressionUUID->"9676edd8-c29e-499c-a684-21fec53d2eba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659784`", ",", "1.508111922312278`", ",", 
     "0.47060169289985854`", ",", "0.0905023630218845`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659784`, 1.508111922312278, 
   0.47060169289985854`, 0.0905023630218845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9623566911339264`*^9},
 CellLabel->
  "During evaluation of \
In[80]:=",ExpressionUUID->"a18b444a-5a4a-4385-ac3f-8f277365bf00"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {{}, {}, 
       {RGBColor[1, 0., 0], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9XLf/ra2temp/+2dd1p6SyfvrnmZX
3lr91N7mvn/v9LxJ+x+8s29WvvvUfs4RhQ1FGRP3T9fY9yCY75n9n5UfL/km
Tdjft2ryplT7Z/Y75FpfB+7o22+oO9UoqOCZfeVLNUOONT37s2t+5gkufGZv
teVE2b75Xfu5Dy1im3Xxmf0vsHUd+xkFX3x4wPjcfpcnD5N2e9t+8ftySjcN
n9tD3NeyX5/3rUxx4nOoe5r2n+HLKpsz4TnU/ob94QURhvb7n9tXgO2r2Z/C
M/e7w9vnUPMr9q/YkqfTJPXCvgZsXsn+iWd+nb7j9gKqv2B/6+eN3MpFL+x/
gNVn7Gdhf39Vdg6QD5ZP2P8waopA95EX9gyrQPyA/a13fZ9JvwbyoeBzQm9O
Mf9LmLz9w+tv+dQMX8L029tEn9+yy/8lzHx7nrLWaeuyXsLst5+ZG7q7pvEl
zH32v59uil85GSgPcb/9ig1yghcWvIT5z34T14rGjStg+hvst22IYLNd/RIW
PvatcUKdk4DyVZDws7/8Vyz6D1A/NHztT8p1uD+e8hIW/vbSEtJHDrS8hMWP
fXbn6iVChUD9kPizV6jaKRcUBdQPiV/7wtPn4t85vLT/C4l/+//1eYJeqi/t
Z0PSh/3H7mW3drG/tLeGpB97RvPbPF0vXsDSl71gscqzr8dfQON3iv376a1v
jZa9sAcAupBW+A==
         "]]}, 
       {RGBColor[0., 1, 0.], PointSize[0.009166666666666668], Thickness[0.01],
         LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT99tu1+w4pP7K//bMua0/J5P3nE8yt
rXIe2dvc9++dnjdpv2zef7UXWx7ZzzmisKEoY+L+6Rt1l5z9+8j+z8qPl3yT
Jux/mx516bXbY/sdcq2vA3f07W8TWf/LecJj+8qXaoYca3r2b94u5nX95mN7
qy0nyvbN79rvnd4bs0z5if0vsHUd+80E70Rtyn1iv8uTh0m7vW3/+a0X9/ze
/sQe4r6W/YGVCvuamJ5C3dMEdM8vfXffp1D7G/ZPDv3k5zHjqX0F2L6a/W8b
lCe0PH4KNb9if1WhWvxPvWf2NWDzSva3BFw+sKjqGVR/wX65zVduVh17Zv8D
rD5j/xr7fI9Koef2P8DyCftvtDWYTIp7bs+wCsQP2H/Ze4bI1lVAPhQcXbbk
xalvcHn7JSl3jm52egHTb//h8v9M574XMPPtr6+80mlz8wXMfnsBlqKpXsov
Ye6zfzBz0cef2S/t/0Dcby9WJpuzftNLmP/sP3D+NVz47SXM//bCehaPrpq9
goWPfdSlc6EGRa/sqyDhZ69kXTepd/krWPja6yc5f/909RUs/O2LFz3r2Pfn
FSx+7CebGEUekX5tXwWJP3uGTY0/vY1f2++CxK997LkJtz45v7b/C4l/+5U3
HvW2+L22nw1JH/abJAJsbwS/treGpB/75+3ff+8MeQ1LX/ai4W+K7ge+hsbv
FPtvfcz1T7xf2wMAT8penw==
         "]]}, 
       {RGBColor[0, 0, 1], PointSize[0.009166666666666668], Thickness[0.01], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9Gj/2e3xof2l/+2dd1p6Syftji3j3
71z40t7mvn/v9LxJ+ze+XcTEs/ul/ZwjChuKMibub/ql8fXa5Zf2f1Z+vOSb
NGF/dmBvAMubl/Y75FpfB+7o2//zsenVOuZX9pUv1Qw51vTslww32qcp9cre
asuJsn3zu/aLHxaqe6L/yv4X2LqO/XcvHg3vcHllv8uTh0m7vW3/7p0M75+F
v7KHuK9lf3jvm1UnMl9B3dO0/0hdt+LryldQ+xv2P5ZuP/iv/ZV9Bdi+mv2h
onxTlkyGmV+xf8vFTeY5c17Z14DNK9n/Z/N5m0sLYfoL9p/saZZzXPzK/gdY
fcb+jNruJ8ILgHywfMJ+7eAPegumv7JnWAXiB+yX0WXZ5doJ5EPBocS7Fq0l
cHn7kG2i6yUj4frtc175yPKYw823D93JW7SDD26//ffc9+wHHryEuc/+9tsH
S96tBYYvxP322U8fZMiUv4T5z57bV+ShqC0s/Bvs5a4fEutjgMVXkz2nsupc
yUMv7Ksg4WfPc3BJm37TC1j42i+eLmSt6/gCFv72xdMylKL/P4fFj/2ZeTkC
H/c8t6+CxJ/9B7lbLFJVz+13QeLXft3yl6rfzZ7b/4XEv33ugnDhRZ+f2c+G
pA/7OwuPrdTb8MzeGpJ+7G143MLX5DyDpS97+WYVBXXNZ9D4nWJfo5actOLp
U3sA2ddUAQ==
         "]]}}, {{}, {}}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->{True, True},
     AxesLabel->{None, None},
     AxesOrigin->{0, 0.5509081566993579},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     Frame->{{False, False}, {False, False}},
     FrameLabel->{{None, None}, {None, None}},
     FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
     GridLines->{None, None},
     GridLinesStyle->Directive[
       GrayLevel[0.5, 0.4]],
     Method->{
      "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}},
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=2\"", TraditionalForm],
     PlotRange->{{-0.02, 0.02}, {0.5509081566993579, 0.8540925904492241}},
     PlotRangeClipping->True,
     PlotRangePadding->{{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}},
     Ticks->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 0.58},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}, {
             InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", {1.2100000000000002, 2.9},
               ImageScaled[{0, Rational[1, 2]}], Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->{587., Automatic},
  PlotRange->All]], "Output",
 CellChangeTimes->{3.962356696955618*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"e4d6b783-eaf7-4877-b6dc-b39c6def6047"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "2", "]"}]], "Input",
 CellChangeTimes->{
  3.438086002168825*^9},ExpressionUUID->"42f27e69-b3c6-4534-a73d-\
8ff9eef2bfc4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842754402075`*^9},ExpressionUUID->"0f8259e3-2ed2-4059-9421-\
5fd9fdfbea15"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842754402075`*^9},ExpressionUUID->"6c5321d5-82ef-488c-9175-\
471a175ed480"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842754402075`*^9},ExpressionUUID->"5d7ee2e3-84f5-4507-aaf5-\
31e0559b1b34"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842754558325`*^9},ExpressionUUID->"4b127790-d225-40ec-85a1-\
e925617e21e4"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT98278W1tb9dT+9s+6rD0lk/eLPcuu
vLX6qb3Nff/e6XmT9k9/ad+sfPep/ZwjChuKMibuL9PZ9yCY75n9n5UfL/km
TdhvvnryplT7Z/Y75FpfB+7o29+iM9UoqOCZfeVLNUOONT37o+p+5gkufGZv
teVE2b75Xfs5Di1im3Xxmf0vsHUd+38IvPjwgPG5/S5PHibt9rb9+ffklG4a
PreHuK9lfwDvW5nixOdQ9zTtr+LLKpsz4TnU/ob9xQURhvb7n0Ptq9mfyTP3
u8Pb51DzK/av2pKn0yT1Ampeyf7pZ36dvuP2Aqq/YH/F543cykUvoOoz9nOx
v78qOwcmn7D/ftQUge4jMH7A/va7vs+kX7+wZ4CCzwm9OcX8L2Hy9o+vv+VT
M4TxE+zto89v2eX/Ema+PX9Z67R1WTD5AvtZuaG7axpfwtxn/+vppviVk2Hq
K+zXbZATvLDgJcx/9lu5VjRuXAHT32C/bUMEm+3ql7DwsW+PE+qctAJmXov9
tb9i0X+A+qHha39GrsP98RSY+R32ShLSRw60vITFj31B5+olQoUw+3rstap2
ygVFvYTFr33x6XPx7xxg9k+w52/IE/RSfQlLH/Yfu5fd2sUOc88keybz2zxd
L17A0pe9arHKs6/HYfExxf739Na3Rste2AMA+qBZQQ==
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9Z/Zo9x1SfmR/+2dd1p6SyfsTY82t
rXIe2dvc9++dnjdp/8vs/2ovtjyyn3NEYUNRxsT9MzbqLjn795H9n5UfL/km
Tdj/Lj3q0mu3x/Y75FpfB+7o2y8nsv6X84TH9pUv1Qw51vTsv7FdzOv6zcf2
VltOlO2b37W/Jb03ZpnyE/tfYOs69s8VvBO1KfeJ/S5PHibt9rb9E7de3PN7
+xN7iPta9ttVKuxrYnoKdU/Tfqe8X/ruvk+h9jfszwv95Ocx4ynUvpr9NxuU
J7Q8fgo1v2J/SaFa/E+9Z1DzSvYnBVw+sKjqGVR/wX6ZzVduVh17BlWfsX+B
fb5HpdBzqHzC/sttDSaT4mD8gP2nvWeIbF313J4BCi4uW/Li1De4vP3alDtH
Nzu9gOm3f3X5f6Zz3wuY+faPV17ptLkJky+wF2Ipmuql/BLmPvtnMxd9/Jn9
EuZ+e5ky2Zz1m17C/Gf/nvOv4cJvL2H+t5fVs3h01ewVLHzsky+dCzUoegUL
P3t567pJvctfwcLX3jjJ+funq69g4W9fsOhZx74/r2DxYz/FxCjyiPRrWPzZ
c29q/Olt/BoWv/ZF5ybc+uT8Ghb/9ltvPOpt8XsNSx/2ayUCbG8Ev4alH3vh
ju+/d4a8hqUv+x9hb4ruB76Gum+KfXkfc/0T79f2APi5YTA=
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9YuwHPD60v7S//bMua0/J5P3xzbz7
dy58aW9z3793et6k/bFKi5h4dr+0n3NEYUNRxsT9Hi6aX69dfmn/Z+XHS75J
E/bzJ/QGsLx5ab9DrvV14I6+/Y/fmF6tY35lX/lSzZBjTc/+U3FG+zSlXtlb
bTlRtm9+1/4pR4Tqnui/sv8Ftq5jf/OFo+EdLq/sd3nyMGm3t+2X28bw/ln4
K3uI+1r22/e8WXUi8xXUPU37L9d3K76ufAW1v2G/hUz7wX/tMPtq9veI8k1Z
MhlmfsX++oubzHPmwMwr2f9783mbSwth+gv2n+pplnNcDFOfsb+stvuJ8AKY
fMJ+3eAPegumw/gB+410WXa5dr6yZ4CCQ4l3LVpL4PL2UdtE10tGwvXbF73y
keUxh5tvH7uTt2gHH9x++7+579kPPHgJc5/9o7cPlrxb+xLmfvvipw8yZMpf
wvxnL+Qr8lDUFhb+Dfby1w+J9THA4qvJXkFZda7koRew8LMXOrikTb/pBSx8
7edPF7LWdXwBC3/7/GkZStH/n8Pix/7mvByBj3uew+LP/pPcLRapquew+LU/
sPyl6nez57D4t89dEC686PMzWPqw/7jw2Eq9Dc9g6cc+jMctfE3OM1j6sg9o
VlFQ13wGdd8U+2VqyUkrnj61BwBnrlNK
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=2\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", \
{1.2100000000000002, 1.74}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->{551., Automatic},
  PlotRange->All]], "Output",
 CellChangeTimes->{
  3.4380842889558325`*^9},ExpressionUUID->"f320c67c-719f-4775-9cba-\
83bed0ce6ee4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "10", "]"}]], "Input",
 CellChangeTimes->{
  3.43808600846496*^9},ExpressionUUID->"eb4b7008-23ae-47a2-8e18-db904c37509f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842891902075`*^9},ExpressionUUID->"0b4a1f2b-5dfd-44b2-903e-\
aafec5b4df99"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842892839575`*^9},ExpressionUUID->"79d8125f-d938-4ed1-9174-\
b98104a124a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842893620825`*^9},ExpressionUUID->"482f38cf-f105-4f8b-b976-\
40d93efbae73"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842894402075`*^9},ExpressionUUID->"111d1d2d-9c37-41f1-ac84-\
22a1ce468141"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9660lJnqWPLe//bMua0/J5P0eC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdivbdnRLv/6uf0OudbXgTv69jPG8f/+xv7CvvKlmiHHmp79Zgf5JFJUXthb
bTlRtm9+135JmfkbYhxe2P8CW9ex/274qQ1Xo1/Y7/LkYdJub9s/a/EiwcNl
L+wh7mvZz3nW7pz4xBdQ9zTt/5104NbRVS+g9jfsvxBzTn7fYZh9Nft/8Cyu
+nAbZn7F/itndx/2/gwzr2R/y7Sjd/dyvoTqL9j//XnvOWP5l1D1GfufXt72
eKYxTD5hf1PmnSe33WD8gP3+gR4hTyNe2jNAwVW+1/sWZsLl7eXSXkr9rYDr
t7+Qbm/8pA1uvr3NLyFZ18lw++0lVkpu4p/3EuY++3NbpnCaLYepr7C3PfLy
xZp1L2H+s5+357pyzhaY/gb7EsfYp3k7XsLCxz5J0+H25l0w81rsr9y56mC7
+yUsfO2Ps348LrALZn6HfbapVpL59pew+LHnn3Hl3Z5NMPt67BW2al1Zv+Yl
LH7tZ/O+71ZYCrN/gn3H3jANxTkvYenDnu/X3ztHJsLcM8l+warVPfJA/0PT
l/1FNrFk10qY+6bYsyno13hlv7QHAF5kXOw=
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9fU8bhHykntrf/lmXtadk8v67mw79
SPB8am9z3793et6k/Vtn75YqrHhqP+eIwoaijIn7d17lyata/tT+z8qPl3yT
JuyXqH6ztOraU/sdcq2vA3f07U9w4tbOZ31mX/lSzZBjTc9+9bXFQqEmz+yt
tpwo2ze/a7/iQn1hzeRn9r/A1nXsz3i1q+r5xGf2uzx5mLTb2/bXXcxX6Dnw
zB7ivpb9euGXw4TeP4O6p2l/2+4nt0tkn0Ptb9i/54DP8bXez6H21ew3vXe8
bFvlc6j5Ffvby1ZXtC9/DjWvZL/grsASiasw/QX7VXZNFEhgegFVn7E/favd
jWD9F1D5hP23V7PJvoiG8QP2S4S9vcHf8cKeAQrCn9r179kMl7ff8/aG7r17
cP32RSukPyRxvoSZb9/5dIWrufFLmP32B1eF73eNeQlzn33G7mOs5S0w9RX2
4f2H7m5c/RLmP/v7PyTtb1+E6W+wP3VoVvO1by9h4WP/+eusza1Sr2DhZ19z
K/zrSZtXsPC1N31UptQS+woW/vblufNapta8gsWP/ezKrq0PZr6CxZ/9rT1P
Z3ptfQWLX/uWyMCM3edeweLfPmh+8Qr5Z69g6cN+5xdR4czfr2Dpx/5f0X3r
fr7XsPRlXzvr2cd++ddQ902xn7h9tXe+3mt7AGu4Xow=
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9+nVhEjObX9nf/lmXtadk8v43MrpL
DXpe2dvc9++dnjdpfw+v8YMXk1/ZzzmisKEoY+L+rGwFvnWzXtn/Wfnxkm/S
hP0qEfGG2Qte2e+Qa30duKNv/8WjLgpcS1/ZV75UM+RY07P/9tRLW4pXvLK3
2nKibN/8rv0ZOz7zTlj1yv4X2LqO/U79l5+5rX5lv8uTh0m7vW1/qV4CRwNQ
HuK+lv1ipkkXlVfA3NO0X0Uj7or0Epj9DfuzHn9uCZ4Hs69m//9I6Tc7psHM
r9hvMXFTuG0vzLyS/XprWX9cbYTpL9j/JXlybE0JTH3G/gwppdN6qTD5hP2Z
k9cFfwiG8QP2h5/iOHjC4ZU9AxScnZrtekQbLm+fyXTv/ycRuH57bdOLcRl/
XsLMt095fSzP6tFLmP329q0NSo3HXsLcZz+J9+OC0JUw9RX2PL1iiy52vYT5
zz5SSfAhXzZMf4N98vmyZWpeL2HhY9/QvTfbUANmXot9jojVNDfWl7Dwtber
bnKvefgCFv72etce2z/f8wIWP/bzvq04P2v6C1j82X//m3FlReELWPzae3Qc
3qfo/QIW//Y1++7NE1F5AUsf9jWvrUz7/zyHpR97r3R3tnlXnsPSl/2hkxPz
fdY8h7pviv3NW1V7lzQ/twcAS4tXnQ==
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=10\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
               {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->{540., Automatic},
  PlotRange->All]], "Output",
 CellChangeTimes->{
  3.4380842975808325`*^9},ExpressionUUID->"d674143d-4b0d-40cc-bc5c-\
7299cde53b38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "20", "]"}]], "Input",
 CellChangeTimes->{
  3.4380860117845993`*^9},ExpressionUUID->"2709c57c-9b53-42fd-96b5-\
dc2567bd9c52"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842977995825`*^9},ExpressionUUID->"d7d13d19-8660-4c15-8437-\
450066c7ce4d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842978933325`*^9},ExpressionUUID->"e3ee1ccf-daeb-4e61-9bb0-\
28cf6dde5d31"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842979558325`*^9},ExpressionUUID->"2cd055a1-650b-4a0a-b559-\
7e18768bcc23"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380842980339575`*^9},ExpressionUUID->"e7665d1d-6f3d-4fef-a1b3-\
1e8fab87aea3"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9JUk/bl2Z9NL+9s+6rD0lk/c7eUpa
1C58aW9z3793et6k/b/+5D59sv6l/ZwjChuKMibuL723/wDHvpf2f1Z+vOSb
NGH/XEXtrqenX9rvkGt9Hbijb79t14kn5Tdf2le+VDPkWNOz/97mReF7nr20
t9pyomzf/K79AdcE/dd/fmn/C2xdx37rrno5X4ZX9rs8eZi029v2z0xZyzSJ
55U9xH0t+0UPFahUSbyCuqdp/40ktjmMKq+g9jfs//njW4mK/iuofTX733yf
s+me5Suo+RX7LVgcQnVcYOaV7J86+148px9Mf8H+f3M77xWGw9Rn7M/4H/42
MQEmn7A//vmt/VczYPyA/W4CPCtPFryyZ4AC5cJWZasKuLz9VoEfN5Xr4frt
V09fu765FW6+fYnDpxNh3XD77bv9tCbPmgB3n73ShvIzPlPh7rd/b7GiK3sm
3H/2m0O8HL/Ogfvf/m755mMv5sPDx17K5UG46yJ4+Nlv2fBrFtcSePjaV3F3
LLBYCjO/w77goPrj80A+NH7sr+e9c724FGZfj/3Fi+GCdkA+NH7tT1zkei++
BGb/BHv1kJQnCUD7oOnDfuF6ER/pBTD3TLK/1fbsnOfcV7D0ZT+j7nv0+5kw
902x/12Tr8A/7ZU9AFsdXzk=
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9tS8/NL1XemF/+2dd1p6SyfsTsxzX
PLJ5YW9z3793et6k/fuXH5h+IOyF/ZwjChuKMibu/8dT9bK94IX9n5UfL/km
Tdg/tzfGwLzrhf0OudbXgTv69h/tZH96ZvEL+8qXaoYca3r2fy/MyHDf+8Le
asuJsn3zu/ZnfgxhWnrthf0vsHUd+9W+Czx4/P6F/S5PHibt9rb9xieOCjFx
vrSHuK9lP3fni96/ii+h7mnab3RnsuoVq5dQ+xv2P753q6c5+CXUvpr9by0Z
QjhzXkLNr9h/5tWRZ0ktMPNK9lvOmdHVOwemv2C/Wc2LmLYtMPUZ+9mOpwZ6
nYHJJ+wPcMk2uPYYxg/YP+FS21S13y/tGaCg0EL+nbnQK5i8/bddGRVsmjB+
gn32nGlOffavYObbd3IUa50OhckX2C8XL7m7I/sVzH32J0LCbwY1wtRX2N/p
yM2dMu0VzH/2MZHb91SshulvsM/Wu3vg1/5XsPCxv/jfyk/0Csy8FvtHGQKS
h5+/goWvfd+i17v//YKZ32E/qal6/yHe17D4se81ObSYU+E1LP7sRXy3vjpr
+BoWv/a8FZEqXM6vYfFvv+CRzJ8dwa9h6cN+n2Kq+9Xk17D0Yx/fry4aVfwa
lr7sKze92+vU9Brqvin2/aXxX7omvLYHAEQIXNI=
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9wirqog21r+1v/6zL2lMyef/2IsNl
qdWv7W3u+/dOz5u0v+aK+ZOdFa/t5xxR2FCUMXH/IvY8k8rS1/Z/Vn685Js0
YX9lfo/fgsLX9jvkWl8H7ujbf2wfq4dO7mv7ypdqhhxrevZrn2+aJ5Xx2t5q
y4myffO79vOX2jpmJr22/wW2rmN/SILATLGY1/a7PHmYtNvb9hstPdWnGPra
HuK+lv27FVb1d/rC3NO0X33hjX4/V5j9Dfvnv1jDVWgDs69m/zXV+wyfjGDm
V+w30lr85ZIGzLyS/a+/X34sKgfTX7Bf80W8w14hmPqM/dcaAp+fZoPJJ+y/
VzpdzPXXKyg/YP8kU4Yknbev7BmgYBPT+uWt9+Hy9tGMQSyhF2H8BHv3DenH
5x16BTPfvkL3Xnr6Zph8gT3bA43KzYtfwdxnX39BYGH7ZJj6Cvv1IcF9L5pe
wfxnX/Od78OtQpj+Bvvv28LzkhNewcLHvuR+0eI2P5h5LfYzJlqKedq8goWv
fa+xl+l6TZj5Hfbma0SD94q9gsWPvXv2lkXlzDD7euyfehSaPnr/Eha/9vdT
vv9guPMSFv/2uRIC264ffwlLH/bHuu/xZ21+CUs/9odz2pt3z3sJS1/2m/lN
M853voS6b4r9tqcp71eUvLQHALidVEo=
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=20\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002, 1.74},
               {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->{613., Automatic},
  PlotRange->All]], "Output",
 CellChangeTimes->{
  3.4380843041589575`*^9},ExpressionUUID->"43b60bc6-32f2-44bf-87b1-\
29e98f86d199"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "30", "]"}]], "Input",
 CellChangeTimes->{
  3.438086015968822*^9},ExpressionUUID->"d60c532b-0412-43e7-a9d6-\
200adb6bd69a"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843044245825`*^9},ExpressionUUID->"c2fd8977-2131-4531-957d-\
3bf7215fc3f5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843044245825`*^9},ExpressionUUID->"ed854091-f06a-474f-9975-\
d2ebdb042562"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843044245825`*^9},ExpressionUUID->"0418706b-c61d-45ca-b63d-\
113a075c3afa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843044245825`*^9},ExpressionUUID->"f1f2a62e-8cc8-4833-9432-\
9b1bd80871d4"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9n39Iuvzd/9r+9s+6rD0lk/e/D782
fdGx1/Y29/17p+dN2r/po8EP1bOv7eccUdhQlDFx/7Kd05PaLr+2/7Py4yXf
pAn7LxhYXDx087X9DrnW14E7+vazlVRa37r/2r7ypZohx5qe/Ss1Oqadfvra
3mrLibJ987v2t/z/cHXq69f2v8DWdezfxej9xvzja/tdnjxM2u1t+w99fHd6
w7fX9hD3tew/pXIk/f9vmHua9geGi2xRYnwDtb9h/xrjkuWSbG+g9tXsr5be
bv2Y6w3U/Ir9i1g/5NXxv4GaV7J/gnetyythmP6C/f3/5Y+pSsDUZ+x/9UqU
1UAGJp+w/0SsvTSHAowfsP/cYSedtcpv7Bmg4DjDpjQ5dbi8vWWUDmu0Fly/
vcmTSv8kXbj59s+2z55tbAC33/7a3Ut+54zg7rM3vzfhnqEp3P32krURF2PN
4f6zl6po3R9oCfe//bOgX8G81m9g4WNvzbrRZ4INzLwW+6lqetW3bN/Awtd+
oc35I6/tYOZ32O9x/qN0xP4NLH7sLzMbLU52gNnXYz/B43XaKSAfGr/20w6k
Lf7hALN/gv2tLO+F74B8aPqwn8+jvWeNA8w9k+wtxF4lGgP50PRlr+3IJtRs
D3PfFHv5bcdj5gDdAwBdXVVr
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9tQvfXrj645X97Z91WXtKJu8/MMvp
KSfba3ub+/690/Mm7U/2etphIPzafs4RhQ1FGRP3G5+aZ+Kp8Nr+z8qPl3yT
Juxf+GtfdLDua/sdcq2vA3f07deof5vtZ/XavvKlmiHHmp79DddfnrF0f21v
teVE2b75XfudD0U+EAl5bf8LbF3HfoaOPsb7Ca/td3nyMGm3t+2P1fJpnZ77
2h7ivpb9OXcn7rStgrmnaf/tmwlPL7TB7G/Yf8qtwSNgMsy+mv161cHSu+fD
zK/Y775mRp/AGph5Jfu/admd9t8B01+wn1/R+FP5EZj6jP3XdtvKdFyAySfs
7/11LbL+DowfsH/NKp7NMS9e2zNAwZYDWeryX+Dy9saqH9Ye/Q/Xb79Xhd3U
n/sNzHx726Api3aJvYHZb7/3JOcVNqU3MPfZ6wj1zzPShamvsM/XtzxvY/EG
5j/7ef9CtFWcYfob7D/OOF3w3PcNLHzsVfmmhbVGwMxrsfebEdz7J+kNLHzt
H03/ut87F2Z+h330s64pheVvYPFj/+OF5tqcRph9PfYrp/1aYd39Bha/9uJs
Sap3p8Dsn2A/IyRgv/+8N7D0YX/m1CqRScth7plkb6b/+OiiDW9g6cte/NyC
8oadMPdNsbc63nNF89AbewChbFiK
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT90QKzvwmefWN/+2dd1p6SyfvfsH43
3HDyjb3Nff/e6XmT9hc3HJoudOyN/ZwjChuKMibu33z4+m+LQ2/s/6z8eMk3
acJ+02c7vJT3vbHfIdf6OnBH3/55YVs7L+58Y1/5Us2QY03P/u8Od645b31j
b7XlRNm++V37F8jvyaja8Mb+F9i6jv0mOz70lq5+Y7/Lk4dJu71t//R1jWtM
l72xh7ivZf/s1SKOuxfA3NO0v3zrt7tss2H2N+z/6cOkJTkVZl/N/memyfc/
9cHMr9hf8cX51JQOmHkl+02Tko//b4TpL9gvzzfnkEk1TH3G/p8hiVtNSmDy
CftL7c2XMuTC+AH73dR1Fs1MfWPPAAXXVYKOMsTB5e2zOdz1zcPg+u17Fx1m
s/ODm29vcsS6XMwNbr+9m1T/+oO2cPfZx6w498DBFO5++w3LhW2n6sD9Z887
p+DbfmW4/+0jQ7/aHpKCh4+99cFTTnMF4eFn/+VyimEQBzx87ZeonTJ69O81
LPztvW98zPb7+hoWP/a7lYz/Tn/9GhZ/9u/OnWY88PA1LH7tGyzK+o9ffw2L
f/ugdMFt68++hqUP+5b6iPrKw69h6ce+I2LVO9Wdr2Hpy97O/xbDtnWvoe6b
Yv+yT2iN1pLX9gDMU1r3
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=30\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", \
{1.2100000000000002, 1.74}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->{575., Automatic},
  PlotRange->All]], "Output",
 CellChangeTimes->{
  3.4380843101120825`*^9},ExpressionUUID->"a794aec9-90d4-4af7-a697-\
6cf9237789b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "40", "]"}]], "Input",
 CellChangeTimes->{
  3.438086021488695*^9},ExpressionUUID->"c9adb17b-b67d-4838-9a98-\
6261cdce2bfd"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843151902075`*^9},ExpressionUUID->"ff4a9c62-5023-4153-8c0d-\
2f6efbf308e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843151902075`*^9},ExpressionUUID->"807e2f06-34fe-4871-afbb-\
4f2e9ca76c2d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843151902075`*^9},ExpressionUUID->"5a704d1a-dcb8-4e27-8a77-\
06110ac8eaa4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.4380843151902075`*^9},ExpressionUUID->"cdf47e0d-54a3-489e-9a77-\
3a462044a495"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT913dMr9LweGd/+2dd1p6Syfsbnz5e
VOD1zt7mvn/v9LxJ+6tW/T6xxued/ZwjChuKMibuN9ptte6O3zv7Pys/XvJN
mrD/r9FPYYbAd/Y75FpfB+7o21/0bPluseB39pUv1Qw51vTsv+nwPk0h9J29
1ZYTZfvmd+2vO3b2ukz4O/tfYOs69vcH7rrAHfnOfpcnD5N2e9v+U9nHRN5G
vbOHuK9lf2HS4fQDMTD3NO1fUpHW1xoHs79hf7J9gZ9NAsy+mv0aklfyniTC
zK/Yf/v3/e21yTDzSvb/SEr7zJ4K01+wX+reszdNaTD1GfurH20vfJcOk0/Y
H5ChH+iVCeMH7J9/5UzMtKx39gxQELQpIeNSNlzeXvSzsde/HLh+e5fJercl
8+Dm26+3//1NJR9uv73qUq0a+QK4++ynXwv24SyEu98+08PI51Eh3H/2m/8d
TF5VBPe/Pa9VeF1iMTx87KXebO5iL4GHn73bXKnqOSXw8LU/5RPjqlAKD3/7
J3WPH00qhcePvW3G7oAvpfD4s7+iMLnfpQwev/YeWnsXN5fB4x/oX62pG8vg
6cN+5fSU/HNl8PRjn/W4xvFWGTx92S/byCh3tQzmvin2VVdeSO0H8gEdAlq+

        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9vBy+7z1/vbW//bMua0/J5P0PL0YU
uP5/a29z3793et6k/fPcVU9bs7yzn3NEYUNRxsT9Nzn23NThfGf/Z+XHS75J
E/b7if4vkeB7Z79DrvV14I6+/Xv5Fpb8E3pnX/lSzZBjTc/+50ay6++Jv7O3
2nKibN/8rv1iazb83CHzzv4X2LqO/c85AjV6Fd/Z7/LkYdJub9vv7bWEN1rt
nT3EfS37pwSzVitpv4O6p2m//6Vkh8f6MPsb9rMKhOvMNYHZV7M/35ibJ8AS
Zn7F/o3utqt/28LMK9l/tdf8ynwnmP6C/bZqZ/xt3GHqM/Z/awp4esEbJp+w
/wXDnKjYABg/YP8ZRdaShyHv7BmgYNvxhC8xkXB5+0/mzHPPx8L123MuPaBr
mQQ33/6b7MeUmWlw++3tNMv+v8+Cu89+qu6BHTb5cPfbL7p93au+GO4/e4Gf
GXnby+H+tz/49NytJ9Xw8LH/Gqrqxt4ADz/7f58jU+Va4OFrf+qswxvNDnj4
2+/tW9ur2QOPH3vbf72/ZSbA489+UhnHc+Yp8Pi1n2M/j+HedHj827Ne8v+x
ajY8fdgr2hyrzZoPc88k+x7tBgeZxe9g6cu+5xrDh/3LYO6bYv/ZiMUmdNU7
ewDKCVI1
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9//SXNj3b9M7+9s+6rD0lk/dvmLA5
XHjjO3ub+/690/Mm7V/Rr56ut/6d/ZwjChuKMibun5i69Ij52nf2f1Z+vOSb
NGH/CoGv7fqr39nvkGt9Hbijb/8k9qdnRFe+s698qWbIsaZn/+1Sjc2vlr2z
t9pyomzf/K79LBWGceuWvLP/BbauY3/fcfavCYve2e/y5GHSbm/bf0FJZhHT
gnf2EPe17N8iIjl58lyYe5r29yZs/CE8G2Z/w/5783PYWmbA7KvZn1hf9Onx
VJj5FfvzeEO/Gk+GmVeyP7j9lmfJBJj+gv1KfMd1lvbC1Gfsl+1edudYF0w+
Yf+8q9Nn3myH8QP2n/YQX3q35Z09AxSoLDvjeLkRLm9f9i1i8646uH77swfU
7KZUw823z5K2UU+ogNtvX32Ob4tcKdx99kbrorQuFMLdb2/k9Ot8SR7cf/bf
Th18xZMN97/9x3UxB2akw8PH/k6Q7jSJFHj42UtF62/sSYCHrz2//53QrzHw
8Le3myR0IigSHj/2c9f+81oaCo8/+2/z2BTfBsLj157py/ZuLT94/Ntfr9t2
OtYLnj7s48+uU2h3g6cfezFFz5PLnODpy95ujRzzXjuY+6bYl0Rt4Dpl9c4e
AJEDWGE=
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=40\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", \
{1.2100000000000002, 1.74}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->{570., Automatic},
  PlotRange->All]], "Output",
 CellChangeTimes->{
  3.4380843202527075`*^9},ExpressionUUID->"5f00022a-0be5-4642-aedc-\
42e01ddfd7d3"]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1643, 1235},
WindowMargins->{{Automatic, 211}, {Automatic, 31}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8b99e9d2-98fa-46f0-9906-f996744e8e19"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 785, 15, 45, "Input",ExpressionUUID->"1e4a8107-9433-48f6-ab55-996258c0532d",
 InitializationCell->True],
Cell[1333, 37, 614, 13, 45, "Input",ExpressionUUID->"3440456b-ffb3-4599-9b7c-a8955091c046",
 InitializationCell->True],
Cell[1950, 52, 670, 14, 45, "Input",ExpressionUUID->"d14e797b-9239-4702-8c03-f203d506efca",
 InitializationCell->True],
Cell[2623, 68, 635, 13, 45, "Input",ExpressionUUID->"af84121c-77ce-4aac-ac7e-5ffd8f5ea89e",
 InitializationCell->True],
Cell[3261, 83, 183, 4, 45, "Input",ExpressionUUID->"6c20c985-8b1e-429d-a82c-4d0e89a02638",
 InitializationCell->True],
Cell[3447, 89, 177, 4, 45, "Input",ExpressionUUID->"e59ce4ad-b927-4d5b-a7e6-7d5269d8e2d7"],
Cell[CellGroupData[{
Cell[3649, 97, 719, 20, 70, "Input",ExpressionUUID->"27c56f3a-56f1-4b31-9d34-2a5cfd0fcd56"],
Cell[4371, 119, 156, 2, 33, "Output",ExpressionUUID->"0b609f85-4899-471e-b3f9-857e712b75be"]
}, Open  ]],
Cell[4542, 124, 5234, 135, 252, "Input",ExpressionUUID->"b043041e-acf1-497c-b2cd-85366584c727",
 InitializationCell->True],
Cell[9779, 261, 418, 13, 53, "Input",ExpressionUUID->"286058d7-1993-44df-b72e-f3cd0cfd50d7"],
Cell[10200, 276, 211, 4, 29, "Input",ExpressionUUID->"599ee6b9-0cd9-4baf-9942-198bf2c9fc71"],
Cell[10414, 282, 236, 4, 45, "Input",ExpressionUUID->"fb12fc41-fddb-4996-806d-c7f67ceef7f5"],
Cell[10653, 288, 3874, 101, 251, "Input",ExpressionUUID->"238b16c6-adc6-4de2-90e2-96a693e4e899",
 InitializationCell->True],
Cell[14530, 391, 464, 14, 73, "Input",ExpressionUUID->"190b44bf-4909-44ba-962d-28b28b3e3f46"],
Cell[14997, 407, 4568, 129, 294, "Input",ExpressionUUID->"199b16a4-e0c3-4b7f-aee3-da2698fea49a",
 InitializationCell->True],
Cell[19568, 538, 566, 14, 45, "Input",ExpressionUUID->"d00e40ad-4744-469e-a17b-a8d9820ec32f",
 InitializationCell->True],
Cell[20137, 554, 873, 24, 138, "Input",ExpressionUUID->"d4604c2d-b7be-4dda-9377-74a3ab5e789b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[21035, 582, 809, 21, 50, "Input",ExpressionUUID->"a1ce52c0-938e-4f3d-85e5-e39b97e70ece"],
Cell[21847, 605, 235, 5, 33, "Output",ExpressionUUID->"ad8355c0-5596-47b8-9103-acd264d5f2a3"]
}, Open  ]],
Cell[22097, 613, 519, 8, 29, "Input",ExpressionUUID->"777ac47e-e4f2-430d-b84b-8408061e3ab9"],
Cell[22619, 623, 140, 3, 29, "Input",ExpressionUUID->"41231391-4357-41d7-96e3-5b1c310e2d4d"],
Cell[CellGroupData[{
Cell[22784, 630, 951, 21, 50, "Input",ExpressionUUID->"cd488d18-b8b7-4555-aa6b-f2bd9fc22809"],
Cell[23738, 653, 237, 5, 33, "Output",ExpressionUUID->"fc325c11-a8af-478b-96a5-3041d998fb1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24012, 663, 857, 21, 57, "Input",ExpressionUUID->"2a350150-f153-4b8e-8b4f-0c7abdfe5ccf"],
Cell[24872, 686, 3391, 74, 233, "Output",ExpressionUUID->"4d015b7e-6789-4414-bbde-271de994a755"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28300, 765, 986, 30, 65, "Input",ExpressionUUID->"7b7fb29a-15af-426f-9e46-0b10811edae5"],
Cell[29289, 797, 225, 7, 33, "Output",ExpressionUUID->"3f506456-61ab-451b-acfd-3a9964f0a28b"]
}, Open  ]],
Cell[29529, 807, 85, 0, 29, "Input",ExpressionUUID->"95011c91-8910-45e3-a1a1-14a93765129c"],
Cell[29617, 809, 1238, 37, 80, "Input",ExpressionUUID->"eb5c990e-1df2-493e-9a84-5c44329dd472"],
Cell[30858, 848, 624, 18, 57, "Input",ExpressionUUID->"ec421e99-808b-4f84-9db6-b7aee7f77c38"],
Cell[31485, 868, 1051, 29, 68, "Input",ExpressionUUID->"149d1178-bd69-4db0-a3a8-89327ed8a527",
 InitializationCell->True],
Cell[32539, 899, 1102, 31, 68, "Input",ExpressionUUID->"83555f13-e44a-4517-8644-69671fdba21a",
 InitializationCell->True],
Cell[33644, 932, 81, 0, 29, "Input",ExpressionUUID->"28770d39-05ea-4947-8d2d-63a690ac07a8"],
Cell[CellGroupData[{
Cell[33750, 936, 798, 19, 70, "Input",ExpressionUUID->"43496094-0a2f-4699-ae95-93e98ef0e9dd"],
Cell[34551, 957, 263, 4, 33, "Output",ExpressionUUID->"399eac90-3238-4fca-aa5f-b68141b78d79"]
}, Open  ]],
Cell[34829, 964, 1369, 39, 64, "Input",ExpressionUUID->"57617372-40ae-4718-964c-f464c2eba987"],
Cell[CellGroupData[{
Cell[36223, 1007, 1111, 29, 90, "Input",ExpressionUUID->"5fa16a89-3039-4ca5-ba3d-df48400c574e"],
Cell[37337, 1038, 5861, 115, 268, "Output",ExpressionUUID->"23306dd9-68c0-4fbb-9fa0-719f6dc15260"]
}, Open  ]],
Cell[43213, 1156, 168, 3, 45, "Input",ExpressionUUID->"6e448eb0-f631-4fd7-83c9-3115a0e07a19"],
Cell[43384, 1161, 1352, 41, 51, InheritFromParent,ExpressionUUID->"82ea0a7f-15a3-449a-9484-71f7d98bf7a9"],
Cell[44739, 1204, 167, 3, 45, "Input",ExpressionUUID->"9d2cab31-11a2-4db1-a8d7-3ac4ce06fcef"],
Cell[44909, 1209, 3873, 121, 65, InheritFromParent,ExpressionUUID->"c12a2338-427c-442e-817a-99be9bf67314"],
Cell[48785, 1332, 157, 3, 45, "Input",ExpressionUUID->"58f48ef9-061f-43fc-91bb-000de8fa528c"],
Cell[48945, 1337, 1846, 57, 50, InheritFromParent,ExpressionUUID->"a62a24f0-7a84-45a1-954f-31dec392737f"],
Cell[50794, 1396, 161, 3, 45, "Input",ExpressionUUID->"74bf3061-403f-4f82-ad00-da47f9b7cba4"],
Cell[50958, 1401, 1479, 48, 41, InheritFromParent,ExpressionUUID->"c8680777-aaa0-482b-b65a-31592842eee8"],
Cell[52440, 1451, 176, 3, 45, "Input",ExpressionUUID->"231a99bb-ac12-489f-b708-aa0b4fc6107f"],
Cell[52619, 1456, 4272, 138, 49, InheritFromParent,ExpressionUUID->"4e961a86-a73b-4f36-86a3-55462522130f"],
Cell[56894, 1596, 171, 3, 45, "Input",ExpressionUUID->"68165ac4-9412-41ac-93a5-c522be73d232"],
Cell[57068, 1601, 1078, 35, 42, InheritFromParent,ExpressionUUID->"bac2975d-58e4-4dd0-b397-ca8bf4d77ce0"],
Cell[58149, 1638, 1155, 36, 42, InheritFromParent,ExpressionUUID->"db0b6e11-123c-4489-af8d-472a828d713d"],
Cell[59307, 1676, 159, 3, 45, "Input",ExpressionUUID->"9cbeb0cf-c576-4217-8b92-fb7fd0e3658a"],
Cell[59469, 1681, 2349, 74, 48, InheritFromParent,ExpressionUUID->"f4a5c0c3-ec32-489a-9f5b-9fe7b72ad0dc"],
Cell[61821, 1757, 4115, 130, 87, InheritFromParent,ExpressionUUID->"51537a92-2d0f-4c44-a20d-dcb53124f872"],
Cell[65939, 1889, 1833, 62, 43, InheritFromParent,ExpressionUUID->"a35e53fb-6bed-4367-b421-9472720efc98"],
Cell[67775, 1953, 172, 3, 45, "Input",ExpressionUUID->"2bc87c64-1791-414b-b2ff-87427a8db278"],
Cell[67950, 1958, 2987, 67, 370, "Input",ExpressionUUID->"ab7b86c3-7da8-4824-b419-7cfbb638697c"],
Cell[70940, 2027, 1037, 30, 70, "Input",ExpressionUUID->"75be3cc6-6555-46d2-a865-409e0ec98488"],
Cell[71980, 2059, 969, 27, 70, "Input",ExpressionUUID->"bf0c3a61-790b-4c2a-9310-cfeecfb27eaf"],
Cell[72952, 2088, 969, 27, 70, "Input",ExpressionUUID->"ecefacb4-bb77-48a8-9097-ac08911502de"],
Cell[73924, 2117, 1071, 31, 70, "Input",ExpressionUUID->"3dcaee13-280d-4a25-b842-5f497a4ef7bc"],
Cell[74998, 2150, 1063, 30, 70, "Input",ExpressionUUID->"6c045c6f-a02b-4b5c-ae0d-72172209224d"],
Cell[CellGroupData[{
Cell[76086, 2184, 1652, 38, 130, "Input",ExpressionUUID->"ccb3c6c6-6984-4a12-836b-65c5eb2a8612"],
Cell[77741, 2224, 807, 18, 37, "Output",ExpressionUUID->"c805cdad-f982-4638-9bda-e2c34b5704ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78585, 2247, 341, 8, 29, "Input",ExpressionUUID->"1ffe90ac-0e12-4199-8e11-bbc20bb5144f"],
Cell[78929, 2257, 9372, 293, 194, "Output",ExpressionUUID->"f839fea8-3eb9-4ca8-af93-afc4e2c5fa6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88338, 2555, 297, 6, 63, "Input",ExpressionUUID->"5c16758f-e494-46bd-9cd9-c41d220b1998"],
Cell[88638, 2563, 248, 4, 57, "Output",ExpressionUUID->"a4de0609-50f7-49e7-8e59-06b48c485d48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88923, 2572, 126, 0, 29, "Input",ExpressionUUID->"6e25a285-1398-44dc-b0dc-a27259259fcf"],
Cell[89052, 2574, 198, 3, 33, "Output",ExpressionUUID->"acbb507b-aab0-4396-9165-6e803904f761"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89287, 2582, 449, 9, 50, "Input",ExpressionUUID->"d8c809d5-7956-413f-96a5-d66e8a6972a5"],
Cell[89739, 2593, 183, 3, 33, "Output",ExpressionUUID->"a1191695-3bc7-42c6-a3ed-ec256f19cf42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89959, 2601, 197, 5, 32, "Input",ExpressionUUID->"45f48484-a222-4697-ab8b-a3744269dfd7"],
Cell[90159, 2608, 184, 3, 33, "Output",ExpressionUUID->"cda60e07-a775-467f-9a81-ff255ba7e6ba"]
}, Open  ]],
Cell[90358, 2614, 339, 8, 29, "Input",ExpressionUUID->"d8af667a-3631-41b8-b86f-9682bcb2a17a"],
Cell[CellGroupData[{
Cell[90722, 2626, 237, 7, 29, "Input",ExpressionUUID->"8bb1ad86-077a-4f99-8783-fe75b9b04972"],
Cell[90962, 2635, 101, 0, 33, "Output",ExpressionUUID->"e0d979ac-9e6f-4e06-8629-182e4397f02c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91100, 2640, 112, 1, 29, "Input",ExpressionUUID->"bf8d4ed0-32ac-4770-b373-62a8dc3d5069"],
Cell[91215, 2643, 101, 0, 33, "Output",ExpressionUUID->"80025349-6c1d-4dd6-9ef1-f02a4e3d923c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91353, 2648, 187, 5, 29, "Input",ExpressionUUID->"b8898a15-1cf8-4056-90f9-d0cc261cdd33"],
Cell[91543, 2655, 101, 0, 33, "Output",ExpressionUUID->"37990ac7-571f-460d-af78-85b832bd1825"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91681, 2660, 268, 8, 29, "Input",ExpressionUUID->"dac291ca-dd28-4b7d-8132-f8499efe6555"],
Cell[91952, 2670, 194, 4, 33, "Output",ExpressionUUID->"28664848-ac22-45fd-be7f-16ff5ff2e9c4"]
}, Open  ]],
Cell[92161, 2677, 454, 11, 45, "Input",ExpressionUUID->"7fdc5b29-c814-47db-919b-fb88b877f4b4"],
Cell[92618, 2690, 1073, 35, 45, InheritFromParent,ExpressionUUID->"a27379bd-fb3e-4bb4-a5ce-0352bd1a611d"],
Cell[93694, 2727, 1073, 35, 45, InheritFromParent,ExpressionUUID->"376ec576-8b27-4a3f-b317-6ebb8af19266"],
Cell[94770, 2764, 1480, 46, 45, InheritFromParent,ExpressionUUID->"56a488d3-0cad-49d0-9e56-e471e5abeb77"],
Cell[96253, 2812, 1480, 46, 45, InheritFromParent,ExpressionUUID->"e812cfb4-d7e9-495a-92c2-0ac66047aa10"],
Cell[97736, 2860, 1569, 50, 45, InheritFromParent,ExpressionUUID->"5645b6e7-b686-4e2e-90d7-932e08a311b7"],
Cell[99308, 2912, 227, 5, 45, "Input",ExpressionUUID->"a97038be-3764-404c-86ab-7d02fa700f1e"],
Cell[99538, 2919, 427, 12, 46, "Input",ExpressionUUID->"a0c001c3-a317-4b71-9197-27d13e02b0d8"],
Cell[99968, 2933, 394, 11, 45, "Input",ExpressionUUID->"51ab8b6e-ce12-4ef5-819b-40580bb68967"],
Cell[100365, 2946, 1829, 53, 125, "Input",ExpressionUUID->"ab439d59-49a1-4d87-b91e-e9c6798ed6f7"],
Cell[102197, 3001, 5433, 149, 450, "Input",ExpressionUUID->"4084cbca-a905-456a-ab34-75dce5bd58dc",
 InitializationCell->True],
Cell[107633, 3152, 225, 5, 45, "Input",ExpressionUUID->"c2e8b74e-e237-4d9d-9753-fb6eebf9aefc"],
Cell[107861, 3159, 4893, 130, 138, "Input",ExpressionUUID->"7a21539e-6bf8-4165-90ca-bcb839f7839c"],
Cell[112757, 3291, 304, 8, 29, "Input",ExpressionUUID->"e5d7ca6a-e0e2-4123-be85-dcd34bf5d475"],
Cell[CellGroupData[{
Cell[113086, 3303, 1146, 30, 47, "Input",ExpressionUUID->"7d063000-6fcb-4260-a113-ac7f0eba1fce"],
Cell[114235, 3335, 307, 6, 67, "Output",ExpressionUUID->"0854de80-39d1-4d7b-a36e-1885c9427fa4"]
}, Open  ]],
Cell[114557, 3344, 207, 4, 45, "Input",ExpressionUUID->"4464f32a-b7a9-4d3d-9599-f52d279144ec"],
Cell[114767, 3350, 7196, 181, 313, "Input",ExpressionUUID->"93ee2591-8419-40bf-a5a5-e220eca0feac",
 InitializationCell->True],
Cell[121966, 3533, 2947, 76, 91, "Input",ExpressionUUID->"e5e4d286-9a8e-49f5-b86e-c87eb2223cea",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[124938, 3613, 1694, 34, 110, "Input",ExpressionUUID->"4d90bf3a-5d45-4004-ac15-6b63f00f7ea6"],
Cell[126635, 3649, 167, 2, 33, "Output",ExpressionUUID->"ecb226a1-fbe5-4b96-ad20-d7e7f421fab5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126839, 3656, 1707, 34, 110, "Input",ExpressionUUID->"ca6cac89-1aa5-40fe-a9f3-0e292db21c20"],
Cell[128549, 3692, 184, 3, 33, "Output",ExpressionUUID->"3a646bb2-4e5b-4372-8ca7-950b64e3fb9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128770, 3700, 1905, 53, 33, "Input",ExpressionUUID->"93c1b321-9d4c-4e45-b01b-97cd9f01c8b5"],
Cell[130678, 3755, 356, 6, 67, "Output",ExpressionUUID->"6066c890-2d39-4c15-95b0-6ca0bda8fbb2"]
}, Open  ]],
Cell[131049, 3764, 7740, 201, 156, "Input",ExpressionUUID->"01e3e208-d87e-4f21-8f2c-86f6a762a8eb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[138814, 3969, 898, 26, 56, "Input",ExpressionUUID->"4a5408b1-8099-4475-9ae2-ec025b02645e"],
Cell[139715, 3997, 4194, 117, 110, "Output",ExpressionUUID->"afe968b0-a139-4a1b-b620-7b24f3f667aa"]
}, Open  ]],
Cell[143924, 4117, 6171, 158, 233, "Input",ExpressionUUID->"8fc1ef57-6b08-4ebc-8db6-3ec3aee21152",
 InitializationCell->True],
Cell[150098, 4277, 1100, 30, 109, "Input",ExpressionUUID->"0c73431a-9ecd-483c-8acf-6fe6fa7a11e4"],
Cell[CellGroupData[{
Cell[151223, 4311, 1410, 42, 60, "Input",ExpressionUUID->"2a487785-4592-4f46-9c82-333c98e683c3"],
Cell[152636, 4355, 1141, 35, 60, "Output",ExpressionUUID->"97a8834e-439e-43e8-9adb-d87a088c4c09"]
}, Open  ]],
Cell[153792, 4393, 1723, 48, 106, "Input",ExpressionUUID->"6452263b-4da0-4c0a-b395-3caa72f12239",
 InitializationCell->True],
Cell[155518, 4443, 3455, 97, 114, "Input",ExpressionUUID->"b32464af-147f-40f5-8c29-2d741d6f7525",
 InitializationCell->True],
Cell[158976, 4542, 153, 3, 45, "Input",ExpressionUUID->"c5942ab4-5e81-4d5d-a994-ba25e5504604"],
Cell[159132, 4547, 364, 8, 45, "Input",ExpressionUUID->"e887ab26-9432-4460-929c-83e076e1f85f"],
Cell[159499, 4557, 31627, 704, 1724, "Input",ExpressionUUID->"6f86bee1-258d-468f-92e8-3ff3cf098366",
 InitializationCell->True],
Cell[191129, 5263, 182, 4, 45, "Input",ExpressionUUID->"06caebed-0622-443d-83d8-82504378dfd0",
 InitializationCell->True],
Cell[191314, 5269, 250, 4, 45, "Input",ExpressionUUID->"5447409c-36e7-4a73-8cf4-1c63f6d01804"],
Cell[191567, 5275, 7180, 157, 487, "Input",ExpressionUUID->"1b05f5c0-6324-4c5c-81e7-a4410c2bce19",
 InitializationCell->True],
Cell[198750, 5434, 1077, 21, 86, "Input",ExpressionUUID->"fab906c4-36f8-45a5-9567-411b9291e0a1",
 InitializationCell->True],
Cell[199830, 5457, 2779, 63, 146, "Input",ExpressionUUID->"36ad0d67-98ef-4f5f-a89f-d48cb2ec9c85",
 InitializationCell->True],
Cell[202612, 5522, 287, 8, 45, "Input",ExpressionUUID->"2a2715d2-b192-4eff-96fb-36f8148f6b56"],
Cell[202902, 5532, 1411, 28, 86, "Input",ExpressionUUID->"eff7ff41-d820-4c3c-9844-d784f07892b7",
 InitializationCell->True],
Cell[204316, 5562, 268, 6, 45, "Input",ExpressionUUID->"09019b49-3e06-4bf4-8c80-aa07094a07a9"],
Cell[204587, 5570, 472, 14, 29, "Input",ExpressionUUID->"35116c6f-f12c-4178-aaa5-c7994097041c"],
Cell[205062, 5586, 1244, 27, 92, "Input",ExpressionUUID->"748016e8-38d7-4df8-9dbe-697547646af6",
 InitializationCell->True],
Cell[206309, 5615, 1287, 27, 92, "Input",ExpressionUUID->"2c3ee06f-5053-4d45-8f25-6f5b88ae758f",
 InitializationCell->True],
Cell[207599, 5644, 157, 3, 45, "Input",ExpressionUUID->"238da538-496d-4c6b-babb-8ba4918317af"],
Cell[207759, 5649, 1165, 30, 66, "Input",ExpressionUUID->"33840c2a-a95a-4c65-9283-c1c96fde7080",
 InitializationCell->True],
Cell[208927, 5681, 154, 3, 45, "Input",ExpressionUUID->"2f061f29-e049-4657-8a47-35e16c09c408"],
Cell[CellGroupData[{
Cell[209106, 5688, 2315, 45, 406, "Input",ExpressionUUID->"720dc7ab-f411-4cc0-962a-d46ca8f04882",
 InitializationCell->True],
Cell[211424, 5735, 3063, 71, 74, "Output",ExpressionUUID->"608a92c6-d0bf-40ae-b003-c527d6276fc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214524, 5811, 2300, 44, 390, "Input",ExpressionUUID->"38faf354-686c-4760-bbcc-87bd4717929d"],
Cell[216827, 5857, 235, 5, 33, "Output",ExpressionUUID->"b7cd2380-7fa9-454d-8ead-15d04450bbde"]
}, Open  ]],
Cell[217077, 5865, 123, 2, 45, "Input",ExpressionUUID->"60197d04-ba6f-448e-a56e-75fc043172a2"],
Cell[CellGroupData[{
Cell[217225, 5871, 6153, 154, 250, "Input",ExpressionUUID->"d7ba749c-ed81-41c9-b5e0-89c6ff839aca"],
Cell[CellGroupData[{
Cell[223403, 6029, 431, 9, 23, "Print",ExpressionUUID->"28ab8934-29c4-4fa2-8fef-c9cb0386715e"],
Cell[223837, 6040, 677, 15, 23, "Print",ExpressionUUID->"1d40a781-07c9-423e-b6ac-bffcb009a8d7"],
Cell[224517, 6057, 625, 14, 23, "Print",ExpressionUUID->"116b9921-17e2-41af-8e8d-1362edab65c3"],
Cell[225145, 6073, 2227, 41, 42, "Print",ExpressionUUID->"d9d9d4dd-60ee-44cc-a20a-b79e880f7d78"]
}, Open  ]],
Cell[227387, 6117, 4642, 106, 149, "Output",ExpressionUUID->"7a6bd1c4-f230-47f4-9b2c-93547312937c"]
}, Open  ]],
Cell[232044, 6226, 242, 5, 45, "Input",ExpressionUUID->"2ea65a7c-6130-400b-b20b-384f8ccb5273"],
Cell[232289, 6233, 159, 4, 29, "Input",ExpressionUUID->"f6a230e7-3dfb-436c-af66-0ddcadda147d"],
Cell[232451, 6239, 6228, 141, 449, "Input",ExpressionUUID->"c8007728-6047-4f4d-ade2-99f68f1f06d3",
 InitializationCell->True],
Cell[238682, 6382, 1900, 42, 143, "Input",ExpressionUUID->"d18ed378-bde6-423a-842f-b4fa37b016e1",
 InitializationCell->True],
Cell[240585, 6426, 2284, 49, 126, "Input",ExpressionUUID->"b4578f31-2782-4243-84bb-60f0ac26b4ed",
 InitializationCell->True],
Cell[242872, 6477, 2737, 57, 145, "Input",ExpressionUUID->"a2011413-ddf0-4e2e-a104-f851532300d4",
 InitializationCell->True],
Cell[245612, 6536, 2284, 49, 126, "Input",ExpressionUUID->"1c92858c-4a4a-4b2b-bdd8-8797f326e7ed",
 InitializationCell->True],
Cell[247899, 6587, 2414, 52, 145, "Input",ExpressionUUID->"95a1288a-d8de-4b30-9d16-30d50321b488",
 InitializationCell->True],
Cell[250316, 6641, 3465, 76, 234, "Input",ExpressionUUID->"c0dfa895-6653-4de9-9642-74039fb88225",
 InitializationCell->True],
Cell[253784, 6719, 3616, 69, 246, "Input",ExpressionUUID->"0f1e77b3-989e-4855-8f68-021739871632",
 InitializationCell->True],
Cell[257403, 6790, 164, 4, 29, "Input",ExpressionUUID->"b823a046-6685-485f-9b0b-8e7512b83484"],
Cell[257570, 6796, 4105, 86, 308, "Input",ExpressionUUID->"5b3dfbb0-d059-4fd8-8220-93a1f9f55974",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[261700, 6886, 2636, 50, 410, "Input",ExpressionUUID->"f633be31-4a60-44f8-ae6f-5388ee977790"],
Cell[264339, 6938, 271, 6, 56, "Output",ExpressionUUID->"7f99471f-83a4-4f4c-a8e6-27b69e913c5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264647, 6949, 6382, 158, 270, "Input",ExpressionUUID->"52c5ec61-40a6-4425-802e-6928e65181cb"],
Cell[CellGroupData[{
Cell[271054, 7111, 368, 8, 23, "Print",ExpressionUUID->"4983f109-a8c4-4c07-9ebb-9ea554837a1f"],
Cell[271425, 7121, 618, 14, 23, "Print",ExpressionUUID->"b9c265b5-4cc6-4a59-b29f-ec9fcc88906f"],
Cell[272046, 7137, 1166, 24, 27, "Print",ExpressionUUID->"1a248160-7e0b-481c-9764-ce256cd7fe3a"],
Cell[273215, 7163, 564, 13, 23, "Print",ExpressionUUID->"8037da12-a2eb-4bb4-8d57-9f015964b9d1"],
Cell[273782, 7178, 2162, 40, 42, "Print",ExpressionUUID->"49f2d6d8-fbac-4aad-858d-dbac7b04a17d"]
}, Open  ]],
Cell[275959, 7221, 1262, 25, 138, "Output",ExpressionUUID->"f5d40895-53ee-44cc-9ab7-9eb3697cb967"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277258, 7251, 6382, 158, 270, "Input",ExpressionUUID->"fc4722dc-5726-4bcd-a0c1-244a455bd6e9"],
Cell[CellGroupData[{
Cell[283665, 7413, 310, 6, 23, "Print",ExpressionUUID->"a17f4abd-c389-4747-bfa8-0492e86da790"],
Cell[283978, 7421, 561, 13, 23, "Print",ExpressionUUID->"1f0ade3a-0b02-444a-97e0-85b191db48af"],
Cell[284542, 7436, 1109, 23, 27, "Print",ExpressionUUID->"b413d7eb-caa4-4679-b631-25012ba387d4"],
Cell[285654, 7461, 505, 12, 23, "Print",ExpressionUUID->"b951ac38-9a23-43d0-8f9b-dad2758cb5b9"],
Cell[286162, 7475, 2108, 39, 42, "Print",ExpressionUUID->"121d9ca5-ad13-426e-9bd3-b4bbfc9df9b4"]
}, Open  ]],
Cell[288285, 7517, 1226, 25, 141, "Output",ExpressionUUID->"189810e4-233b-479f-a6b4-fd3878264e69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289548, 7547, 12180, 299, 510, "Input",ExpressionUUID->"ad490b0a-5b4c-4bac-b7ca-9d4dc7c123c0"],
Cell[CellGroupData[{
Cell[301753, 7850, 383, 9, 23, "Print",ExpressionUUID->"a13589ce-ea13-48bf-adf1-c8cafce63240"],
Cell[302139, 7861, 629, 15, 23, "Print",ExpressionUUID->"c352eb0a-efca-4fdc-8bef-534c7484e1d1"],
Cell[302771, 7878, 636, 15, 23, "Print",ExpressionUUID->"bf409200-7346-4c87-aa43-a1c4fa0d1507"],
Cell[303410, 7895, 636, 15, 23, "Print",ExpressionUUID->"8b4028bd-c4d5-4902-9f86-d02f5b5973a8"]
}, Open  ]],
Cell[304061, 7913, 6402, 130, 365, "Output",ExpressionUUID->"874db9a4-b840-41ca-89e8-fab0d560a3ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310500, 8048, 7249, 154, 650, "Input",ExpressionUUID->"77459da3-e078-4156-b223-7bc87bf8e6c5"],
Cell[CellGroupData[{
Cell[317774, 8206, 356, 8, 23, "Print",ExpressionUUID->"c27ec56f-9638-491f-8b65-deee22e87538"],
Cell[318133, 8216, 602, 14, 23, "Print",ExpressionUUID->"66cbdd06-5bb1-487d-bfd5-392f38a60544"],
Cell[318738, 8232, 2200, 53, 90, "Print",ExpressionUUID->"01caaf7d-2d67-484f-b17b-ace25b47153f"],
Cell[320941, 8287, 2122, 52, 252, "Print",ExpressionUUID->"45fe8763-7443-4c90-9546-cee648d778af"],
Cell[323066, 8341, 412, 9, 23, "Print",ExpressionUUID->"f87def0e-284d-4204-8aeb-559b52a0a5f7"],
Cell[323481, 8352, 375, 9, 23, "Print",ExpressionUUID->"4c1cf9ea-5535-4c42-8c38-db4faf788031"],
Cell[323859, 8363, 376, 9, 23, "Print",ExpressionUUID->"1145cffd-fe7a-4e16-8840-cda52bde9f10"],
Cell[324238, 8374, 623, 15, 27, "Print",ExpressionUUID->"4c16ba2e-06a7-439c-af17-ddf09534819c"]
}, Open  ]],
Cell[324876, 8392, 227, 4, 33, "Output",ExpressionUUID->"939439e9-1bbe-4744-8012-cf8f70945872"]
}, Open  ]],
Cell[CellGroupData[{
Cell[325140, 8401, 3789, 87, 187, "Input",ExpressionUUID->"ff3f5f4a-214a-4079-a048-382b52ea6740"],
Cell[328932, 8490, 20227, 362, 362, "Output",ExpressionUUID->"b3943c73-5453-4042-84a2-506f7fcf583e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[349196, 8857, 12379, 298, 550, "Input",ExpressionUUID->"72de2c13-5933-42c8-a709-5860cab4ef04"],
Cell[CellGroupData[{
Cell[361600, 9159, 336, 8, 23, "Print",ExpressionUUID->"690733f4-8d26-4408-aa1d-b55ef25c1a3f"],
Cell[361939, 9169, 582, 14, 23, "Print",ExpressionUUID->"2f92085d-25e9-489f-8493-35b8d33a625a"],
Cell[362524, 9185, 589, 14, 23, "Print",ExpressionUUID->"d95cd74c-17e9-45e4-8a28-c05dfb0552da"],
Cell[363116, 9201, 585, 14, 23, "Print",ExpressionUUID->"cc1762fc-6381-4048-b25f-0980dc416db1"]
}, Open  ]],
Cell[363716, 9218, 205, 4, 33, "Output",ExpressionUUID->"14d9f36b-3bf5-4036-835a-3235a0b540fe"]
}, Open  ]],
Cell[363936, 9225, 21441, 511, 730, "Input",ExpressionUUID->"2e527f97-2254-419f-a482-fa41d6660d51"],
Cell[CellGroupData[{
Cell[385402, 9740, 145, 2, 29, "Input",ExpressionUUID->"ef14f015-6312-47ab-892c-4e3d374adc93"],
Cell[CellGroupData[{
Cell[385572, 9746, 336, 8, 23, "Print",ExpressionUUID->"d40c1ec7-d665-4b8b-87bb-e71a2b7ef7e9"],
Cell[385911, 9756, 580, 14, 23, "Print",ExpressionUUID->"01c73546-9dc3-4453-8bfa-c89f917f5435"],
Cell[386494, 9772, 589, 14, 23, "Print",ExpressionUUID->"9676edd8-c29e-499c-a684-21fec53d2eba"],
Cell[387086, 9788, 587, 14, 23, "Print",ExpressionUUID->"a18b444a-5a4a-4385-ac3f-8f277365bf00"]
}, Open  ]],
Cell[387688, 9805, 6161, 128, 415, "Output",ExpressionUUID->"e4d6b783-eaf7-4877-b6dc-b39c6def6047"]
}, Open  ]],
Cell[CellGroupData[{
Cell[393886, 9938, 168, 4, 29, "Input",ExpressionUUID->"42f27e69-b3c6-4534-a73d-8ff9eef2bfc4"],
Cell[CellGroupData[{
Cell[394079, 9946, 291, 7, 23, "Print",ExpressionUUID->"0f8259e3-2ed2-4059-9421-5fd9fdfbea15"],
Cell[394373, 9955, 537, 13, 23, "Print",ExpressionUUID->"6c5321d5-82ef-488c-9175-471a175ed480"],
Cell[394913, 9970, 547, 13, 23, "Print",ExpressionUUID->"5d7ee2e3-84f5-4507-aaf5-31e0559b1b34"],
Cell[395463, 9985, 541, 13, 23, "Print",ExpressionUUID->"4b127790-d225-40ec-85a1-e925617e21e4"]
}, Open  ]],
Cell[396019, 10001, 4804, 95, 390, "Output",ExpressionUUID->"f320c67c-719f-4775-9cba-83bed0ce6ee4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[400860, 10101, 166, 3, 29, "Input",ExpressionUUID->"eb4b7008-23ae-47a2-8e18-db904c37509f"],
Cell[CellGroupData[{
Cell[401051, 10108, 291, 7, 23, "Print",ExpressionUUID->"0b4a1f2b-5dfd-44b2-903e-aafec5b4df99"],
Cell[401345, 10117, 537, 13, 23, "Print",ExpressionUUID->"79d8125f-d938-4ed1-9174-b98104a124a3"],
Cell[401885, 10132, 547, 13, 23, "Print",ExpressionUUID->"482f38cf-f105-4f8b-b976-40d93efbae73"],
Cell[402435, 10147, 541, 13, 23, "Print",ExpressionUUID->"111d1d2d-9c37-41f1-ac84-22a1ce468141"]
}, Open  ]],
Cell[402991, 10163, 4806, 95, 383, "Output",ExpressionUUID->"d674143d-4b0d-40cc-bc5c-7299cde53b38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[407834, 10263, 171, 4, 29, "Input",ExpressionUUID->"2709c57c-9b53-42fd-96b5-dc2567bd9c52"],
Cell[CellGroupData[{
Cell[408030, 10271, 291, 7, 23, "Print",ExpressionUUID->"d7d13d19-8660-4c15-8437-450066c7ce4d"],
Cell[408324, 10280, 537, 13, 23, "Print",ExpressionUUID->"e3ee1ccf-daeb-4e61-9bb0-28cf6dde5d31"],
Cell[408864, 10295, 547, 13, 23, "Print",ExpressionUUID->"2cd055a1-650b-4a0a-b559-7e18768bcc23"],
Cell[409414, 10310, 541, 13, 23, "Print",ExpressionUUID->"e7665d1d-6f3d-4fef-a1b3-1e8fab87aea3"]
}, Open  ]],
Cell[409970, 10326, 4790, 95, 432, "Output",ExpressionUUID->"43b60bc6-32f2-44bf-87b1-29e98f86d199"]
}, Open  ]],
Cell[CellGroupData[{
Cell[414797, 10426, 169, 4, 29, "Input",ExpressionUUID->"d60c532b-0412-43e7-a9d6-200adb6bd69a"],
Cell[CellGroupData[{
Cell[414991, 10434, 291, 7, 23, "Print",ExpressionUUID->"c2fd8977-2131-4531-957d-3bf7215fc3f5"],
Cell[415285, 10443, 537, 13, 23, "Print",ExpressionUUID->"ed854091-f06a-474f-9975-d2ebdb042562"],
Cell[415825, 10458, 547, 13, 23, "Print",ExpressionUUID->"0418706b-c61d-45ca-b63d-113a075c3afa"],
Cell[416375, 10473, 541, 13, 23, "Print",ExpressionUUID->"f1f2a62e-8cc8-4833-9432-9b1bd80871d4"]
}, Open  ]],
Cell[416931, 10489, 4753, 95, 407, "Output",ExpressionUUID->"a794aec9-90d4-4af7-a697-6cf9237789b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[421721, 10589, 169, 4, 29, "Input",ExpressionUUID->"c9adb17b-b67d-4838-9a98-6261cdce2bfd"],
Cell[CellGroupData[{
Cell[421915, 10597, 291, 7, 23, "Print",ExpressionUUID->"ff4a9c62-5023-4153-8c0d-2f6efbf308e0"],
Cell[422209, 10606, 537, 13, 23, "Print",ExpressionUUID->"807e2f06-34fe-4871-afbb-4f2e9ca76c2d"],
Cell[422749, 10621, 547, 13, 23, "Print",ExpressionUUID->"5a704d1a-dcb8-4e27-8a77-06110ac8eaa4"],
Cell[423299, 10636, 541, 13, 23, "Print",ExpressionUUID->"cdf47e0d-54a3-489e-9a77-3a462044a495"]
}, Open  ]],
Cell[423855, 10652, 4697, 95, 403, "Output",ExpressionUUID->"5f00022a-0be5-4642-aedc-42e01ddfd7d3"]
}, Open  ]]
}
]
*)

