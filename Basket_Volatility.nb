(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    317911,       7405]
NotebookOptionsPosition[    307162,       7082]
NotebookOutlinePosition[    307533,       7098]
CellTagsIndexPosition[    307490,       7095]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My \
Documents\\\\BS.m\>\""}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My Documents\\\\SABR.m\>\
\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391430708558905*^9, 3.3914307096058006`*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\<C:\\\\Documents and Settings\\\\ocroissant\\\\My \
Documents\\\\NumericalIntegration.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391430708558905*^9, 3.3914307096058006`*^9}, 
   3.3917554474411097`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HaganVol", "[", 
   RowBox[{
   "S_", ",", "K_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Zeta]", "=", 
       RowBox[{
        FractionBox["\[Nu]", "\[Alpha]"], 
        RowBox[{"Log", "[", 
         RowBox[{"S", "/", "K"}], "]"}]}]}], ",", "x"}], "}"}], ",", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           RowBox[{"2", "\[Rho]", " ", "\[Zeta]"}], "+", 
           SuperscriptBox["\[Zeta]", "2"]}]], "-", "\[Rho]", "+", "\[Zeta]"}],
         
        RowBox[{"1", "-", "\[Rho]"}]], "]"}]}], ";", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       FractionBox["\[Zeta]", "x"], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", "4"], "\[Rho]", " ", "\[Alpha]", " ", "\[Nu]"}], 
           "+", 
           RowBox[{
            FractionBox["1", "24"], 
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"3", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}], 
            SuperscriptBox["\[Nu]", "2"]}]}], ")"}], "T"}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3914255279594393`*^9, 3.3914258132305417`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.11"}], ",", 
     RowBox[{"\[Beta]", "=", "0.7"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.2"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"HaganVol", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", "0.3"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.391429632522621*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
God/TdwUIv4/AOEhCA==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.05, 0.1},
  PlotRange->{{0.02, 0.3}, {0.09883994067909477, 0.1667419958850753}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.391429638725865*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"SABROptionHaganPure", "[", 
    RowBox[{
    "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "K_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "x", ",", "Effetmat", ",", "vol"}], "}"}], ",", 
     RowBox[{
      RowBox[{"z", "=", 
       FractionBox[
        RowBox[{
         SuperscriptBox["f", 
          RowBox[{"1", "-", "\[Beta]"}]], "-", 
         SuperscriptBox["K", 
          RowBox[{"1", "-", "\[Beta]"}]]}], 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Rho]"}], "+", 
           RowBox[{"\[Nu]", " ", "z"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], " ", 
              SuperscriptBox["z", "2"]}]}]]}], 
          RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Effetmat", "=", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "24"], " ", 
              SuperscriptBox["\[Alpha]", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Beta]"}], ")"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"f", " ", "K"}], ")"}], 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]"}]]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", "\[Alpha]", " ", "\[Beta]", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"f", " ", "K"}], ")"}], 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}]}]], " ", 
              "\[Nu]", " ", "\[Rho]"}], "+", 
             RowBox[{
              FractionBox["1", "24"], " ", 
              SuperscriptBox["\[Nu]", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}], " ", 
           "T"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "24"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Log", "[", 
             FractionBox["f", "K"], "]"}], "2"]}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Beta]"}], ")"}], "4"], " ", 
            SuperscriptBox[
             RowBox[{"Log", "[", 
              FractionBox["f", "K"], "]"}], "4"]}], "1920"]}], ")"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vol", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"z", "\[Equal]", "0"}], ",", 
         RowBox[{
          SuperscriptBox["K", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]"}]], " ", "\[Alpha]", " ", 
          "Effetmat"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          FractionBox["\[Alpha]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"f", " ", "K"}], ")"}], 
            FractionBox[
             RowBox[{"1", "-", "\[Beta]"}], 
             RowBox[{"2", " "}]]]], " ", 
          FractionBox["z", "x"], "  ", "Effetmat"}]}], "  ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BS", "[", 
       RowBox[{"f", ",", "K", ",", "T", ",", "vol"}], " ", "]"}]}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.388747033023386*^9, 3.3887470688834496`*^9}, {
  3.3887471345253344`*^9, 3.388747164025901*^9}, {3.388747342044944*^9, 
  3.3887473734986725`*^9}, {3.388747406030547*^9, 3.388747533298616*^9}, {
  3.388747587362154*^9, 3.3887476113313637`*^9}, {3.3887477318805532`*^9, 
  3.388747737052528*^9}, {3.3887478340075145`*^9, 3.3887478344918985`*^9}, {
  3.391487749766529*^9, 3.3914877921735926`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SABRVolDirectPure", "[", 
    RowBox[{
    "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "K_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "z", ",", "zp", ",", "x", ",", "b1", ",", "\[Theta]", ",", 
       "\[FinalSigma]", ",", "\[Kappa]", ",", "result", ",", "\[Sigma]", ",", 
       "a", ",", "b", ",", "sig", ",", "sigN", ",", "fav2", ",", "\[Gamma]1", 
       ",", "\[Gamma]2", ",", "\[Xi]", ",", "call"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fav", "=", 
       FractionBox[
        RowBox[{"f", "+", "K"}], "2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "\[NotEqual]", "1"}], ",", " ", 
        RowBox[{"z", "=", 
         FractionBox[
          RowBox[{
           SuperscriptBox["f", 
            RowBox[{"1", "-", "\[Beta]"}]], "-", 
           SuperscriptBox["K", 
            RowBox[{"1", "-", "\[Beta]"}]]}], 
          RowBox[{"\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}], ",", 
        RowBox[{"z", "=", 
         RowBox[{
          FractionBox[
           RowBox[{"Log", "[", "f", "]"}], "\[Alpha]"], "-", 
          FractionBox[
           RowBox[{"Log", "[", "K", "]"}], "\[Alpha]"]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "\[NotEqual]", "1"}], ",", " ", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"\[Nu]", 
          FractionBox[
           RowBox[{
            SuperscriptBox["f", 
             RowBox[{"1", "-", "\[Beta]"}]], "-", 
            SuperscriptBox["K", 
             RowBox[{"1", "-", "\[Beta]"}]]}], 
           RowBox[{"\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}]}], ",", " ", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"\[Nu]", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", "f", "]"}], "\[Alpha]"], "-", 
            FractionBox[
             RowBox[{"Log", "[", "K", "]"}], "\[Alpha]"]}], ")"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Rho]"}], "+", 
           RowBox[{"\[Nu]", " ", "z"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], " ", 
              SuperscriptBox["z", "2"]}]}]]}], 
          RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["fav", 
         RowBox[{"\[Beta]", "-", "1"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"\[Theta]", "=", "1"}], ";", 
         RowBox[{"sig", "=", 
          RowBox[{
           SuperscriptBox["K", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]"}]], " ", "\[Alpha]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "T", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  SuperscriptBox["K", 
                   RowBox[{"2", " ", "\[Beta]"}]], " ", 
                  SuperscriptBox["\[Alpha]", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], "2"]}], "+", 
                 
                 RowBox[{
                  SuperscriptBox["K", "2"], " ", "\[Nu]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"6", " ", "b1", " ", "\[Alpha]", " ", "\[Rho]"}], 
                    "+", 
                    RowBox[{"\[Nu]", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
                RowBox[{"24", " ", 
                 SuperscriptBox["K", "2"]}]]}]}], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]", "=", 
          RowBox[{
           RowBox[{
            FractionBox["1", "4"], " ", "\[Alpha]", " ", "b1", " ", "\[Nu]", 
            " ", "\[Rho]", " ", 
            SuperscriptBox["z", "2"]}], "+", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"\[Alpha]", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"f", " ", "K"}], ")"}], 
               RowBox[{"\[Beta]", "/", "2"}]], " ", "z"}], 
             RowBox[{"f", "-", "K"}]], "]"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"x", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
                 RowBox[{
                  SuperscriptBox["\[Nu]", "2"], " ", 
                  SuperscriptBox["z", "2"]}]}], ")"}], 
               RowBox[{"1", "/", "4"}]]}], "z"], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sig", "=", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             RowBox[{"f", "/", "K"}], "]"}], 
            RowBox[{" ", "z"}]], 
           FractionBox["\[Xi]", 
            RowBox[{"\[Nu]", " ", "x"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "T", 
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"\[Theta]", "-", 
                  RowBox[{"Log", "[", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"f", "/", "K"}], "]"}], " ", 
                    SqrtBox[
                    RowBox[{"f", " ", "K"}]]}], 
                    RowBox[{"f", "-", "K"}]], "]"}]}], 
                 SuperscriptBox["x", "2"]], ")"}]}]}], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]]}]}]}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3914850732151403`*^9, 3.3914851001219063`*^9}, {
  3.391517870694084*^9, 3.3915178797255077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SABROptionDirectPure", "[", 
    RowBox[{
    "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "K_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "z", ",", "zp", ",", "x", ",", "b1", ",", "\[Theta]", ",", 
       "\[FinalSigma]", ",", "\[Kappa]", ",", "result", ",", "\[Sigma]", ",", 
       "a", ",", "b", ",", "sig", ",", "sigN", ",", "fav2", ",", "\[Gamma]1", 
       ",", "\[Gamma]2", ",", "\[Xi]", ",", "call"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fav", "=", 
       FractionBox[
        RowBox[{"f", "+", "K"}], "2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "\[NotEqual]", "1"}], ",", " ", 
        RowBox[{"z", "=", 
         FractionBox[
          RowBox[{
           SuperscriptBox["f", 
            RowBox[{"1", "-", "\[Beta]"}]], "-", 
           SuperscriptBox["K", 
            RowBox[{"1", "-", "\[Beta]"}]]}], 
          RowBox[{"\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}], ",", 
        RowBox[{"z", "=", 
         RowBox[{
          FractionBox[
           RowBox[{"Log", "[", "f", "]"}], "\[Alpha]"], "-", 
          FractionBox[
           RowBox[{"Log", "[", "K", "]"}], "\[Alpha]"]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "\[NotEqual]", "1"}], ",", " ", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"\[Nu]", 
          FractionBox[
           RowBox[{
            SuperscriptBox["f", 
             RowBox[{"1", "-", "\[Beta]"}]], "-", 
            SuperscriptBox["K", 
             RowBox[{"1", "-", "\[Beta]"}]]}], 
           RowBox[{"\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}]}], ",", " ", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"\[Nu]", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", "f", "]"}], "\[Alpha]"], "-", 
            FractionBox[
             RowBox[{"Log", "[", "K", "]"}], "\[Alpha]"]}], ")"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Rho]"}], "+", 
           RowBox[{"\[Nu]", " ", "z"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], " ", 
              SuperscriptBox["z", "2"]}]}]]}], 
          RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["fav", 
         RowBox[{"\[Beta]", "-", "1"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"\[Theta]", "=", "1"}], ";", 
         RowBox[{"sig", "=", 
          RowBox[{
           SuperscriptBox["K", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]"}]], " ", "\[Alpha]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "T", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  SuperscriptBox["K", 
                   RowBox[{"2", " ", "\[Beta]"}]], " ", 
                  SuperscriptBox["\[Alpha]", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Beta]"}], ")"}], "2"]}], "+", 
                 
                 RowBox[{
                  SuperscriptBox["K", "2"], " ", "\[Nu]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"6", " ", "b1", " ", "\[Alpha]", " ", "\[Rho]"}], 
                    "+", 
                    RowBox[{"\[Nu]", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
                RowBox[{"24", " ", 
                 SuperscriptBox["K", "2"]}]]}]}], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]", "=", 
          RowBox[{
           RowBox[{
            FractionBox["1", "4"], " ", "\[Alpha]", " ", "b1", " ", "\[Nu]", 
            " ", "\[Rho]", " ", 
            SuperscriptBox["z", "2"]}], "+", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"\[Alpha]", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"f", " ", "K"}], ")"}], 
               RowBox[{"\[Beta]", "/", "2"}]], " ", "z"}], 
             RowBox[{"f", "-", "K"}]], "]"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"x", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
                 RowBox[{
                  SuperscriptBox["\[Nu]", "2"], " ", 
                  SuperscriptBox["z", "2"]}]}], ")"}], 
               RowBox[{"1", "/", "4"}]]}], "z"], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sig", "=", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             RowBox[{"f", "/", "K"}], "]"}], 
            RowBox[{" ", "z"}]], 
           FractionBox["\[Xi]", 
            RowBox[{"\[Nu]", " ", "x"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "T", 
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"\[Theta]", "-", 
                  RowBox[{"Log", "[", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"f", "/", "K"}], "]"}], " ", 
                    SqrtBox[
                    RowBox[{"f", " ", "K"}]]}], 
                    RowBox[{"f", "-", "K"}]], "]"}]}], 
                 SuperscriptBox["x", "2"]], ")"}]}]}], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]]}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BS", "[", 
       RowBox[{"f", ",", "K", ",", "T", ",", "sig"}], " ", "]"}]}]}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3914850732151403`*^9, 3.3914851001219063`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SABROptionAnalyticPure", "[", 
    RowBox[{
    "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
     ",", "K_", ",", "T_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "z", ",", "zp", ",", "x", ",", "b1", ",", "\[Theta]", ",", 
       "\[FinalSigma]", ",", "\[Kappa]", ",", "result", ",", "\[Sigma]", ",", 
       "a", ",", "b", ",", "sig", ",", "sigN", ",", "fav2", ",", "\[Gamma]1", 
       ",", "\[Gamma]2", ",", "\[Xi]", ",", "call"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fav", "=", 
       FractionBox[
        RowBox[{"f", "+", "K"}], "2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "\[NotEqual]", "1"}], ",", " ", 
        RowBox[{"z", "=", 
         FractionBox[
          RowBox[{
           SuperscriptBox["f", 
            RowBox[{"1", "-", "\[Beta]"}]], "-", 
           SuperscriptBox["K", 
            RowBox[{"1", "-", "\[Beta]"}]]}], 
          RowBox[{"\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}], ",", 
        RowBox[{"z", "=", 
         RowBox[{
          FractionBox[
           RowBox[{"Log", "[", "f", "]"}], "\[Alpha]"], "-", 
          FractionBox[
           RowBox[{"Log", "[", "K", "]"}], "\[Alpha]"]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "\[NotEqual]", "1"}], ",", " ", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"\[Nu]", 
          FractionBox[
           RowBox[{
            SuperscriptBox["f", 
             RowBox[{"1", "-", "\[Beta]"}]], "-", 
            SuperscriptBox["K", 
             RowBox[{"1", "-", "\[Beta]"}]]}], 
           RowBox[{"\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]"}], ")"}]}]]}]}], ",", " ", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"\[Nu]", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", "f", "]"}], "\[Alpha]"], "-", 
            FractionBox[
             RowBox[{"Log", "[", "K", "]"}], "\[Alpha]"]}], ")"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Rho]"}], "+", 
           RowBox[{"\[Nu]", " ", "z"}], "+", 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], " ", 
              SuperscriptBox["z", "2"]}]}]]}], 
          RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{"\[Beta]", " ", 
        SuperscriptBox["fav", 
         RowBox[{"\[Beta]", "-", "1"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[Equal]", "0"}], ",", 
        RowBox[{"\[Theta]", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", "=", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], " ", "\[Alpha]", " ", "b1", " ", "\[Nu]", 
           " ", "\[Rho]", " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{"\[Alpha]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"f", " ", "K"}], ")"}], 
              RowBox[{"\[Beta]", "/", "2"}]], " ", "z"}], 
            RowBox[{"f", "-", "K"}]], "]"}], "+", 
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{"x", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
                RowBox[{
                 SuperscriptBox["\[Nu]", "2"], " ", 
                 SuperscriptBox["z", "2"]}]}], ")"}], 
              RowBox[{"1", "/", "4"}]]}], "z"], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]", "=", 
       RowBox[{
        FractionBox["1", "8"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Alpha]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Beta]"}], ")"}], " ", "\[Beta]", 
            " ", 
            SuperscriptBox["K", 
             RowBox[{"2", " ", "\[Beta]"}]]}], 
           SuperscriptBox["K", "2"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "\[Alpha]", " ", "\[Beta]", " ", 
            SuperscriptBox["K", "\[Beta]"], " ", "\[Nu]", " ", "\[Rho]"}], 
           "K"], "+", 
          RowBox[{
           SuperscriptBox["\[Nu]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]", "=", 
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["f", 
         RowBox[{"\[Beta]", "-", "1"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Abs", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       SqrtBox[
        RowBox[{"-", "\[Kappa]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[Equal]", "0"}], ",", 
        RowBox[{"call", "=", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["K", "\[Beta]"], " ", "\[Alpha]"}], 
           RowBox[{"2", " ", 
            SqrtBox[
             RowBox[{"2", " ", "\[Pi]"}]]}]], " ", 
          RowBox[{"Re", "[", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"2", " ", "a"}]], 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", 
                  SqrtBox["2"]}], " ", "a", " ", "b"}]], " ", 
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"2", " ", 
                   SqrtBox["2"], " ", "a", " ", "b"}]], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"2", " ", 
                    SqrtBox["2"], " ", "a", " ", "b"}]], " ", 
                  RowBox[{"Erf", "[", 
                   RowBox[{
                    FractionBox["b", 
                    RowBox[{
                    SqrtBox["2"], " ", 
                    SqrtBox["T"]}]], "+", 
                    RowBox[{"a", " ", 
                    SqrtBox["T"]}]}], "]"}]}], "-", 
                 RowBox[{"Erf", "[", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    SqrtBox["2"], " ", "b"}], "-", 
                    RowBox[{"2", " ", "a", " ", "T"}]}], 
                   RowBox[{"2", " ", 
                    SqrtBox["T"]}]], "]"}]}], ")"}]}], ")"}]}], ")"}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"call", "=", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"f", "-", "K"}], ",", "0"}], "]"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"(", 
              RowBox[{"f", "-", "K"}], ")"}], 
             RowBox[{"2", 
              SqrtBox[
               RowBox[{"2", "\[Pi]"}]]}]], 
            FractionBox[
             SuperscriptBox["E", "\[Theta]"], "x"], " ", 
            RowBox[{"Re", "[", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"2", " ", "a"}]], 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                   RowBox[{"-", 
                    SqrtBox["2"]}], " ", "a", " ", "b"}]], " ", 
                 SqrtBox["\[Pi]"], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", 
                    SqrtBox["2"], " ", "a", " ", "b"}]], "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", 
                    SqrtBox["2"], " ", "a", " ", "b"}]], " ", 
                    RowBox[{"Erf", "[", 
                    RowBox[{
                    FractionBox["b", 
                    RowBox[{
                    SqrtBox["2"], " ", 
                    SqrtBox["T"]}]], "+", 
                    RowBox[{"a", " ", 
                    SqrtBox["T"]}]}], "]"}]}], "-", 
                   RowBox[{"Erf", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    SqrtBox["2"], " ", "b"}], "-", 
                    RowBox[{"2", " ", "a", " ", "T"}]}], 
                    RowBox[{"2", " ", 
                    SqrtBox["T"]}]], "]"}]}], ")"}]}], ")"}]}], ")"}], 
             "]"}]}]}], "]"}]}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391431002705178*^9, 3.3914310171585803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRVolStrikeCuterPure", "[", 
   RowBox[{
   "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K1_", ",", "T_", ",", "zerocuterKb_", ",", "\[Alpha]p_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "K", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"UnitStep", "[", 
         RowBox[{"K1", "-", "zerocuterKb"}], "]"}], "K1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"zerocuterKb", "-", "K1"}], "]"}], ")"}], " ", 
        "zerocuterKb", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Alpha]p", " ", 
           RowBox[{"Tanh", "[", 
            FractionBox[
             RowBox[{"K1", "-", "zerocuterKb"}], 
             RowBox[{"\[Alpha]p", " ", "zerocuterKb"}]], "]"}]}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SABROptionHaganPure", "[", 
      RowBox[{
      "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
       "K", ",", "T"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39184709637669*^9, 3.391847099345497*^9}, {
   3.3918473749132876`*^9, 3.3918474519147663`*^9}, {3.3918474895561137`*^9, 
   3.391847513447198*^9}, {3.3918478850949583`*^9, 3.3918479117673454`*^9}, {
   3.3918483453381696`*^9, 3.39184836126035*^9}, 3.391848522450945*^9, 
   3.3918510254833775`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRVolStrikeCuterPure", "[", 
   RowBox[{
   "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K1_", ",", "T_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "K", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"K1", "+", 
       RowBox[{"\[Epsilon]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "K1"}], "/", "\[Epsilon]"}]]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SABROptionHaganPure", "[", 
      RowBox[{
      "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
       "K", ",", "T"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39184709637669*^9, 3.391847099345497*^9}, {
   3.3918473749132876`*^9, 3.3918474519147663`*^9}, {3.3918474895561137`*^9, 
   3.391847513447198*^9}, {3.3918478850949583`*^9, 3.3918479117673454`*^9}, 
   3.3918510298740864`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABROptionStrikeCuterPure", "[", 
   RowBox[{
   "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K1_", ",", "T_", ",", "zerocuterKb_", ",", "\[Alpha]p_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "K", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"UnitStep", "[", 
         RowBox[{"K1", "-", "zerocuterKb"}], "]"}], "K1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"zerocuterKb", "-", "K1"}], "]"}], ")"}], " ", 
        "zerocuterKb", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Alpha]p", " ", 
           RowBox[{"Tanh", "[", 
            FractionBox[
             RowBox[{"K1", "-", "zerocuterKb"}], 
             RowBox[{"\[Alpha]p", " ", "zerocuterKb"}]], "]"}]}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SABROptionDirectPure", "[", 
      RowBox[{
      "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
       "K", ",", "T"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39184709637669*^9, 3.391847099345497*^9}, {
   3.3918473749132876`*^9, 3.3918474519147663`*^9}, {3.3918474895561137`*^9, 
   3.391847513447198*^9}, {3.3918478850949583`*^9, 3.3918479117673454`*^9}, {
   3.3918483453381696`*^9, 3.39184836126035*^9}, {3.391848412198828*^9, 
   3.391848416261406*^9}, 3.391848529888588*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABROptionStrikeCuterPure", "[", 
   RowBox[{
   "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K1_", ",", "T_", ",", "\[Epsilon]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "K", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"K1", "+", 
       RowBox[{"\[Epsilon]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "K1"}], "/", "\[Epsilon]"}]]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SABROptionDirectPure", "[", 
      RowBox[{
      "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
       "K", ",", "T"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39184709637669*^9, 3.391847099345497*^9}, {
  3.3918473749132876`*^9, 3.3918474519147663`*^9}, {3.3918474895561137`*^9, 
  3.391847542182124*^9}, {3.391847891251326*^9, 3.391847903595313*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABROptionStrikeCuterPure1", "[", 
   RowBox[{
   "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K1_", ",", "T_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"SABROptionStrikeCuterPure", "[", 
   RowBox[{
   "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
    "K1", ",", "T", ",", "0.3", ",", "1.5"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39184709637669*^9, 3.391847099345497*^9}, {
   3.3918473749132876`*^9, 3.3918474519147663`*^9}, {3.3918474895561137`*^9, 
   3.391847542182124*^9}, {3.391847980674918*^9, 3.391847999940913*^9}, 
   3.391848213741893*^9, {3.39184845604342*^9, 3.391848457449697*^9}, 
   3.391848908661485*^9, 3.3918514981799526`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABROptionStrikeCuterPure2", "[", 
   RowBox[{
   "f_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", 
    ",", "K1_", ",", "T_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"SABROptionStrikeCuterPure", "[", 
   RowBox[{
   "f", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
    "K1", ",", "T", ",", "0.03"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39184709637669*^9, 3.391847099345497*^9}, {
   3.3918473749132876`*^9, 3.3918474519147663`*^9}, {3.3918474895561137`*^9, 
   3.391847542182124*^9}, {3.391847980674918*^9, 3.391847999940913*^9}, 
   3.391848213741893*^9, {3.39184845604342*^9, 3.391848457449697*^9}, {
   3.391848906364566*^9, 3.391848913083445*^9}, 3.391851556493572*^9, 
   3.391851831420726*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.11"}], ",", 
     RowBox[{"\[Beta]", "=", "0.7"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.2"}], ",", "\[Sigma]"}], "}"}], ",", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"SABRVolDirectPure", "[", 
      RowBox[{
      "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
       "S", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ComputeAlphaSABROptionAnalytic", "[", 
     RowBox[{
     "S", ",", "\[Sigma]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", 
      "T"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3915177193005524`*^9, 3.3915178252088356`*^9}, {
  3.3915179912745237`*^9, 3.3915180239001503`*^9}}],

Cell[BoxData["0.11000003930647594`"], "Output",
 CellChangeTimes->{{3.3915177394259386`*^9, 3.391517747238589*^9}, {
   3.391517816411792*^9, 3.391517825802597*^9}, 3.391517918132495*^9, 
   3.391517979149291*^9, 3.39151802569706*^9, 3.3918517669038625`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeAlphaSABROptionAnalytic", "[", 
   RowBox[{
   "f_", ",", "ATMvol_", ",", "\[Beta]_", ",", "\[Rho]_", ",", "\[Nu]_", ",", 
    "T_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"NewtonFindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"SABRVolDirectPure", "[", 
         RowBox[{
         "f", ",", "#", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", ",", "f",
           ",", "T"}], "]"}], "-", "ATMvol"}], ")"}], "&"}], ",", "0.05", ",",
      "0.01", ",", "0.00001", ",", "10"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3915174630456324`*^9, 3.3915175607350082`*^9}, {
  3.391517672659032*^9, 3.3915176744246907`*^9}, {3.3915177095816154`*^9, 
  3.391517710675387*^9}, {3.391517892444502*^9, 3.391517913554282*^9}, {
  3.391517952461279*^9, 3.391517961023943*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormDis", "[", "x_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"Erf", "[", 
     FractionBox["x", 
      SqrtBox["2"]], "]"}], "+", "1"}], "2"]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BS", "[", 
   RowBox[{"f_", ",", "k_", ",", "t_", ",", "v_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"f", "  ", 
    RowBox[{"NormDis", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox["f", "k"], "]"}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["v", "2"], "t"}], "2"]}], 
      RowBox[{"v", " ", 
       RowBox[{"Sqrt", "[", "t", "]"}]}]], "]"}]}], "-", 
   RowBox[{"k", "  ", 
    RowBox[{"NormDis", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox["f", "k"], "]"}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["v", "2"], "t"}], "2"]}], 
      RowBox[{"v", " ", 
       RowBox[{"Sqrt", "[", "t", "]"}]}]], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3914259885464077`*^9, 3.3914259903589425`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"(", 
    SuperscriptBox["\[Sigma]", "2"], ")"}], "Dupire"], "=", 
  FractionBox[
   RowBox[{"2", 
    FractionBox[
     RowBox[{"\[PartialD]", "C"}], 
     RowBox[{"\[PartialD]", "T"}]]}], 
   RowBox[{
    SuperscriptBox["K", "2"], 
    FractionBox[
     RowBox[{"\[PartialD]", "C"}], 
     RowBox[{"\[PartialD]", "K"}]]}]]}]], "Text",
 CellChangeTimes->{{3.391426941377202*^9, 3.3914270114410467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DupireVolGeneric", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Calendar", "=", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"Log", "[", 
               FractionBox["S", "k"], "]"}], "2"], 
             RowBox[{"2", " ", "T", " ", 
              SuperscriptBox[
               RowBox[{"v", "[", 
                RowBox[{"k", ",", "T"}], "]"}], "2"]}]]}], "-", 
           RowBox[{
            FractionBox["1", "8"], " ", "T", " ", 
            SuperscriptBox[
             RowBox[{"v", "[", 
              RowBox[{"k", ",", "T"}], "]"}], "2"]}]}]], " ", 
         SqrtBox[
          FractionBox["S", "k"]], " ", "k", " ", 
         SqrtBox["T"], " ", 
         RowBox[{
          SuperscriptBox["v", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"k", ",", "T"}], "]"}]}], 
        SqrtBox[
         RowBox[{"2", " ", "\[Pi]"}]]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"cspread", "=", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Erf", "[", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               RowBox[{"Log", "[", 
                FractionBox["S", "k"], "]"}]}], "+", 
              RowBox[{"T", " ", 
               SuperscriptBox[
                RowBox[{"v", "[", 
                 RowBox[{"k", ",", "T"}], "]"}], "2"]}]}], 
             RowBox[{"2", " ", 
              SqrtBox["2"], " ", 
              SqrtBox["T"], " ", 
              RowBox[{"v", "[", 
               RowBox[{"k", ",", "T"}], "]"}]}]], "]"}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"Log", "[", 
                FractionBox["S", "k"], "]"}], "2"], 
              RowBox[{"2", " ", "T", " ", 
               SuperscriptBox[
                RowBox[{"v", "[", 
                 RowBox[{"k", ",", "T"}], "]"}], "2"]}]]}], "-", 
            RowBox[{
             FractionBox["1", "8"], " ", "T", " ", 
             SuperscriptBox[
              RowBox[{"v", "[", 
               RowBox[{"k", ",", "T"}], "]"}], "2"]}]}]], " ", 
          SqrtBox[
           FractionBox["S", "k"]], " ", "k", " ", 
          SqrtBox["T"], " ", 
          RowBox[{
           SuperscriptBox["v", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"k", ",", "T"}], "]"}]}], 
         SqrtBox[
          RowBox[{"2", " ", "\[Pi]"}]]]}]}]}], "}"}], ",", 
    RowBox[{"2", 
     FractionBox["Calendar", 
      RowBox[{
       SuperscriptBox["k", "2"], "cspread"}]]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, 
   3.3914301799237556`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRDensity1", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"kshift", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionHaganPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
       RowBox[{"SABROptionHaganPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"SABROptionHaganPure", "[", 
         RowBox[{
         "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
          ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
     SuperscriptBox["kshift", "2"]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, 3.391488334137123*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRDensity2", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"kshift", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABRVolDirectPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
       RowBox[{"SABRVolDirectPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"SABRVolDirectPure", "[", 
         RowBox[{
         "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
          ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
     SuperscriptBox["kshift", "2"]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, 3.391488334137123*^9, {3.39184906725828*^9, 
   3.391849068273925*^9}, {3.391849110821616*^9, 3.391849115899839*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRDensity3", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"kshift", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionAnalyticPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
       RowBox[{"SABROptionAnalyticPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"SABROptionAnalyticPure", "[", 
         RowBox[{
         "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
          ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
     SuperscriptBox["kshift", "2"]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, 3.391488334137123*^9, {3.391849071102104*^9, 
   3.3918490716177387`*^9}, {3.3918491342283163`*^9, 3.391849138494023*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRDensity4", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"kshift", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionStrikeCuterPure1", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
       RowBox[{"SABROptionStrikeCuterPure1", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"SABROptionStrikeCuterPure1", "[", 
         RowBox[{
         "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
          ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
     SuperscriptBox["kshift", "2"]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, 3.391488334137123*^9, {3.391849074336541*^9, 
   3.3918490747740493`*^9}, {3.391849174182208*^9, 3.3918491790416765`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRDensity5", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"kshift", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionStrikeCuterPure2", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
       RowBox[{"SABROptionStrikeCuterPure2", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", 
         RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"SABROptionStrikeCuterPure2", "[", 
         RowBox[{
         "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
          ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
     SuperscriptBox["kshift", "2"]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, 3.391488334137123*^9, {3.391849074336541*^9, 
   3.3918490843992343`*^9}, {3.3918491847292857`*^9, 3.3918492015733585`*^9}}],\


Cell[BoxData[
 RowBox[{
  RowBox[{"SABRTheta1", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Tshift", "=", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionHaganPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "+", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
       RowBox[{"SABROptionHaganPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "-", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", "Tshift"}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, {3.391488116711074*^9, 3.3914881429928284`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRTheta2", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Tshift", "=", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABRVolDirectPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "+", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
       RowBox[{"SABRVolDirectPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "-", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", "Tshift"}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, {3.391488116711074*^9, 3.3914881429928284`*^9}, {
   3.391849223823786*^9, 3.3918492439960485`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRTheta3", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Tshift", "=", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionAnalyticPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "+", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
       RowBox[{"SABROptionAnalyticPure", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "-", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", "Tshift"}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, {3.391488116711074*^9, 3.3914881429928284`*^9}, {
   3.391849226620715*^9, 3.3918492522462068`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRTheta4", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Tshift", "=", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionStrikeCuterPure1", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "+", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
       RowBox[{"SABROptionStrikeCuterPure1", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "-", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", "Tshift"}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, {3.391488116711074*^9, 3.3914881429928284`*^9}, {
   3.391849229105138*^9, 3.3918492297457747`*^9}, {3.3918492608401217`*^9, 
   3.391849263090165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRTheta5", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Tshift", "=", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SABROptionStrikeCuterPure2", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "+", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
       RowBox[{"SABROptionStrikeCuterPure2", "[", 
        RowBox[{
        "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
         ",", "k", ",", 
         RowBox[{"T", "-", 
          RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", "Tshift"}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, {3.3914879253167744`*^9, 
   3.3914879930993257`*^9}, {3.391488116711074*^9, 3.3914881429928284`*^9}, {
   3.391849233089589*^9, 3.3918492335114717`*^9}, {3.39184927168408*^9, 
   3.391849274121627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DupireVolSABR1", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Calendar", ",", "cspread2", ",", 
      RowBox[{"Tshift", "=", "0.001"}], ",", 
      RowBox[{"kshift", "=", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Calendar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionHaganPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "+", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
         RowBox[{"SABROptionHaganPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "-", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", 
       "Tshift"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cspread2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionHaganPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
         RowBox[{"SABROptionHaganPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"SABROptionHaganPure", "[", 
           RowBox[{
           "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
            ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
       SuperscriptBox["kshift", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"2", 
      FractionBox["Calendar", 
       RowBox[{
        SuperscriptBox["k", "2"], "cspread2"}]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, {
   3.391487817533455*^9, 3.3914878427839394`*^9}, 3.391488381934916*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DupireVolSABR2", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Calendar", ",", "cspread2", ",", 
      RowBox[{"Tshift", "=", "0.001"}], ",", 
      RowBox[{"kshift", "=", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Calendar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionDirectPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "+", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
         RowBox[{"SABROptionDirectPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "-", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", 
       "Tshift"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cspread2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionDirectPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
         RowBox[{"SABROptionDirectPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"SABROptionDirectPure", "[", 
           RowBox[{
           "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
            ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
       SuperscriptBox["kshift", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"2", 
      FractionBox["Calendar", 
       RowBox[{
        SuperscriptBox["k", "2"], "cspread2"}]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, {3.39148512088793*^9, 
   3.3914851379820085`*^9}, 3.3914852082489824`*^9, 3.391485310329067*^9, 
   3.39148837796609*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DupireVolSABR3", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Calendar", ",", "cspread2", ",", 
      RowBox[{"Tshift", "=", "0.001"}], ",", 
      RowBox[{"kshift", "=", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Calendar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionAnalyticPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "+", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
         RowBox[{"SABROptionAnalyticPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "-", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", 
       "Tshift"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cspread2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionAnalyticPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
         RowBox[{"SABROptionAnalyticPure", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"SABROptionAnalyticPure", "[", 
           RowBox[{
           "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
            ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
       SuperscriptBox["kshift", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"2", 
      FractionBox["Calendar", 
       RowBox[{
        SuperscriptBox["k", "2"], "cspread2"}]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, 3.3914852243274164`*^9, 
   3.3914852735627365`*^9, {3.3914882642920322`*^9, 3.391488276120384*^9}, {
   3.3914883137773576`*^9, 3.3914883187462025`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DupireVolSABR4", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Calendar", ",", "cspread2", ",", 
      RowBox[{"Tshift", "=", "0.001"}], ",", 
      RowBox[{"kshift", "=", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Calendar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionStrikeCuterPure1", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "+", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
         RowBox[{"SABROptionStrikeCuterPure1", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "-", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", 
       "Tshift"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cspread2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionStrikeCuterPure1", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
         RowBox[{"SABROptionStrikeCuterPure1", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"SABROptionStrikeCuterPure1", "[", 
           RowBox[{
           "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
            ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
       SuperscriptBox["kshift", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"2", 
      FractionBox["Calendar", 
       RowBox[{
        SuperscriptBox["k", "2"], "cspread2"}]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, 3.3914852243274164`*^9, 
   3.3914852735627365`*^9, {3.3914882642920322`*^9, 3.391488276120384*^9}, {
   3.3914883137773576`*^9, 3.3914883187462025`*^9}, {3.391847596089409*^9, 
   3.3918476246524577`*^9}, {3.3918489348338623`*^9, 3.391848943662157*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DupireVolSABR5", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
    "\[Rho]_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Calendar", ",", "cspread2", ",", 
      RowBox[{"Tshift", "=", "0.001"}], ",", 
      RowBox[{"kshift", "=", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"S", ",", "k"}], "]"}], "/", "100"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Calendar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionStrikeCuterPure2", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "+", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}], "-", 
         RowBox[{"SABROptionStrikeCuterPure2", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", "k", ",", 
           RowBox[{"T", "-", 
            RowBox[{"Tshift", "/", "2"}]}]}], "]"}]}], ")"}], "/", 
       "Tshift"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cspread2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SABROptionStrikeCuterPure2", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "+", "kshift"}], ",", "T"}], "]"}], "+", 
         RowBox[{"SABROptionStrikeCuterPure2", "[", 
          RowBox[{
          "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
           ",", 
           RowBox[{"k", "-", "kshift"}], ",", "T"}], "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"SABROptionStrikeCuterPure2", "[", 
           RowBox[{
           "S", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", ",", "\[Nu]", 
            ",", "k", ",", "T"}], "]"}]}]}], ")"}], "/", 
       SuperscriptBox["kshift", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"2", 
      FractionBox["Calendar", 
       RowBox[{
        SuperscriptBox["k", "2"], "cspread2"}]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39142601443753*^9, 3.391426065422884*^9}, {
   3.391427131865234*^9, 3.3914271957883368`*^9}, {3.3914272576801496`*^9, 
   3.391427332619088*^9}, {3.3914274638872337`*^9, 3.3914274660122747`*^9}, {
   3.3914275852801895`*^9, 3.391427643937566*^9}, {3.3914292332649555`*^9, 
   3.39142923378059*^9}, {3.391429302485034*^9, 3.391429303094421*^9}, {
   3.391429717805508*^9, 3.39142975982194*^9}, {3.3914298060884533`*^9, 
   3.3914301323134665`*^9}, 3.3914301708610816`*^9, {3.3914306714488177`*^9, 
   3.391430671917577*^9}, {3.391430772450757*^9, 3.391430929188141*^9}, {
   3.391431032190119*^9, 3.3914310467060223`*^9}, 3.3914311096291056`*^9, {
   3.3914312383190765`*^9, 3.3914313114142303`*^9}, 3.3914852243274164`*^9, 
   3.3914852735627365`*^9, {3.3914882642920322`*^9, 3.391488276120384*^9}, {
   3.3914883137773576`*^9, 3.3914883187462025`*^9}, {3.391847596089409*^9, 
   3.3918476246524577`*^9}, {3.3918489301931486`*^9, 3.391848954865497*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"K", "=", "0.04"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.11"}], ",", 
     RowBox[{"\[Beta]", "=", "0.7"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.5"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.2"}]}], "}"}], ",", 
   RowBox[{"DupireVolSABR3", "[", 
    RowBox[{
    "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", 
     ",", "\[Nu]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, {
   3.3914291729825478`*^9, 3.3914292011080875`*^9}, 3.39143015281386*^9, {
   3.3914309455947065`*^9, 3.391430946063465*^9}}],

Cell[BoxData["0.09707708835746294`"], "Output",
 CellChangeTimes->{
  3.3914292035456343`*^9, 3.3914292602029724`*^9, 3.3914293235948143`*^9, {
   3.3914301500169315`*^9, 3.3914301539232564`*^9}, 3.39143019553343*^9, 
   3.391430947500993*^9, 3.3914310499248343`*^9, {3.391431294570156*^9, 
   3.3914313134611444`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SuperscriptBox["0.05", "0.3"]], "Input",
 CellChangeTimes->{{3.391487286585761*^9, 3.391487306633021*^9}}],

Cell[BoxData["0.4070905315369044`"], "Output",
 CellChangeTimes->{{3.3914872917264843`*^9, 3.3914873073205338`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.05"}], ",", 
     RowBox[{"\[Beta]", "=", "0.6"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"SABRTheta5", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.001", ",", "0.02"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, 
   3.3914291729825478`*^9, 3.391429348751548*^9, 3.3914302249871206`*^9, {
   3.39143106037816*^9, 3.391431060784418*^9}, {3.391431598560368*^9, 
   3.391431615216938*^9}, {3.3914851595449224`*^9, 3.3914851601230583`*^9}, {
   3.3914852470622272`*^9, 3.391485247171605*^9}, {3.391486711324716*^9, 
   3.3914867611537976`*^9}, {3.3914868066390457`*^9, 3.391486924297555*^9}, {
   3.391486958141955*^9, 3.3914870287995615`*^9}, {3.391487176036763*^9, 
   3.3914872677260237`*^9}, {3.39148731235188*^9, 3.3914874075568333`*^9}, {
   3.391487457745297*^9, 3.3914875096994195`*^9}, {3.3914875479345284`*^9, 
   3.391487618920266*^9}, {3.391487668749348*^9, 3.3914876786245375`*^9}, {
   3.3914878574873466`*^9, 3.3914878576748505`*^9}, {3.391488019521708*^9, 
   3.391488084335452*^9}, {3.391488161665062*^9, 3.391488171368373*^9}, {
   3.391849363857725*^9, 3.3918493981708837`*^9}, {3.391849500219718*^9, 
   3.3918495007197275`*^9}, {3.3918509337784915`*^9, 3.391850954232009*^9}, {
   3.3918510467962866`*^9, 3.391851058843393*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
llUS/lQGIqUCm9rRrfbnZ/x/VYfaMA==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.005, 0},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.391488162790084*^9, 3.391488172290266*^9}, {
  3.3918493669046583`*^9, 3.3918493998896666`*^9}, {3.391850937966072*^9, 
  3.3918509547476444`*^9}, {3.3918510392180157`*^9, 3.3918510595309057`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.05"}], ",", 
     RowBox[{"\[Beta]", "=", "0.6"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"SABRDensity4", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.001", ",", "0.02"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, 
   3.3914291729825478`*^9, 3.391429348751548*^9, 3.3914302249871206`*^9, {
   3.39143106037816*^9, 3.391431060784418*^9}, {3.391431598560368*^9, 
   3.391431615216938*^9}, {3.3914851595449224`*^9, 3.3914851601230583`*^9}, {
   3.3914852470622272`*^9, 3.391485247171605*^9}, {3.391486711324716*^9, 
   3.3914867611537976`*^9}, {3.3914868066390457`*^9, 3.391486924297555*^9}, {
   3.391486958141955*^9, 3.3914870287995615`*^9}, {3.391487176036763*^9, 
   3.3914872677260237`*^9}, {3.39148731235188*^9, 3.3914874075568333`*^9}, {
   3.391487457745297*^9, 3.3914875096994195`*^9}, {3.3914875479345284`*^9, 
   3.391487618920266*^9}, {3.391487668749348*^9, 3.3914876786245375`*^9}, {
   3.3914878574873466`*^9, 3.3914878576748505`*^9}, {3.391488019521708*^9, 
   3.391488084335452*^9}, {3.391488181977952*^9, 3.3914882171192513`*^9}, {
   3.3918493015127773`*^9, 3.3918493420916815`*^9}, {3.391850657976321*^9, 
   3.391850672960984*^9}, {3.3918509061685867`*^9, 3.3918509245126886`*^9}, {
   3.3918510940784445`*^9, 3.391851120469576*^9}, {3.391851451725936*^9, 
   3.3918514521634445`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV13k8VU8UAHAkyRIpqqfsyi7iJuFMCyFZKlG2siek+NnKnn179z4hVLRI
GylJqVAqCiFJIkulQkVpU/E7/nqf72fm3XtnzpmZM7Ku+7d68HBxcRlyc3HN
/I5EJxpaulpDwmCXl5U4ixjFsnVqwq2hKoi/64Yki7Djjqmu5FhDT47bPxk5
FtFJuLhErN4a8s6Yen3XYJHI1KffnyvaQKm29PViUxYRy15U6vTRBhbf36So
ephF9C+ek/IL2AasjicVt96wSNLzR9OpkTuAtPJt+lIhSXTKWyWcpJygdoVC
2Ou4ZcQxnytnqHgPOHId2mwI0sRI/eAriTJ34A23kvgQIUPO8Zg+Fv3tBc8a
oAKCZMnfS1prugX2geuloo4KZznyMi9qq5+zP/TsLuLesUeejOzbttWgLQCC
t735udtNgfRNBFQr2x2Evi2rpW3sFEnOydrff/4Fgm2pmV+n63LyQIf163rS
f6Bl9jdz0HkFiT3QL3ZJMAQWSOaYn7BTIrNau3gSy0JBs223d7WnMplc/Oqq
2epwOKg+VGPsrkKux4nojfcdgsbWvkG+EFXClX3lZUd0BNjYramdiFMjdYzD
2sLZUXDCfGTPngh1ctp+6ZoS22jgd8yAkmQNItubqRPEigGyDgcbo0liDhbk
Xf0SA9ZFfJ86N64k5x365onUxULu1IZ48/qVREh/hZvLkTgg5ySe3tTTItbK
/HJy9keg06UtbfCaFnkq/Lm2a1k8uPJmXj0pr00kTAT8L/fFg6X/mprH6doE
MmviJ8oTYDuXK0/HX21yujksQjM4ERoe0VvX7l5FPi5t7usxT4Lr/30am/Vo
FflZs8O6RDIZXuf3BNHLdQixf1fo9ToZyjpq00+E65B93MKOx8pT4K64TOeX
pzqk7eSan3eDU+GJ0uS8l0t0yTRdUMijlwbxG3ZKVDrqEpGjuRVVc9OBHeSy
59EJXbIr/ViJa3M6mMT1lyh26pLE7FVzoooyILPq8FpFQYp8yWo3zvTKBF2f
xJdvdSmiNzx7OscnE7Y32rtEURSJhjVVhX6ZsGhqZdSS1RQRGz6pcjUwE9gV
a9Mt9CiiA34iz6Ow/5Gagcv6FAn/OOclKzcTuPX6PZ2AInxGhr7FDZkwEVBT
vd+UIpnftjW+XsgGnhUP/HfvpMiO1nsCRyTYUKMWsHoUvfSyloXyYjaoRF9M
CNlFkRJPkaeBkmzoKmqrSnOgSO3Lxx38cmwYbqrZV+5Eka816/q1NdmgbVvE
93YPRbanaf5MMGPDWc7mz5/2UoS194Se2mY25kdVtI8PRfqNhcPbLNiwZE1/
7hDad3r4r6Q1G3IvHHTo3UeR+IPFPOU72GB0M33FAz+KVNovm/fKjQ0K7S+6
Ig5QZLGioKJmJBuSJNtiOKEUaRDUt6yKYkO7mmjCb3TYV++QdTFs6L54Xcol
jCLdNQ8btx1hw+N0w/nK4RQ5vivWPzQFx18SM3HjEEXk2L9v1GWzYXv6sut1
kRRR/fPefHsZG5T/eQnGH6FIz4BEUO8VNtSf6b/Wi05rMD7ueZUNZm9+jenG
U+Tz0dNfQq/j+4aaVN6hr6x0yTpejfM3fD7XKBHj49nZO/SIDZXxka69yRQx
aqsPCOtnQ2HBo/zHGRQRHW6IlB9kw8nS9hVLMynyhqc5rfkNG/5ZPdPxQyfp
PC+Rfc8GkW7vF8JsirTlvOtv/MSGbZ1WumY0Rdyd+WxYf9igU51qU8KhCBUi
4FL/lw2Mwb6pcfRc9jw//yk2nL76Qm1tFkVK6ySS73HT0Cj9S6QJ/VNhRZ0P
Pw1ifue/vD9KkZSRTVrV4jT8ONYlzJ9LEUdeC/BYRIOI3b5uM7TmMustIkto
2P2vSikV3WFpv9dtKQ2+hxdbCB2jyLKr3kWC8jQ4bfp5nj8P5yM0eb7jShoU
GvfUf8ynyPPZT8b/mtNwuK/+4JaTFLFMHVl70oKGr2/lciLRDaJCCessaWh/
u9SoDH1bcgsrwYaG9S/zl4sUUuSM1tP1IvY01Kx02NiIDnJ6xpH1oCFytLF6
+SmMx+C33vueNJSu2rnJGu3tvVDJ05sGT5ePdmFox0Db2xf20XD0TPSCx+gN
yS/erjpIw+WYRS88TuP6uv5K1ySKhoe1jTkJZzDe+n+jPkTTEPzuVWYJmq92
6eOUWBp2jcaIPkZPPnZyfhpPg8Y7xwLBsxQZ7O9LsE+jwdk1lz8Z7ejJ1TaZ
TsNgpbr6OXTniIzk8UwaKgfKhurRj3/sKRtgaMhsau2ZQpcLvX3hc4wG+c13
Vf2KKaLC8MoJ59MQ4dSYnIg+s0jRt6yAhl/7U/8rQufKeXJNnMTvd9Vre4aO
1vugFFFMg/pZw1Htc/h9d/gDpUtouNcdTZuhgzYo36k7T8PtZwlXXNDelj42
fJdxfM6lUSloa/fRsMxrNIQ/iPLvRld8a7oofh3jIZ7NP4peEne5N7+ShlVq
pzX+oQeL/NeV3KThSsvQLqkSigT2jfHX1dBg6Zfp5oDu8m/T31RHw05frey9
aIOpct/mezRwSfrGhKB5lwW2vnxAQ72ytxGDzt71PefrExoOXeCi7qEnPz5v
DG2mQc51m1oz2iWs8s9UCw3K4jppL9BKuSEugu00mLfVJ4yg01bY0/QzGp57
KQ9PoMcq9e4vek7DTbV21Sn0zee/lyt0Yb7Lv5afd54iUh7d9hde0hC7Q2Sh
BDp24lbKylc0cF8My12GHorLv13ZQ4NbfqifAtp8weHPBq9pSPV13KeCLj3l
KHO/jwarP+OHtdALtA23mg3Q0MV/6CKFDq1bduTpIA3Wd99vMED3WE9dt32L
8dhmeJGgSf/r96/e4fgd1+7eiD67v2aJ63savDU42mZogemTmz98oKEpzZi9
Be2fER3hP0zDxtHAOTbo9mV7yiZGaMjY8StxK5q6vG4g/BMNKh1bOrej8wzk
FnB/oaH5t06qPXr6CY9x4hgNUsrVQTN2d3gTLPyVBtWt4+xd6Ibh+yWcbzRc
PZn0fidaLfxM95LvNLyLu6c2086eGy9U+IOGujyeaQf0RK6H0fJfNEhYekXP
tO9UMgm49BvzaXAj3w703RvLT2n/oaF381LTbWi5TXM6qv7S8MFD/d+MEzrf
z4YpGvrWplzZgB7xaFj9YBrzd88fB2e09feSvZu5Gbi1xJvMtFccSc5v42Gg
KmTVAjX04oU+zXa8DBy6X1pljo44bT7dO5sBoYyNwonoQW1VLfc5DAxNHG2Z
iZfJPUG3YX4GXG9IdPzA9XLBZjQrQICB+92tv1+XUURkoOnhD0EGMmr4P36/
jusl4PKvw8IMGM05vsK3gZCu6XSVWSIMsF71bLmM+5lBpr9jsigDfAcFn+3F
/aBQyipDRIyBVNbk02J8H2+pZu3RBQzM8rIobcL822so+lVSnIHyK5ccTLF9
bOoB/30JBr4NGD4RRAfXHpL2WczAkp18c75i/78xWtR8FnpyrtyMYze8t6iS
ZIAZF/zXgeaffdzNZRkDy590rmhHZzzcGs4nzcCc7LMZt9ALk/jpyzIM5Gsu
Ma1A55ndPbddjgH5a9ljF9AygkF3/8gz8MxdbyAXXdyk/PyUIgP8PvzVGehr
Vkd5xpUY2OEqVBGAbrL1dUrXZMBBMmdUC711kVyQjhYD8zS+zJWdWe9dL1Je
aTMQkL9CQgT91mFDlTLFgPj9+NvDuF/828Na8NCAAXCxcspHH5FvVfYzYsBk
aDI9AS3wLp4sJAyISf90OoCW8B73c93AwIm/90WN0Rr+DQ1TZgzYX673GcL4
VWhG9p3dzMBdVdmLzWj98VU/LLYwUMa5qlqBNgk6KZ9vjf11v82KRruEB0eu
tmNAyXCHrxianaCgE+DOgL77mSAZ3H8lTLvNF3ky8HFSVogbXTCXveeuFwPh
Htuq+zC+59P+ZAjtY8A2TeFLHvoe0/6x5AADGmUa6SJo0+1JXNaBDCSsPTv5
Cc+TFnGjRT+DGPgxuuDhI3R37vmNxqEM5G3P8wtGfzsRfXIgkoG0zdH+/Xge
ufv8OO4bzcDYHZvlD9Edur4FP2MYaKh3dbiGNuYezIuNY0BNqrwtEV3ZZHdM
OJ6BhwNbuG3Qy3Obc3ITGFiqz9kZgM5x25Atn8RAx7tndupofs2bWaXJDMg5
jilq4/tDJzU4a1IZeJK4XLYa/eHBGbo+jYFf2gtf5eL5vZNmsa0yGJBQ71SS
SsXzypGd0Z2J37+t/meu61yir8SX7kEzoBzRWORmuJpc+HYodYzB/n0u/9Zl
U0SyZjz5UBYDgbJVuy/NnKcpXkl82QxsnIjJbC3C/LbtTaBzGHCTCXtzE89z
X9lt8UuPMSCqZttigO4dbYg7l4fxKC/8aYK2rDKK1S5gwODqV/EqrA/uxlVE
3znOwOsXDlePojWtVKJMT+L3nFp+KgpdyCqMeFaI+TRlIm6NFh0SP+x8ioHS
P3deiqFjylPDP55mYIPywoLRE3i+C+v7r7vCgBR7zSHv47geu8p8m8pxfiXu
+eqi359W3Gd3jQHr8d4ebnSD/nxvv0oGPq0OP1BQQJFU7w97jt3G9XzRXa4B
9wfR+mzb8QYGmo/vfS6M88k69M2gaICBLlVj/804P9rX4kMU3uB82aQnCaHN
RxZdPfcW4//EK7EZ67FDDgYrSt8zkHI65KElumdt/PzqTwzESk5tscD6bSJw
kYXRFwacdzppC6KFLp1PqBtjoKlK0rcB6z+DpS1/Hn1j4EwOI7URffyvxFDH
b9y/hHjv6TKYPzrnZez/YP662M36hPVki+9ah1d/cT2LS9lfQE/1uLQOTDPw
rqJQWg4tIf5VwIObA8XmnvIvsR7V2HLE+AMPBwKit+zNRZvES0Tv4+VAxf7f
DSZo5zsltz7P5kDuaGfVInTwd/3vB+Zw4FKApOwDrG8z1Js1v/NzIENFoTYC
Xezh4hMqwIGWuHWiX7A+rjk+fuaPIAdCdt9d9x3d9TyuL1KYA+5lHfpW2H9M
WILFI8KB2zeOlWtiO79JyfZ4UQ50WvFcn+kvE6mfyS/GgcL+uLeRtni/qmxq
TF3AgUCxC3GnllgQ68/OvCLiHHghULKtEOPpvXzciJHgQMqNXf9p43ijnePC
xBdzgK9fYPWTNKy3ssUrcpdw4K7I/oo89JWWc58lJTlgwdcROB89YNTkJifF
geFx1Y9uuF4mg51PnJXmgIqWhjAPWqxsrEtJlgM694TiH6dQZL20uKWmAgf8
30UpSKJPTTvpGahwQEk+Jfx1EkVurR47WKPKAS4H89ZUdPv+2Mvr1TngKLHf
xwA9q79YzmwlB9SyW8py8b7hXvtFaAfFAdYAF8s8gSKKMTED+9dzYKuhjNiJ
OIzHyAeuhRs5kLyCFQzoXFtrmSpjDkTk+Vr0x2L+qEi7cJlxgN/y8H0Z9ET7
7R62FQc6Xgd35kdTpF7h14tyRw4YPhhcdTiCIm4N/i3fgjmQ5G95fiiYIkUi
jtUhFzkgrDM65eZNkYdxcfemL3FAqHFh55gXRYZ/XmhMLOVAf5O6RQRau//3
i5xyDpT06Akf9cTnX8mZuHGDA2OXYiZq3HE/snmm/us+By56fLGZhfdLjSzz
wtAeDuitF44jeF+9tXhNfJhwFrxhHnPl4P2Wq0b3gJxIFox4jNROb8J89NB2
eiKaBZ67caGi28tVdZctzAKbu3EOq02w3jCXelfLyoIjeUtLWjfg/TdiljG/
Uhb8yOxR+mxEkaiBZt6c9VmwcrOa4nMdimy84HqkIiQLjBr0tXdIUyRE23Z1
HZp3dG63NfrCrU3DzeiqOOeYzWjRJ2rW79EmGWtbCbp35IckKzQL9MlTX1V0
sHrqtSh06/zFRVzokivXBs3DsqB/59afF6Qo8kqv+KgdOoT7Zf5Z9Ly6XFN3
dMGaFihEB7VFlEagJ90sk46i133dFH4Fveqv6+JodPeqnvkS4VlQ8mOOji1a
+HZLvRw6VF/mhRWabKwL0UTPrykIM0cXby/uNUXXTmrWADrwv4Dzh9DHbt8x
VZlp/+fqmIRW8lMbUZh5frytyFH0Tj6udOmZ52Xr/1eKniLb2xbO/F9KXaka
3f777UGRmf8XS796hE60zlgogH6pIZbRgX72WriSFy10gxcL2CwQ6Ay2m15G
kf8BxpDrlA==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.005, 10.},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.3914880226311426`*^9, 3.3914880869136267`*^9}, {
   3.3914881856186466`*^9, 3.391488221603713*^9}, 3.3914882875268536`*^9, 
   3.3914883406997495`*^9, {3.3918492946532707`*^9, 3.3918493450761137`*^9}, {
   3.3918506641326895`*^9, 3.3918506735234947`*^9}, {3.391850907043603*^9, 
   3.391850925309579*^9}, {3.391851104281765*^9, 3.3918511210008364`*^9}, 
   3.391851453866602*^9, 3.391851566321886*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.05"}], ",", 
     RowBox[{"\[Beta]", "=", "0.6"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DupireVolSABR1", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", 
       RowBox[{"35", "\[Alpha]", " ", 
        SuperscriptBox["S", 
         RowBox[{"\[Beta]", "/", "2"}]], " ", "\[Nu]", 
        SqrtBox["T"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, 
   3.3914291729825478`*^9, 3.391429348751548*^9, 3.3914302249871206`*^9, {
   3.39143106037816*^9, 3.391431060784418*^9}, {3.391431598560368*^9, 
   3.391431615216938*^9}, {3.3914851595449224`*^9, 3.3914851601230583`*^9}, {
   3.3914852470622272`*^9, 3.391485247171605*^9}, {3.391486711324716*^9, 
   3.3914867611537976`*^9}, {3.3914868066390457`*^9, 3.391486924297555*^9}, {
   3.391486958141955*^9, 3.3914870287995615`*^9}, {3.391487176036763*^9, 
   3.3914872677260237`*^9}, {3.39148731235188*^9, 3.3914874075568333`*^9}, {
   3.391487457745297*^9, 3.3914875096994195`*^9}, {3.3914875479345284`*^9, 
   3.391487618920266*^9}, {3.391487668749348*^9, 3.3914876786245375`*^9}, {
   3.3914878574873466`*^9, 3.3914878576748505`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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

      "]], LineBox[CompressedData["
1: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
      "]]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.05, 0.04},
  PlotRange->{{0.02, 0.2137225290568748}, {0.026087303699797133`, 
   0.17162707949670955`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.391487859346758*^9, 3.3914883897006903`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.05"}], ",", 
     RowBox[{"\[Beta]", "=", "0.6"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DupireVolSABR2", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.02", ",", 
       RowBox[{"35", "\[Alpha]", " ", 
        SuperscriptBox["S", 
         RowBox[{"\[Beta]", "/", "2"}]], " ", "\[Nu]", 
        SqrtBox["T"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, 
   3.3914291729825478`*^9, 3.391429348751548*^9, 3.3914302249871206`*^9, {
   3.39143106037816*^9, 3.391431060784418*^9}, {3.391431598560368*^9, 
   3.391431615216938*^9}, {3.3914851595449224`*^9, 3.3914851601230583`*^9}, {
   3.3914852470622272`*^9, 3.391485247171605*^9}, {3.391486711324716*^9, 
   3.3914867611537976`*^9}, {3.3914868066390457`*^9, 3.391486924297555*^9}, {
   3.391486958141955*^9, 3.3914870287995615`*^9}, {3.391487176036763*^9, 
   3.3914872677260237`*^9}, {3.39148731235188*^9, 3.3914874075568333`*^9}, {
   3.391487457745297*^9, 3.3914875096994195`*^9}, {3.3914875479345284`*^9, 
   3.391487618920266*^9}, {3.391487668749348*^9, 3.3914876786245375`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
HuE=
      "]], LineBox[CompressedData["
1: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

      "]]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.05, 0.04},
  PlotRange->{{0.02, 0.2137225290568748}, {0.02608445788983448, 
   0.1682426216511203}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.391485165623164*^9, 3.3914852145303535`*^9, 3.391485256921792*^9, 
   3.3914853199698772`*^9, {3.3914867243562164`*^9, 3.391486762372571*^9}, {
   3.3914868079046955`*^9, 3.3914868435772552`*^9}, {3.3914868773591537`*^9, 
   3.3914869294851546`*^9}, {3.3914869733453712`*^9, 3.391487030065211*^9}, {
   3.391487186990099*^9, 3.3914872408661327`*^9}, {3.3914873148206778`*^9, 
   3.3914874096974993`*^9}, {3.391487462651641*^9, 3.391487512996358*^9}, {
   3.3914875556378016`*^9, 3.391487620092164*^9}, {3.3914876698743696`*^9, 
   3.391487681374591*^9}, 3.3914883939195213`*^9, 3.3918476406683903`*^9}]
}, Open  ]],

Cell[BoxData["DupireVolSABR3"], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.05"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DupireVolSABR3", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.01", ",", 
       RowBox[{"35", "\[Alpha]", "  ", 
        SuperscriptBox["S", 
         RowBox[{"\[Beta]", "/", "2"}]], " ", "\[Nu]", 
        SqrtBox["T"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, 
   3.3914291729825478`*^9, 3.391429348751548*^9, 3.3914302249871206`*^9, {
   3.39143106037816*^9, 3.391431060784418*^9}, {3.391431598560368*^9, 
   3.391431615216938*^9}, {3.3914851595449224`*^9, 3.3914851601230583`*^9}, {
   3.3914852470622272`*^9, 3.391485247171605*^9}, {3.391486711324716*^9, 
   3.3914867611537976`*^9}, {3.3914868066390457`*^9, 3.391486924297555*^9}, {
   3.391486958141955*^9, 3.3914870287995615`*^9}, {3.3914870759879675`*^9, 
   3.3914871200981894`*^9}, {3.391487635295581*^9, 3.391487682343359*^9}, {
   3.3914924725447044`*^9, 3.391492664548391*^9}, {3.3914926965490055`*^9, 
   3.391492713158699*^9}, {3.3918513223328266`*^9, 3.3918513450676384`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwVx3k0FAgAx3GV19Ja6RAmeuXYSmVssqYcvxzpPUUlOxmRylVqE6UDHY6G
J5bCYFxzmTFmCI3JFcYg5m2uhnKFzapNqbDlaGpn//i+7/tsOh3iHrBURUWF
rOz/z8TESqrlNEw7N0k2qsvwoIv79u40DVMUJ8re9nbcPjqkWL83E7+nVO+I
2twOQ8p+Y5vBTIQkedncn32CQH+D0KhV2bgU9GLbuKwF6nLtdbeMs/EPsfpP
iqAFQkfN2mirbJj1rWeuSmrBJ8PvqvE+2fh0Tmq7z60FUWOjWff42QiIdDYv
7m3G/ROcRq49HbLUv4ZGP0hh2ZEbwPegg7GadM5MLsUL24wVwiA6+s+kRYiq
pDAwoHqUJ9NxdnDXx6AYKYoGg97U9tPxKuONj4+uFA2e27S6Q3NwI8m1VMut
CafbjCqfxeWAPXf3QpFlE1RJ+l59mTl4GDwvumjQBBednziDj3PgdTNJ7d57
Cfp6p6wm1HPxm3V4tGqqBO/cK3wXmbnYc3h9mudwI3Rddz8w6cnDxf6i8CVm
Dag0J3Y1T+TBh0gyS1BtgPtak09+i3lonJGH+g/WI2lQy4JlnA+ptSCIkFgP
leA34g1X8zEy+9QscPIxXlMz63X0C+DLPETrratDXHDyiNi8AJ0Wwa2UrDps
dItVIe8rwL6s2erNl+vgpR3ikH6hAK3jBIf87XXoYDu3akkK0BizkP+KUYvj
owsTqhYMzB/wrHWk1cC0J/yqhy0Danrjq3Wv1GBO+vEHzn4GJtLSPbeTa5DO
m9ji6M1Ant/NS6t1atBxoSc4+g4DsiEqoyWnGg4K/pTiOQMG0jXn3cuqYEqg
fP4cxURcQ0YAc+kj7FiY9aVRmbhBUpeZTIphPpDabpnKRMWv3jnyZ2JY0tty
L7OZKPvRl1RWKMZeAslxup0J6jdRKPmAGMcIOqnv17EQcL5jGSG/EnGE3q3j
ZSyIN173jvQVIX7hYlpsDQtnjWXaNQdFSBzQUBg2szCdkGpO2CNCKt2p69Rz
Fs6wR+/baouQQxBdGVGwsMVv2m/F04eoIKRJB1zYsMrdUJ/g8BAjhCM+3eNs
NMxw4miOFXgpmlTFBzb61nEz3C2UdqMKhfNsaG5bM7zDSOmY2sV4TQ5o88s3
2S9T+q0J3Y7EQffOZF15czle1iz0Ce5ysLJ54FiEq9IeGTf1aBwIuA3fNKH0
FPHneAYHVuZy3wZzpQ0Dwk9XchDmVR0TtrYcw4mda/RGOHinF9KsP1yGIS/O
YerOQky9iblMvqT0rN3cjE0hNEIsklMClf6jv+DU/kK0Fml4j1GUbtL8YONd
CLW2sbMde5U2vZ48c6cQLrK8yPaVZRhccJWd7C8E+WtUi43/AwzQvzha3+Yi
5S151EuzFEfqeNbXErkItV8vq1ooQdvwMYvKdC48BeXvbF6X4NHGKkMin4un
R3qHxY0lSOdeW2LUw4XX18Ws4PASuFbM168w5qG0MyYi928hmp/xxfvNeAiT
OO2xlwth8y+lNI7EA4t89IqaVAhTUk3et4M8tAiXURUMIZbXR0RNh/PgX35n
VdQJIRrbF3cPPOGh8POEPHdEAKtJwS86PTwkBHUGHO4SoFTDe6vHEA/WbN9d
RhIB8g7V6XZ85EFyq1JmwhYgojfqi0SvCLFhZHH2GQEsxhQi/rkiLO90lqyd
LwZ37jvx+ko+Vq1O0CcSi+Gu1q2yXI+P6MCrJ+yMi6HQYXXfN+QjSbPSxV+v
GB5WTpeElnwcdfYrm1lWjKVXEsQjx/mYYSRxDAb4OMm44cZJ4cPEPdIum83H
f2tprT8=
      "]], LineBox[CompressedData["
1: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
MV5F1v8P9MNlag==
      "]]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.05, 0.06},
  PlotRange->{{0.01, 0.24825717236333364`}, {0.04372080941132985, 
   0.20340356312640712`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.3914871233795023`*^9, {3.3914876552959647`*^9, 3.391487688999737*^9}, 
   3.3914883987164884`*^9, {3.391492483732419*^9, 3.391492666595305*^9}, {
   3.391492699205306*^9, 3.3914927150181093`*^9}, 3.391770661439953*^9, {
   3.3918513403956738`*^9, 3.391851348083321*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"35", "\[Alpha]", " ", 
  SuperscriptBox["S", 
   RowBox[{"\[Beta]", "/", "2"}]], " ", "\[Nu]", 
  SqrtBox["T"]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.05"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DupireVolSABR4", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.01", ",", 
       RowBox[{"35", "\[Alpha]", "  ", 
        SuperscriptBox["S", 
         RowBox[{"\[Beta]", "/", "2"}]], " ", "\[Nu]", 
        SqrtBox["T"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, 
   3.3914291729825478`*^9, 3.391429348751548*^9, 3.3914302249871206`*^9, {
   3.39143106037816*^9, 3.391431060784418*^9}, {3.391431598560368*^9, 
   3.391431615216938*^9}, {3.3914851595449224`*^9, 3.3914851601230583`*^9}, {
   3.3914852470622272`*^9, 3.391485247171605*^9}, {3.391486711324716*^9, 
   3.3914867611537976`*^9}, {3.3914868066390457`*^9, 3.391486924297555*^9}, {
   3.391486958141955*^9, 3.3914870287995615`*^9}, {3.391487176036763*^9, 
   3.3914872677260237`*^9}, {3.39148731235188*^9, 3.3914874075568333`*^9}, {
   3.391487457745297*^9, 3.3914875096994195`*^9}, {3.3914875479345284`*^9, 
   3.391487618920266*^9}, {3.391487668749348*^9, 3.3914876786245375`*^9}, {
   3.3918476562624397`*^9, 3.391847657184332*^9}, {3.3918477730303063`*^9, 
   3.3918478257188177`*^9}, {3.391848234757921*^9, 3.3918482351798043`*^9}, {
   3.391848581295825*^9, 3.391848602858739*^9}, {3.391848856160477*^9, 
   3.3918488565823603`*^9}, {3.3918489691938972`*^9, 3.391848975428392*^9}, {
   3.3918510755937147`*^9, 3.3918510759218454`*^9}, {3.391851370490001*^9, 
   3.3918513846621485`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {Hue[0.67, 0.6, 0.6], 
     LineBox[{{0.03747414024065886, 0.24666840771258056`}, {
      0.037680469869476055`, 0.24477846872066994`}, {0.038855116502011226`, 
      0.23478205398333973`}, {0.038934678412127374`, 0.2341394143758865}, {
      0.03901424032224353, 0.2335009422974865}, {0.03917336414247584, 
      0.23223636278807877`}, {0.03949161178294046, 0.2297557164805109}, {
      0.0401281070638697, 0.22498119114893986`}, {0.04140109762572816, 
      0.21612515263112256`}, {0.041480659535844316`, 0.21560034310546894`}, {
      0.04156022144596047, 0.21507875143518987`}, {0.04171934526619278, 
      0.2140451215333115}, {0.0420375929066574, 0.21201538804292944`}, {
      0.04267408818758663, 0.20810072064199933`}, {0.043947078749445104`, 
      0.2008110305800373}, {0.044025189668780336`, 0.20038573235942705`}, {
      0.04410330058811557, 0.19996286574268304`}, {0.04425952242678604, 
      0.19912435722684182`}, {0.044571966104126975`, 0.1974757569417851}, {
      0.04519685345880884, 0.1942884927001608}, {0.04644662816817258, 
      0.1883257547359}, {0.04652473908750781, 0.1879702766452327}, {
      0.04660285000684304, 0.18761673822379188`}, {0.04675907184551351, 
      0.186915427391971}, {0.04707151552285445, 0.18553550484211856`}, {
      0.04769640287753631, 0.18286362739684964`}, {0.04894617758690005, 
      0.1778504738510803}, {0.04901903877227255, 0.1775710742920715}, {
      0.04909189995764505, 0.17729303717106545`}, {0.049237622328390046`, 
      0.17674101720916183`}, {0.04952906706988004, 0.17565296647359016`}, {
      0.04992402513636374, 0.17421171782823086`}}], LineBox[CompressedData["
1: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
5GO8/wNpba42
      "]]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.05, 0.12},
  PlotRange->{{0.01, 0.24825717236333364`}, {0.11138065563351819`, 
   0.24666840771258056`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.3918476600125113`*^9, {3.3918477776553955`*^9, 3.3918478278126082`*^9}, 
   3.391848010706745*^9, {3.3918482267421427`*^9, 3.3918482378829813`*^9}, 
   3.3918484729499946`*^9, {3.391848570998752*^9, 3.391848604858777*^9}, 
   3.3918488574105015`*^9, {3.3918489718501987`*^9, 3.3918489785378265`*^9}, {
   3.391851069906105*^9, 3.391851077406249*^9}, 3.3918513877090816`*^9, 
   3.391851596556842*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "0.05"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"\[Alpha]", "=", "0.05"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}], ",", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"-", "0.01"}]}], ",", 
     RowBox[{"\[Nu]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DupireVolSABR5", "[", 
      RowBox[{
      "S", ",", "K", ",", "T", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]",
        ",", "\[Nu]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0.01", ",", 
       RowBox[{"35", "\[Alpha]", "  ", 
        SuperscriptBox["S", 
         RowBox[{"\[Beta]", "/", "2"}]], " ", "\[Nu]", 
        SqrtBox["T"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391429057527206*^9, 3.391429139450654*^9}, 
   3.3914291729825478`*^9, 3.391429348751548*^9, 3.3914302249871206`*^9, {
   3.39143106037816*^9, 3.391431060784418*^9}, {3.391431598560368*^9, 
   3.391431615216938*^9}, {3.3914851595449224`*^9, 3.3914851601230583`*^9}, {
   3.3914852470622272`*^9, 3.391485247171605*^9}, {3.391486711324716*^9, 
   3.3914867611537976`*^9}, {3.3914868066390457`*^9, 3.391486924297555*^9}, {
   3.391486958141955*^9, 3.3914870287995615`*^9}, {3.391487176036763*^9, 
   3.3914872677260237`*^9}, {3.39148731235188*^9, 3.3914874075568333`*^9}, {
   3.391487457745297*^9, 3.3914875096994195`*^9}, {3.3914875479345284`*^9, 
   3.391487618920266*^9}, {3.391487668749348*^9, 3.3914876786245375`*^9}, {
   3.3918476562624397`*^9, 3.391847657184332*^9}, {3.3918477730303063`*^9, 
   3.3918478257188177`*^9}, {3.391848234757921*^9, 3.3918482351798043`*^9}, {
   3.391848581295825*^9, 3.391848602858739*^9}, {3.391848856160477*^9, 
   3.3918488565823603`*^9}, {3.3918489691938972`*^9, 3.391848975428392*^9}, {
   3.3918510755937147`*^9, 3.3918510759218454`*^9}, {3.391851370490001*^9, 
   3.391851416053376*^9}, {3.3918515087739067`*^9, 3.3918515392588663`*^9}, {
   3.3918516001819115`*^9, 3.391851600681921*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {Hue[0.67, 0.6, 0.6], 
     LineBox[{{0.03993054917806306, 0.1851299705944367}, {0.0401281070638697, 
      0.1814902190933439}, {0.04020766897398585, 0.1801227472186029}, {
      0.04028723088410201, 0.17877559724410463`}, {0.04044635470433432, 
      0.17614057304825947`}, {0.04076460234479893, 0.17109643850262912`}, {
      0.04140109762572816, 0.1618308700144767}, {0.041480659535844316`, 
      0.16074342411425763`}, {0.04156022144596047, 0.15967070596556746`}, {
      0.04171934526619278, 0.1575683538596274}, {0.0420375929066574, 
      0.1535286424125269}, {0.04267408818758663, 0.14605450881298399`}, {
      0.04275365009770278, 0.1451658908834762}, {0.042833212007818935`, 
      0.14430390569612647`}, {0.042992335828051245`, 0.14259424929994624`}, {
      0.043310583468515865`, 0.13914174019254366`}, {0.043947078749445104`, 
      0.13317219766093522`}, {0.044025189668780336`, 0.13245941846580855`}, {
      0.04410330058811557, 0.13175477583331519`}, {0.04425952242678604, 
      0.130369400958641}, {0.044571966104126975`, 0.12769092238704313`}, {
      0.04519685345880884, 0.12267809234689518`}, {0.04527496437814407, 
      0.12208173322316}, {0.04535307529747931, 0.12149177325210424`}, {
      0.045509297136149776`, 0.12033068659156503`}, {0.045821740813490705`, 
      0.118081391024818}, {0.04644662816817258, 0.11385598238850238`}, {
      0.04652473908750781, 0.11335192814742584`}, {0.04660285000684304, 
      0.11285299554724881`}, {0.04675907184551351, 0.11187022393671027`}, {
      0.04707151552285445, 0.10996322072482088`}, {0.04769640287753631, 
      0.1063696188497146}, {0.04894617758690005, 0.09996690084887622}, {
      0.04901903877227255, 0.09962273701359885}, {0.04909189995764505, 
      0.09928155635773211}, {0.049237622328390046`, 0.09860801481851053}, {
      0.04952906706988004, 0.09729532825938274}, {0.04992402513636374, 
      0.09558666741118345}}], LineBox[CompressedData["
1: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
nbTwObETHBxhv7K4LE+hZPHWsxv0uXhzYsa+LFUK+g5/j4YYcpG6YnpcixqF
Qq+sfSlLuHhuYZ4qQu7DnPhHa+tXcLHVOO5k1BxyX3c4TTNw5eKLdTs3U5tC
TOTiWLFoLiLjt/mcXERBSdzHszGOi//W9lm8J/d3yclUkxPH/t//37Ug77hn
19/3y6ZzkX5bTWHchLzbHl/xULvGxSK27tUcC/I9M5ZcbNzIxQ2/LF6EA4Ud
g72vfRR5qPLMFvUj36ORcDm+lgoPz6VtjWdvp3Ba1Crr7Wwett0XNXhMvl/1
qpnrdumQ+J4zUa4BFDRWudQeNOfBzXFMY3cwhc6C6vNpPjysCdj6TjOGvEN9
zq6qvsnDpw7LX9GXyffOsd72LcXD6M0AVGRTOGj0cYUsmwffLCpwKIfCtUlH
Y18BD/bPTtnsLKDwO29EVaqDB5+HbZyEMpK/vu2DXmM8rP4y2mVTT0Fk/+KM
4XVVmL1rG5PRR94Lx1ofmf+swj35geBOKwZ2vkmplhqpQkT2LtMYMKBqtyq3
a7wKPB3Lp9p2DESJ3tl7ZFo1pCfP3ohcxYDFUZ5k8+xqTLO2XWpO3je8uHyb
TbbVuDjEc5bZyQA3Kqrk4MlqPP/VriR6gQFWiM6xin9q0FNfEsP8wYDb5Q3f
vkfUwnzsbB5nFxNP2Uv9NOvrkL9QW8rqNRMDF5aMOHzjI2ul8LmBZwVyuBLr
l1rX45LFTw2DlxX4Ioz1P2l5C+ubzAxayHtdvEaoHfXwFmaYN2VqdFViwEHm
tmPEbajfP5HUEsjCTJbXNwWFOzgWFeD1YYAFpdunRW9x78Cf/+W9aRQbCU7z
lP0338Uk7+CvS+QeWs64xZ364y4ilnsdGj7OwR2e8/K0rAaETD8TY6XAxemC
9+vlljaiorRbZOoZLh5JPAtMammETclE+B9ZHvqkuD5vQprg1Wqo2H+OB3zN
71sh2QzL207DZvJV2B0Rsz6aakaPFkZEz1Whq2fHGvbqe+ga2KFpJVONW7fy
nd69vocw+r24RXw1ImyF2sNJ9+HI5mXMmajGgeuSZ6TmtWB555bRzP01wE2j
nonmFny03ZcvMlSDeJ1yo4E9D5D7Msl7+/ZaSCYsV3g4pRVNIVNFU1tr4RvP
ephd0ory73s4K1GHyR0rdAMd2+CdbrsntKgOSnXqh3RetSGp3Vt/tywfv4c+
i/F62lCuU1shqsjHc/U7aavftMF+VZCXvBIfdc4XZrx814biA3JiL+T5yI3Z
eTXkA4nvvlK/V4WP46Ur9EQH26DakTHfexYfQV1yjHMf2zDRVJPAVONjzfQ3
5npf2iB7V0l/rzofRis4t6q+taEwe8GTf4mV9pxY7fyzDc0WLrsD5/Dx67L3
o1e/23DJhTOgPpePZy1G3vtH2vCy4Nt7Ay0yn1HRd2JjbbDt/jbMm0/ms7Az
+MJEG4ZcLG+PkPjxzcW/9EWFMBQxTt9A4jtTYw7XiAvh/ujN4S36fDjXrJvm
IiHEqU8aR5kLSfuq+PPhi4XYXbxkRNaB5IP9gWqKF+LmkpSZ+w7xEaglbrTo
uBCBNfRCuWg+nqZplp9LEsJnrXpOaxwf//6xNBw9IcTpV2eHfI7zUbXDo3R7
mhDHjZeNqB7lY4Fw/8LmDCHOpkQHDcbzcdky/eai00KUDmd0bCLtpa8X/XP+
LJnP9UTL1iQ+YhTuFo2eF+LvtMsakSf4+BjTreebKcRTa9YlqVQ+tnwYud58
SYhD80a9U5P5aHOfqWuULUQI/8E+0zN82AiMC8/nCNF+SCR/5yk+qAVr5//N
FeLH6WVvPDP4mHshKN+3gMQ/nCyuJf2dFkmYd++6ENLfA1a/OcmHSHBOrlGx
EPfy/g0YP89H6NPquRdKhFiovFlO6jIfb+w6c/6WCSE2a8aMt6f5cKe+ztnB
EMI8jun/KpOPu2oyV+9VCHHrB2/8czYfpon6GovZQnhV7sjmXOGj8KvdlQtc
Id7UGTvUEM/csnX2WBWJBxcVPyjgI6k5+tKOWiGmf5MbGib+bXJB9T5fCL7m
9rGOYrK/cpiZi2+R+UTF65Tkk/0h1apy8Y4Q6fLf5MVvkHqEf7gw1iDEJY8D
VvZFfFT3is30axZCPRdzRBl8LFyref7+fSHsnV6sXplH6sGzVDZuFcJidZDS
kzI+ps/3OHtRKMSC0M76OvL72JP7FcfbhVCu5KSKMEk9RtJO+3UIIWMh+5xD
2vsEFMm3dArRlO+z6SKZn7D9zknjZ0K4Je8pOsMm9bDqls18IYSxtKzLPxV8
MIpG0sdfCpFN/Q60ZvGhpTxTxr9HiDV+KV91uKQeh43TWl4L4fvVV9Wgig/R
QWfpJe+ESDNb0ypJ4gc8glIy+4RoWakYl1BJ6nHrmOREvxA7dF87hdziY4Nh
TrL/kBAnBq/YFt7moyGzWuLBJyFs/3qWqxKbincmLvkqxG9qmsdR0v56yNcp
Wd/J/rscWmnZwofKi+nHJ36S9d2RC1j7gNTDUV884I8QEdPEB+438vGHaXfs
wQipd0Lhot4mcr40toqajAkRf3HupMM9Uo/k6KNZE0LkbDiSeK+Nj9U/zk9O
iNDwPja5xEvIR81W5uEAcRoqbw2+57WSerQ8GH8wlYaGVtOxa518XDH7EGsi
SePKv030tOd8yOSJjWVJ03Dr3eQbQxwroxkzKUPjVcHpoXSaj0+RlqMB8jQe
9MvPdn7Jx9a3G6NbFWkoblHNGHtE6rFu/7DJDBqauzgd0r18oCYt8pIKjSNd
N9Z3v+KDqVv0e1KVhonoUa96Mr7WmTvhgeo0/ss/fa6A9K9Q6nNcRJNGuM5N
cTnSv0jj8NnLWjQScoKO5fXw8bX7XJ7pfBo5688yOW/56B02Ygp1aayvbX5Q
+J6PdqUWwc5/aFx+cFfN4wMftwwD2sQMaLw3kd0rHCTjO4m8zF5EY6JkraLh
ELnPtl8ZXGZMIy/q8GIvEj99aNlIuwmN8rpTN74P8HH0/MNpe8xohLrbzBf9
wcd+KlhlqgWNjx+6vXZ952P7vWm615bTGGlapHSDfGdd3+QvtbQm8w2WW/lk
jI+VY9Z2HaCx94C3e/FfPoxVnrvutaOhLZa4LnCE3A/GB7dNc6Qx89zD7loS
l1sjH5K3iuRXzGuN1DgfE34lsSvW0Dj2uzA6gPT3Oc4xrXMtDfnHJ8/rDfPR
ndl7ad964n0RecuJhRUxxVLuNNqrqGd7RAQQPFDhFWykYRm5eEJFTADqfUWj
tSeNbytH3n+YJkDO5NrHT/+jsTKg+/w+Mv5Jtf43oVtopE9fsHyvlACHlyZ8
m76NRqpUeWSKtAAhLpoiN3xp3JaXuHGMxLcGVcut9KeRq3mn7ICCAOviN855
EUhjrsIznj6J21z5YnBwF43e0BWrF8oJYMRJXS4XTENs9q/k+DkCaNK6q4tD
aOyOnEqtI3G5gVuedqE0zu8w8ZRXFWBCbEvgyzCSz2idVTLaAnzW+HMwIoJG
de7r0bXk993LziYoRNNIjLpXODRbAKHrorMlMTRKPu43/j2LrH/3vVyHwzSa
hOd27STtqeN+jO6jNPxXm+EQ6f9qzgQ/KoHGNd92t0Di9KpLrUpJNEztTbWZ
pH3sI9OushM0MnfuPyZHHPyRHnBKo5GyZbHr5vkCbJHYM9ybQcPesXRUzFCA
tVoS02JO02hslYtKXiiA1fK8mTPP0Yg/VTNXR08Aw41WOowLNAzon7H+JK4R
8tRkdRYN5oWEOrFlAsicOGD79jKNgvy5ZUwjAcbyZF3jrtKQaOsJu7pYgI+1
xVtn5ZL6FDxX6yPxl532eyvyaSxc2DqDbypA65fuGOfrNG5JdrPkSfs6qUOp
74toqDnuNT1iLUDZ/JmXjpTQKHyqpZNvIkC2NbNIrZz0fy6+NciOrN/Tmcti
kHy3ahgvWUrWH9rX4FJJY9HmT4EapP/gtPiOD2waj35P9/CxJOu/rvEmnkcj
JKqWm2BD1l/P+6peQ2NTVKEe9S9Z/3P3SU4djaWngtK/kLjhj0+yrvU03qSz
Kp+RuLpsisbgbRpRkaoL5RwE+FrnMWWC2Eo6ZejhBgGagrU/Kt6hMTrOd5Qx
J/PV+NKhS2zWVpjZZS/AgdbaWkvigJTtnYUrBPg39kSBC/GnbHFhkDPZX4Ye
ab7EekUm9nHrBPjZNS8s/P/+c96zi8y/Je3z5hTiqXNyZSYdBchdUWt3lbhe
JZYRsVaAiKHkhRXE1CejQiGpz9orG5UaiTUrakIdyHq0neeNPiNWD6R7Hcl8
hkc/vf5ILG+WpPGeWFhSc1/kLhkvfn8n012Aws3JFTOIvXoSpZhkfoekN176
h3iobZdk3hoBXGu04q2IQ4PD5s4i89Hb/WmnK/EO7Q/X1Ul8TK3G1Z/YUeZy
kBQZ/9H9JIsoYu4m35vBZD3F0Ru00ok3mkyWZDuR87tASzKX+JE5L/sEqe/G
5x+/sIiN8zwKrFcKsDCl+mkzcWZxpJgLmZ+IZVJ9F3Ev3ETryfqf9LsXfSGO
3XFzpwkZryxr7inxBuLkH/XapP9j/36MmEXssGbzlHdkP3kNV201IG4Vpv8w
dSPnvTjRCcTKS98KT5P2U7zcjTYQ8+68l1RwEeD5tLkqQcTVIUeaGkg+KN7Q
+CFiVWxcJ3QV4HhQ1fuTxL+ehV+jSD43z0psyyc+4zk7OHqTAMbNbhwusZDn
Y7iZ5EciUvNqC/EN74li//XkfOgNHe8mDn81zcXPS4DKJ7zg78SWhSljY2T/
nUg6vlGikUZG+gNuPcnP1mVuVrOJD2pveeVG5mvaN0fHiFhG9MHIdpIv6YuD
0+2IDSLDJco9BOh15P3wIH6sMH2rPskX91dC1y7iuIFfqf2kfunXXe/GEf/e
8uw0n6x3h8ec0jPEVopDLgZkfIupg2evExefNjMM2UjuPw73UDWxk7t4ylUI
8M4/YUcb8Sfh9JUe5Pc1M1zXvCa+XzR40Y/U63SDhsmv//cvb5d8kjjw4ICa
VBONH5Eey63J+q10uKJziIt31HKHyXhKj48NGBObBm4LyCb56k9Y/9CBeOpM
59YS0l6wVKPai5h9UI7hRvo7/7Y/N5j4U2/HsBPx7nOcE0eJ/VWK22pIfyvt
j+0/Txzp3H64j1jlxzqvYmLRmu6RZnJeP+arr6wj9lO7tS6Z5POOe79++//H
y0qvVCbnMVOMI/+OuPWJktoKsr7/AU960Gs=
      "]], 
     LineBox[{{0.02886286913492253, -0.014964768963897077`}, {
      0.02886297770273957, 0.1851299705944367}}]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0.05, 0},
  PlotRange->{{0.01, 0.24825717236333364`}, {-0.014964768963897077`, 
   0.1851299705944367}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.3918514191940613`*^9, {3.3918515116020856`*^9, 3.391851541790165*^9}, 
   3.391851602791336*^9, 3.3918518430146985`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import of Data", "Section",
 CellChangeTimes->{{3.3917490616057615`*^9, 3.391749066012124*^9}}],

Cell[CellGroupData[{

Cell[" Chargement des smiles de CMS", "Subsection",
 CellChangeTimes->{
  3.391488526281438*^9, {3.3915159155784216`*^9, 3.391515932891254*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaturiteVec", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.25", ",", "0.5", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",",
      "7", ",", "10", ",", "12", ",", "15", ",", "20"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.391516457073193*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DateIndex", "=", "7"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Maturity", "=", 
  RowBox[{"MaturiteVec", "[", 
   RowBox[{"[", "DateIndex", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.391516429666417*^9, 3.391516432057088*^9}, {
  3.3915164652139745`*^9, 3.391516477136078*^9}}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.391516478214224*^9, 3.3917491293262453`*^9, 
  3.391870619968959*^9, 3.3918708070194254`*^9, 3.3919223293746295`*^9, 
  3.3919265031891403`*^9, 3.3919273593149524`*^9, 3.3919367370221453`*^9, 
  3.391939540435345*^9, 3.3919398774418154`*^9, 3.391940426733612*^9, 
  3.39194052637615*^9, 3.3919406344719753`*^9, 3.3919409954320307`*^9, 
  3.3919414920821915`*^9, 3.391941981607215*^9, 3.3919422534249334`*^9, 
  3.391942417959343*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRForward", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<My Documents\\\\\\Correlation_EUR\\\\CMSRateForward.xls\>\"", "]"}],
     "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardVec", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"SABRForward", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"SABRForward", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"SABRForward", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"SABRForward", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"SABRForward", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], "[", 
      RowBox[{"[", "20", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"SABRForward", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], "[", 
      RowBox[{"[", "30", "]"}], "]"}]}], "}"}], "/", "100"}]}]], "Input",
 CellChangeTimes->{{3.3915167293440456`*^9, 3.3915167383442183`*^9}, {
  3.391516769876074*^9, 3.3915168301741066`*^9}, {3.39151689961294*^9, 
  3.39151692933226*^9}, {3.391518123792693*^9, 3.391518124777087*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.04048185894968866`", ",", "0.04084411944855981`", ",", 
   "0.04208724250712109`", ",", "0.043452726858738126`", ",", 
   "0.04392352400579607`", ",", "0.04350901408784913`"}], "}"}]], "Output",
 CellChangeTimes->{{3.3915167135156164`*^9, 3.3915167389223547`*^9}, 
   3.391516809892467*^9, 3.3915169305510335`*^9, 3.3915181254646006`*^9, 
   3.391749129732506*^9, 3.3918708095976*^9, 3.3919223320465555`*^9, 
   3.391926504579792*^9, 3.3919273606899786`*^9, 3.391936738475299*^9, 
   3.3919395419353743`*^9, 3.391939878879343*^9, 3.3919404282336407`*^9, 
   3.391940527813678*^9, 3.3919406367376437`*^9, 3.3919409969789352`*^9, 
   3.391941493504093*^9, 3.3919419829978666`*^9, 3.391942254815585*^9, 
   3.3919424194593716`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SABRRho", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\rho.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SABRNu", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\nu.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SABRBeta", "=", 
    RowBox[{
     RowBox[{
     "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\beta.xls\>\"", 
      "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SABRATM", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\VolATM.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.391515958188615*^9, 3.3915160154240885`*^9}, {
   3.3915160710814075`*^9, 3.3915161474422483`*^9}, 3.391870703501813*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SABRRho", "[", 
  RowBox[{"[", "8", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.391516563762741*^9, 3.391516565559651*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.00822`", ",", "0.17295`", ",", "0.13985`", ",", "0.00439`", ",", 
   RowBox[{"-", "0.05426`"}], ",", 
   RowBox[{"-", "0.08521`"}], ",", 
   RowBox[{"-", "0.09806`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.391516566215914*^9, 3.391749115107131*^9, 
  3.3918708130664167`*^9, 3.3919223354528713`*^9, 3.3919265081892357`*^9, 
  3.3919273639712915`*^9, 3.3919367417878623`*^9, 3.391939545232312*^9, 
  3.3919398822231574`*^9, 3.3919404318274593`*^9, 3.3919405312512436`*^9, 
  3.3919406421908736`*^9, 3.391941000697757*^9, 3.391941496957285*^9, 
  3.3919419862948046`*^9, 3.3919422592062945`*^9, 3.391942422771935*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.3915160639718957`*^9, 3.3915160681751013`*^9}}],

Cell["\<\
donc c' est associ\[EAcute] aux vecteurs :\
\>", "Text",
 CellChangeTimes->{{3.3915165771067476`*^9, 3.391516588106959*^9}, {
  3.3915166905776763`*^9, 3.3915166928120937`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhoVec", "=", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"SABRRho", "[", 
     RowBox[{"[", "8", "]"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.3915165945914583`*^9, 3.391516597982148*^9}, {
  3.391516637654785*^9, 3.3915166438111534`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.17295`", ",", "0.13985`", ",", "0.00439`", ",", 
   RowBox[{"-", "0.05426`"}], ",", 
   RowBox[{"-", "0.08521`"}], ",", 
   RowBox[{"-", "0.09806`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.3915166011853347`*^9, 3.3915166451861796`*^9, 
  3.391749129404372*^9, 3.3918708131601686`*^9, 3.391922335562248*^9, 
  3.3919265092517567`*^9, 3.3919273640962944`*^9, 3.3919367419128647`*^9, 
  3.391939545388565*^9, 3.391939882270033*^9, 3.3919404319212112`*^9, 
  3.3919405313449955`*^9, 3.391940642222124*^9, 3.3919410007915087`*^9, 
  3.391941497035411*^9, 3.3919419863885565`*^9, 3.3919422595188007`*^9, 
  3.3919424228500614`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"betaVec", "=", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"SABRBeta", "[", 
     RowBox[{"[", "8", "]"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.39151660901361*^9, 3.39151665692078*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.4`", ",", "0.3`", ",", "0.3`", ",", "0.3`", ",", "0.3`", ",", "0.3`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.3915166288421164`*^9, 3.3915166582489305`*^9}, 
   3.391749129482499*^9, 3.3918708131914186`*^9, 3.391922335609124*^9, 
   3.391926509329883*^9, 3.391927364127545*^9, 3.3919367419597406`*^9, 
   3.391939545466692*^9, 3.3919398823169093`*^9, 3.391940431999338*^9, 
   3.3919405313918715`*^9, 3.391940642253375*^9, 3.3919410008852606`*^9, 
   3.391941497113538*^9, 3.3919419864666834`*^9, 3.3919422596750536`*^9, 
   3.3919424229438133`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nuVec", "=", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"SABRNu", "[", 
     RowBox[{"[", "8", "]"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.39151660901361*^9, 3.391516675514887*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.33087`", ",", "0.33882`", ",", "0.33684`", ",", "0.33543`", ",", 
   "0.33566`", ",", "0.33363`"}], "}"}]], "Output",
 CellChangeTimes->{3.3915166772649207`*^9, 3.391749129545001*^9, 
  3.3918708132226696`*^9, 3.391922335656*^9, 3.3919265093923845`*^9, 
  3.3919273641587954`*^9, 3.3919367420066166`*^9, 3.3919395455448184`*^9, 
  3.3919398823637853`*^9, 3.391940432077464*^9, 3.3919405314543724`*^9, 
  3.391940642284625*^9, 3.3919410009633865`*^9, 3.391941497191664*^9, 
  3.391941986560435*^9, 3.3919422598313065`*^9, 3.3919424230219398`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ATMVec", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SABRATM", "[", 
      RowBox[{"[", 
       RowBox[{"7", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"SABRATM", "[", 
      RowBox[{"[", 
       RowBox[{"7", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"SABRATM", "[", 
      RowBox[{"[", 
       RowBox[{"7", ",", "6"}], "]"}], "]"}], ",", 
     RowBox[{"SABRATM", "[", 
      RowBox[{"[", 
       RowBox[{"7", ",", "11"}], "]"}], "]"}], ",", 
     RowBox[{"SABRATM", "[", 
      RowBox[{"[", 
       RowBox[{"7", ",", "13"}], "]"}], "]"}], ",", 
     RowBox[{"SABRATM", "[", 
      RowBox[{"[", 
       RowBox[{"7", ",", "15"}], "]"}], "]"}]}], "}"}], "/", 
   "100"}]}]], "Input",
 CellChangeTimes->{{3.3915169453950686`*^9, 3.3915169501451597`*^9}, {
  3.391517006239987*^9, 3.3915170820070667`*^9}, {3.3915171994624467`*^9, 
  3.3915172417288833`*^9}, {3.3915181168706856`*^9, 3.3915181178550797`*^9}}],\


Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.152`", ",", "0.156`", ",", "0.16`", ",", "0.149`", ",", "0.134`", ",", 
   "0.131`"}], "}"}]], "Output",
 CellChangeTimes->{3.3915172440883036`*^9, 3.3915181183863397`*^9, 
  3.3917491298887596`*^9, 3.3918708132539206`*^9, 3.3919223356872506`*^9, 
  3.3919265094548855`*^9, 3.3919273641900463`*^9, 3.3919367420534925`*^9, 
  3.391939545622945*^9, 3.3919398824262867`*^9, 3.391940432171216*^9, 
  3.391940531485623*^9, 3.391940642315876*^9, 3.3919410010571384`*^9, 
  3.3919414972697906`*^9, 3.3919419866541867`*^9, 3.3919422599719343`*^9, 
  3.391942423100066*^9}]
}, Open  ]],

Cell["Determination des alpha : ", "Text",
 CellChangeTimes->{{3.3915172583073263`*^9, 3.3915172658387213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaVec", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ComputeAlphaSABROptionAnalytic", "[", 
     RowBox[{
      RowBox[{"forwardVec", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"ATMVec", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"betaVec", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"rhoVec", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"nuVec", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "Maturity"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.39151727022943*^9, 3.3915172727294784`*^9}, {
  3.391517373481413*^9, 3.3915173993725348`*^9}, {3.3915180688697643`*^9, 
  3.391518103417302*^9}, {3.3915181697935767`*^9, 3.391518243560618*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial x=\"\>", "\[InvisibleSpace]", "0.05`"}],
  SequenceForm["initial x=", 0.05],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942423178193*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial fx=\"\>", "\[InvisibleSpace]", 
   "0.21396731111647768`"}],
  SequenceForm["initial fx=", 0.21396731111647768`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942423225069*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.021900678624533328`"}],
  SequenceForm[" new x=", 0.021900678624533328`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424232719445`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.006038089060407065`"}],
  SequenceForm["fx=", 0.006038089060407065],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424233188205`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.021075262603861836`"}],
  SequenceForm[" new x=", 0.021075262603861836`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942423350071*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.00003342954264101694`"}],
  SequenceForm["fx=", 0.00003342954264101694],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942423396947*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.021070688724252905`"}],
  SequenceForm[" new x=", 0.021070688724252905`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942423443823*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "1.6884208775547194`*^-7"}],
  SequenceForm["fx=", 1.6884208775547194`*^-7],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942423475074*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial x=\"\>", "\[InvisibleSpace]", "0.05`"}],
  SequenceForm["initial x=", 0.05],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424235219493`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial fx=\"\>", "\[InvisibleSpace]", "0.3540424375892044`"}],
  
  SequenceForm["initial fx=", 0.3540424375892044],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424235688252`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.017972082575665134`"}],
  SequenceForm[" new x=", 0.017972082575665134`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424236000757`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.022160711736303795`"}],
  SequenceForm["fx=", 0.022160711736303795`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424236469517`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.015776730862277683`"}],
  SequenceForm[" new x=", 0.015776730862277683`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424236782026`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.00021791657099423656`"}],
  SequenceForm["fx=", 0.00021791657099423656`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424237250786`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.015755062175026955`"}],
  SequenceForm[" new x=", 0.015755062175026955`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424237719545`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "1.6630778120196865`*^-6"}],
  SequenceForm["fx=", 1.6630778120196865`*^-6],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424238032045`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial x=\"\>", "\[InvisibleSpace]", "0.05`"}],
  SequenceForm["initial x=", 0.05],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424238500805`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial fx=\"\>", "\[InvisibleSpace]", "0.3346997277049656`"}],
  
  SequenceForm["initial fx=", 0.3346997277049656],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424238969564`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.01830834924126687`"}],
  SequenceForm[" new x=", 0.01830834924126687],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424239438324`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.017314958663724817`"}],
  SequenceForm["fx=", 0.017314958663724817`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424239907084`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.016543263689042388`"}],
  SequenceForm[" new x=", 0.016543263689042388`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424240219593`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.00012435098260629718`"}],
  SequenceForm["fx=", 0.00012435098260629718`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424068835*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.016530558119637245`"}],
  SequenceForm[" new x=", 0.016530558119637245`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424241157107`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "7.176410160569802`*^-7"}],
  SequenceForm["fx=", 7.176410160569802*^-7],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424146961*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial x=\"\>", "\[InvisibleSpace]", "0.05`"}],
  SequenceForm["initial x=", 0.05],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424193837*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial fx=\"\>", "\[InvisibleSpace]", "0.3320596434407532`"}],
  
  SequenceForm["initial fx=", 0.3320596434407532],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424240713*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.017409676396776298`"}],
  SequenceForm[" new x=", 0.017409676396776298`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424287589*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.01549164501045655`"}],
  SequenceForm["fx=", 0.01549164501045655],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424334465*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.015785294959114363`"}],
  SequenceForm[" new x=", 0.015785294959114363`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424396966*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.0000871993180464603`"}],
  SequenceForm["fx=", 0.0000871993180464603],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424244594674`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.015776136064526464`"}],
  SequenceForm[" new x=", 0.015776136064526464`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424506343*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "3.966975958835661`*^-7"}],
  SequenceForm["fx=", 3.966975958835661*^-7],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424245532193`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial x=\"\>", "\[InvisibleSpace]", "0.05`"}],
  SequenceForm["initial x=", 0.05],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424246000953`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial fx=\"\>", "\[InvisibleSpace]", 
   "0.34220917610967555`"}],
  SequenceForm["initial fx=", 0.34220917610967555`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424246313457`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.015953049880846358`"}],
  SequenceForm[" new x=", 0.015953049880846358`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424246782217`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.015409642576536986`"}],
  SequenceForm["fx=", 0.015409642576536986`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424247250977`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.014319185179570038`"}],
  SequenceForm[" new x=", 0.014319185179570038`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424247563477`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.0000712885589256862`"}],
  SequenceForm["fx=", 0.0000712885589256862],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942424803224*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.014311615761367098`"}],
  SequenceForm[" new x=", 0.014311615761367098`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424248344746`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "2.627871609484078`*^-7"}],
  SequenceForm["fx=", 2.627871609484078*^-7],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424248813505`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial x=\"\>", "\[InvisibleSpace]", "0.05`"}],
  SequenceForm["initial x=", 0.05],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424249282265`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"initial fx=\"\>", "\[InvisibleSpace]", "0.3477378163909945`"}],
  
  SequenceForm["initial fx=", 0.3477378163909945],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424249751024`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.01557497747867461`"}],
  SequenceForm[" new x=", 0.01557497747867461],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942425006353*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.015681024693270068`"}],
  SequenceForm["fx=", 0.015681024693270068`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.391942425053229*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.013920599041650942`"}],
  SequenceForm[" new x=", 0.013920599041650942`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424250844793`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "0.00006891305134609782`"}],
  SequenceForm["fx=", 0.00006891305134609782],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424251313553`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" new x=\"\>", "\[InvisibleSpace]", "0.013913318569349629`"}],
  SequenceForm[" new x=", 0.013913318569349629`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424251782312`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fx=\"\>", "\[InvisibleSpace]", "2.3936677495672853`*^-7"}],
  SequenceForm["fx=", 2.3936677495672853`*^-7],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919414973479176`*^9, 3.391941986747938*^9, 
  3.391942260065686*^9, 3.3919424252094817`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.021070688724252905`", ",", "0.015755062175026955`", ",", 
   "0.016530558119637245`", ",", "0.015776136064526464`", ",", 
   "0.014311615761367098`", ",", "0.013913318569349629`"}], "}"}]], "Output",
 CellChangeTimes->{3.3915182458575373`*^9, 3.391749129982512*^9, 
  3.391870813300796*^9, 3.391922335734126*^9, 3.391926509533012*^9, 
  3.3919273642369223`*^9, 3.3919367421159935`*^9, 3.3919395457166967`*^9, 
  3.3919398825044127`*^9, 3.391940432249343*^9, 3.3919405315481243`*^9, 
  3.391940642362752*^9, 3.3919410032446804`*^9, 3.391941499254204*^9, 
  3.3919419874979525`*^9, 3.391942260190688*^9, 3.3919424252563577`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Importation de Correlation", "Subsection",
 CellChangeTimes->{{3.3915117191853523`*^9, 3.3915117325293584`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Correlation3M3M", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\3M_3M.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation3M2Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\3M_2Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation3M5Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\3M_5Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation3M10Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\3M_10Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation3M20Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\3M_20Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation3M30Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\3M_30Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation2Y2Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\2Y_2Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation2Y5Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\2Y_5Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation2Y10Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\2Y_10Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation2Y20Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\2Y_20Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Correlation2Y30Y", "=", 
    RowBox[{
     RowBox[{
     "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\2Y_30Y.xls\>\"",
       "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation5Y5Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\5Y_5Y.xls\>\"", 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Correlation5Y30Y", "=", 
    RowBox[{
     RowBox[{
     "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\5Y_30Y.xls\>\"",
       "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation10Y10Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\10Y_10Y.xls\>\"",
      "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation10Y20Y", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\<My Documents\\\\\\Correlation_EUR\\\\10Y_20Y.xls\>\"",
      "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Correlation10Y30Y", "=", 
    RowBox[{
     RowBox[{
     "Import", "[", 
      "\"\<My Documents\\\\\\Correlation_EUR\\\\10Y_30Y.xls\>\"", "]"}], "[", 
     
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Correlation20Y20Y", "=", 
    RowBox[{
     RowBox[{
     "Import", "[", 
      "\"\<My Documents\\\\\\Correlation_EUR\\\\20Y_20Y.xls\>\"", "]"}], "[", 
     
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Correlation30Y30Y", "=", 
    RowBox[{
     RowBox[{
     "Import", "[", 
      "\"\<My Documents\\\\\\Correlation_EUR\\\\30Y_30Y.xls\>\"", "]"}], "[", 
     
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.3915068178670044`*^9, 3.3915068697117496`*^9}, {
   3.39150706585614*^9, 3.3915070684499407`*^9}, {3.391508323599039*^9, 
   3.3915084288979354`*^9}, {3.391510085187022*^9, 3.3915101005942583`*^9}, {
   3.3915101392998605`*^9, 3.391510341887895*^9}, {3.3915103749672904`*^9, 
   3.391510400968289*^9}, {3.3915104358602533`*^9, 3.391510513785121*^9}, 
   3.391511217035086*^9, 3.3915112748330708`*^9, {3.391511361131603*^9, 
   3.3915114133044796`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approximation des correlations manquantes", "Subsection",
 CellChangeTimes->{{3.3915117362325544`*^9, 3.3915117457014866`*^9}, 
   3.3915117813115454`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Correlation5Y10Y", "=", 
   RowBox[{"Correlation5Y5Y", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Correlation5Y30Y", "-", "Correlation5Y5Y"}], ")"}], 
     RowBox[{"5", "/", "20"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation5Y20Y", "=", 
   RowBox[{"Correlation5Y5Y", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Correlation5Y30Y", "-", "Correlation5Y5Y"}], ")"}], 
     RowBox[{"15", "/", "20"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Correlation20Y30Y", "=", 
   RowBox[{"Correlation10Y30Y", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Correlation30Y30Y", "-", "Correlation10Y30Y"}], ")"}], 
     RowBox[{"20", "/", "30"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.391511443898817*^9, 3.391511461977289*^9}, {
  3.391511506040635*^9, 3.391511547838312*^9}, {3.3915115858077917`*^9, 
  3.3915116867159786`*^9}}],

Cell["Creation de la matrice de correlation", "Text",
 CellChangeTimes->{{3.391511793061771*^9, 3.3915118093433332`*^9}}],

Cell["\<\
le vecteur des maturit\[EAcute] associ\[EAcute]es est :\
\>", "Text",
 CellChangeTimes->{{3.391516322679988*^9, 3.39151638633746*^9}, 
   3.391516442526039*^9, {3.3917533898571873`*^9, 3.3917533906384573`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CorrelationMatrix", "=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Correlation3M3M", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation3M2Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation3M5Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation3M10Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation3M20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation3M30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Correlation3M2Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y2Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y5Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y10Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Correlation3M5Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y5Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation5Y5Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation5Y10Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation5Y20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation5Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Correlation3M10Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y10Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation5Y10Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation10Y10Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation10Y20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation10Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Correlation3M20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation5Y20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation10Y20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation20Y20Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation20Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Correlation3M30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation2Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation5Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation10Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation20Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}], ",", 
          RowBox[{"Correlation30Y30Y", "[", 
           RowBox[{"[", 
            RowBox[{"DateIndex", ",", "DateIndex"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], "/", "100"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.3915118358125916`*^9, 3.3915121027239656`*^9}, {
   3.391512147412324*^9, 3.3915122314139366`*^9}, {3.3915122650552077`*^9, 
   3.3915124600902023`*^9}, {3.391512490622039*^9, 3.3915126116556125`*^9}, {
   3.3915163952282553`*^9, 3.3915163957751412`*^9}, 3.3917533394808974`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "CorrelationMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.391512605499244*^9, 3.391512634109168*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.43173482324256`", ",", "0.44324239092465506`", ",", 
   "0.08153659674368974`", ",", "0.02276804014588545`", ",", 
   "0.01301600577286708`", ",", "0.007702143170343688`"}], "}"}]], "Output",
 CellChangeTimes->{{3.3915125990616207`*^9, 3.3915126348435574`*^9}, 
   3.391516403634667*^9, 3.391749129670004*^9, {3.3918708283167095`*^9, 
   3.3918708348168344`*^9}, 3.391922350875042*^9, 3.391926523877037*^9, 
   3.39192737847157*^9, 3.391936756506895*^9, 3.3919395604044785`*^9, 
   3.3919398967390614`*^9, 3.391940446733996*^9, 3.391940546985921*^9, 
   3.391940658097429*^9, 3.3919410224950504`*^9, 3.3919415141294894`*^9, 
   3.3919420024669905`*^9, 3.3919422764878764`*^9, 3.3919424398347626`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimisation", "Section",
 CellChangeTimes->{{3.3917506504901857`*^9, 3.3917506532402563`*^9}}],

Cell["Vecteur de poid du basket :", "Text",
 CellChangeTimes->{{3.391749423958788*^9, 3.3917494257869596`*^9}, {
  3.391750630255293*^9, 3.391750643224375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Weigths", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391750675881461*^9, 3.391750707647899*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ForwardBasket", "[", 
   RowBox[{
   "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", "=", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"forwardVec", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"xi", "[", 
         RowBox[{"[", "i", "]"}], "]"}]], 
       RowBox[{"Weigths", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.391924702107685*^9, 3.3919247972813873`*^9}, {
  3.391926059836878*^9, 3.391926060711895*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "[", 
   RowBox[{
   "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y1", "=", 
       RowBox[{
        RowBox[{"forwardVec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", "x1"], 
        RowBox[{"Weigths", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
      RowBox[{"y2", "=", 
       RowBox[{
        RowBox[{"forwardVec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", "x2"], 
        RowBox[{"Weigths", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
      RowBox[{"y3", "=", 
       RowBox[{
        RowBox[{"forwardVec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", "x3"], 
        RowBox[{"Weigths", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
      RowBox[{"y4", "=", 
       RowBox[{
        RowBox[{"forwardVec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", "x4"], 
        RowBox[{"Weigths", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
      RowBox[{"y5", "=", 
       RowBox[{
        RowBox[{"forwardVec", "[", 
         RowBox[{"[", "5", "]"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", "x5"], 
        RowBox[{"Weigths", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], ",", 
      RowBox[{"y6", "=", 
       RowBox[{
        RowBox[{"forwardVec", "[", 
         RowBox[{"[", "6", "]"}], "]"}], " ", 
        SuperscriptBox["\[ExponentialE]", "x6"], 
        RowBox[{"Weigths", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}]}], ",", "sum"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum", "=", 
      RowBox[{"y1", "+", "y2", "+", "y3", "+", "y4", "+", "y5", "+", "y6"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2", ",", "y3", ",", "y4", ",", "y5", ",", "y6"}], 
       "}"}], "/", "sum"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3917516795946555`*^9, 3.391751728611535*^9}, {
  3.391751775440859*^9, 3.3917518344111185`*^9}, {3.3917519142569127`*^9, 
  3.391752088245742*^9}, {3.391768318942487*^9, 3.3917684552584763`*^9}, {
  3.39176965211724*^9, 3.3917697687296004`*^9}, {3.391769927046153*^9, 
  3.3917699290618296`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "[", 
  RowBox[{"0.1", ",", "0.1", ",", "0.1", ",", "0.1", ",", "0.1", ",", "0.1"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.3917520997304106`*^9, 3.3917521010116935`*^9}, {
  3.3917521584819145`*^9, 3.3917521796230807`*^9}, {3.391769776292294*^9, 
  3.3917697777610817`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.15919032633302038`", ",", "0.16061487472405483`", ",", 
   "0.16550331538609103`", ",", "0.17087292797741746`", ",", 
   "0.17272428444723653`", ",", "0.17109427113217965`"}], "}"}]], "Output",
 CellChangeTimes->{3.39175218057623*^9, 3.391769779182993*^9, 
  3.3917699330150557`*^9, 3.391870841520088*^9, 3.3919223609846115`*^9}]
}, Open  ]],

Cell["Cote droit des equations", "Text",
 CellChangeTimes->{{3.391753481531409*^9, 3.3917534908128967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqnGauche", "[", 
   RowBox[{"i_", ",", "leglst_", ",", "xi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "u", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoeffBasedIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"DupireVolSABR1", "[", 
          RowBox[{
           RowBox[{"forwardVec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"forwardVec", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", 
            RowBox[{"Exp", "[", "#", "]"}]}], ",", "Maturity", ",", 
           RowBox[{"alphaVec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"betaVec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"rhoVec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"nuVec", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ")"}], "&"}], ",", 
      RowBox[{"LegendreCoeffsFromLegendre", "[", 
       RowBox[{"leglst", ",", "0.", ",", "xi"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3917543538037386`*^9, 3.3917543797887783`*^9}, {
   3.391754442040372*^9, 3.3917546031851225`*^9}, {3.3917546757494802`*^9, 
   3.3917546762494926`*^9}, {3.3917547068752766`*^9, 3.391754778220853*^9}, {
   3.391754887114266*^9, 3.391754887442399*^9}, {3.3917555154428506`*^9, 
   3.3917555345683403`*^9}, {3.391755578913225*^9, 3.391755624336263*^9}, {
   3.3917556549464216`*^9, 3.391755674868807*^9}, 3.3917557466831455`*^9, 
   3.39176998707894*^9, {3.3917707977090664`*^9, 3.3917707984747114`*^9}, 
   3.391771292706113*^9, {3.391867822321495*^9, 3.3918678324310646`*^9}, {
   3.3919219525548944`*^9, 3.3919219737428017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqnDroite", "[", 
   RowBox[{
   "i_", ",", "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", 
    "x6_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xi", "=", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
         "}"}]}], ",", 
      RowBox[{"p1", "=", 
       RowBox[{"p", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
         "]"}]}]}], "}"}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CorrelationMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], 
       RowBox[{"p1", "[", 
        RowBox[{"[", "j", "]"}], "]"}], 
       RowBox[{"DupireVolSABR1", "[", 
        RowBox[{
         RowBox[{"forwardVec", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", "Maturity", ",", 
         RowBox[{"alphaVec", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"betaVec", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"rhoVec", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"nuVec", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.3917524029725485`*^9, 3.391752426629404*^9}, {
   3.391752608149676*^9, 3.391752739731169*^9}, {3.3917528050453415`*^9, 
   3.391752805545354*^9}, 3.3917528635468388`*^9, {3.3917529222983427`*^9, 
   3.3917529552523117`*^9}, {3.3917530322855334`*^9, 3.3917531461634483`*^9}, 
   3.391753283104454*^9, {3.391754332553194*^9, 3.3917543339282293`*^9}, {
   3.3917697978553457`*^9, 3.3917698144026446`*^9}, {3.3917698971391373`*^9, 
   3.3917698992485666`*^9}, {3.391770705034819*^9, 3.391770709659938*^9}, {
   3.3917707443014493`*^9, 3.391770744629583*^9}, {3.3919220104310055`*^9, 
   3.3919220495255065`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"eqnDroite", "[", 
    RowBox[{
    "2", ",", "0.1", ",", "0.1", ",", "0.1", ",", "0.1", ",", "0.1", ",", 
     "0.1"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391753410529591*^9, 3.3917534652184916`*^9}, {
  3.39175433824084*^9, 3.3917543395533733`*^9}, {3.3917670428160686`*^9, 
  3.3917670527538233`*^9}, {3.39176710517704*^9, 3.3917672030701714`*^9}, {
  3.3917698432315073`*^9, 3.391769844419038*^9}, {3.3919224668928947`*^9, 
  3.39192247472117*^9}}],

Cell[BoxData["0.016757540379430787`"], "Output",
 CellChangeTimes->{3.391769904967463*^9, 3.3917699361088853`*^9, 
  3.39187084606705*^9, 3.3919220985420723`*^9, 3.391922366937851*^9, 
  3.391922476080571*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "=", "0.05"}], ",", 
     RowBox[{"leglst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "}"}], ",", 
   RowBox[{"eqnGauche", "[", 
    RowBox[{"2", ",", "leglst", ",", "0.1"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391753410529591*^9, 3.3917534652184916`*^9}, {
  3.39175433824084*^9, 3.3917543395533733`*^9}, {3.3917670428160686`*^9, 
  3.3917670527538233`*^9}, {3.39176710517704*^9, 3.3917672030701714`*^9}, {
  3.3917698432315073`*^9, 3.391769844419038*^9}, {3.391922384422561*^9, 
  3.3919224413611546`*^9}}],

Cell[BoxData["4.644055242204255`"], "Output",
 CellChangeTimes->{
  3.391769904967463*^9, 3.3917699361088853`*^9, 3.39187084606705*^9, 
   3.3919220985420723`*^9, 3.391922366937851*^9, {3.391922413469994*^9, 
   3.3919224422517967`*^9}, 3.3919224800962734`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.391766226779554*^9, 3.3917662322328186`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Optimisep", "[", "B_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"leglst", "=", 
       RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], ",", "\[Lambda]ini", ",",
       "xiini"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xiini", ",", "\[Lambda]ini"}], "}"}], "=", 
      RowBox[{"ApproximatedOptimizep", "[", "B", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"eqnGauche", "[", 
           RowBox[{"1", ",", "leglst", ",", "x1"}], "]"}], "\[Equal]", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"eqnDroite", "[", 
            RowBox[{
            "1", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
             "x6"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eqnGauche", "[", 
           RowBox[{"2", ",", "leglst", ",", "x2"}], "]"}], "\[Equal]", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"eqnDroite", "[", 
            RowBox[{
            "2", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
             "x6"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eqnGauche", "[", 
           RowBox[{"3", ",", "leglst", ",", "x3"}], "]"}], "\[Equal]", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"eqnDroite", "[", 
            RowBox[{
            "3", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
             "x6"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eqnGauche", "[", 
           RowBox[{"4", ",", "leglst", ",", "x4"}], "]"}], "\[Equal]", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"eqnDroite", "[", 
            RowBox[{
            "4", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
             "x6"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eqnGauche", "[", 
           RowBox[{"5", ",", "leglst", ",", "x5"}], "]"}], "\[Equal]", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"eqnDroite", "[", 
            RowBox[{
            "5", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
             "x6"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eqnGauche", "[", 
           RowBox[{"6", ",", "leglst", ",", "x6"}], "]"}], "\[Equal]", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"eqnDroite", "[", 
            RowBox[{
            "6", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
             "x6"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"forwardVec", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
                 "}"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}]], 
             RowBox[{"Weigths", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], "\[Equal]", 
          "B"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x3", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x4", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x5", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x6", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", "\[Lambda]ini"}], "}"}]}], "}"}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3917535181573467`*^9, 3.391753519657385*^9}, {
   3.3917535841902866`*^9, 3.39175358801851*^9}, {3.391763701808666*^9, 
   3.3917637496692667`*^9}, {3.3917637845764103`*^9, 3.391763971565572*^9}, {
   3.3917640119728565`*^9, 3.3917640641773176`*^9}, {3.391764172117581*^9, 
   3.391764193258747*^9}, 3.3917642531977816`*^9, {3.3917642949332247`*^9, 
   3.3917643018396516`*^9}, {3.3917644511247234`*^9, 3.391764534314353*^9}, {
   3.3917656612025757`*^9, 3.3917656613900805`*^9}, 3.3917663031721344`*^9, {
   3.391770013798374*^9, 3.391770062158987*^9}, {3.391771398708827*^9, 
   3.3917713991775885`*^9}, {3.3917714512414217`*^9, 3.391771451413301*^9}, {
   3.3918678469625936`*^9, 3.39186787154119*^9}, {3.3919224371110725`*^9, 
   3.391922446017494*^9}, {3.3919261792766714`*^9, 3.3919262886068954`*^9}, {
   3.3919263478111567`*^9, 3.3919263529518805`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Optimisep", "[", "B_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"leglst", "=", 
       RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], ",", "\[Lambda]ini", ",",
       "xiini"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xiini", ",", "\[Lambda]ini"}], "}"}], "=", 
      RowBox[{"ApproximatedOptimizep", "[", "B", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FindMinimum", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"eqnGauche", "[", 
            RowBox[{"1", ",", "leglst", ",", "x1"}], "]"}], "-", 
           RowBox[{"\[Lambda]", "  ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{
             "1", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
              "x6"}], "]"}]}]}], ")"}], "2"], "+", "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"eqnGauche", "[", 
            RowBox[{"2", ",", "leglst", ",", "x2"}], "]"}], "-", 
           RowBox[{"\[Lambda]", "  ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{
             "2", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
              "x6"}], "]"}]}]}], ")"}], "2"], "+", "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"eqnGauche", "[", 
            RowBox[{"3", ",", "leglst", ",", "x3"}], "]"}], "-", 
           RowBox[{"\[Lambda]", "  ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{
             "3", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
              "x6"}], "]"}]}]}], ")"}], "2"], "+", "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"eqnGauche", "[", 
            RowBox[{"4", ",", "leglst", ",", "x4"}], "]"}], "-", 
           RowBox[{"\[Lambda]", "  ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{
             "4", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
              "x6"}], "]"}]}]}], ")"}], "2"], "+", "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"eqnGauche", "[", 
            RowBox[{"5", ",", "leglst", ",", "x5"}], "]"}], "-", 
           RowBox[{"\[Lambda]", "  ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{
             "5", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
              "x6"}], "]"}]}]}], ")"}], "2"], "+", "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"eqnGauche", "[", 
            RowBox[{"6", ",", "leglst", ",", "x6"}], "]"}], "-", 
           RowBox[{"\[Lambda]", "  ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{
             "6", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
              "x6"}], "]"}]}]}], ")"}], "2"], "+", "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"forwardVec", "[", 
               RowBox[{"[", "j", "]"}], "]"}], " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", 
                  "x6"}], "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]], 
              RowBox[{"Weigths", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], "-", "B"}], 
          ")"}], "2"]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x3", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x4", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x5", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x6", ",", 
           RowBox[{"xiini", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", "\[Lambda]ini"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MaxIterations", "\[Rule]", "100"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3917535181573467`*^9, 3.391753519657385*^9}, {
   3.3917535841902866`*^9, 3.39175358801851*^9}, {3.391763701808666*^9, 
   3.3917637496692667`*^9}, {3.3917637845764103`*^9, 3.391763971565572*^9}, {
   3.3917640119728565`*^9, 3.3917640641773176`*^9}, {3.391764172117581*^9, 
   3.391764193258747*^9}, 3.3917642531977816`*^9, {3.3917642949332247`*^9, 
   3.3917643018396516`*^9}, {3.3917644511247234`*^9, 3.391764534314353*^9}, {
   3.3917656612025757`*^9, 3.3917656613900805`*^9}, 3.3917663031721344`*^9, {
   3.391770013798374*^9, 3.391770062158987*^9}, {3.391771398708827*^9, 
   3.3917713991775885`*^9}, {3.3917714512414217`*^9, 3.391771451413301*^9}, {
   3.3918678469625936`*^9, 3.39186787154119*^9}, {3.3919224371110725`*^9, 
   3.391922446017494*^9}, {3.3919261792766714`*^9, 3.3919262886068954`*^9}, {
   3.3919263478111567`*^9, 3.3919263529518805`*^9}, {3.391926711099382*^9, 
   3.3919268101481586`*^9}, {3.39192689096221*^9, 3.3919269161970696`*^9}, {
   3.3919271106070523`*^9, 3.3919271443577003`*^9}}],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{
   RowBox[{"Max", "::", "\"\<nord\>\""}], ",", 
   RowBox[{"FindRoot", "::", "\"\<nlnum\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.391770966729018*^9, 3.3917709694634633`*^9}, {
  3.3917710127458215`*^9, 3.3917710332619715`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"sol", "=", 
   RowBox[{"Optimisep", "[", "0.25", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.3917658105501485`*^9, 3.391765812831457*^9}, {
   3.3917710191522355`*^9, 3.391771023871106*^9}, 3.3917711726405396`*^9, {
   3.3918597284785967`*^9, 3.3918597295567427`*^9}, 3.3919262969039297`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BF=\"\>", "\[InvisibleSpace]", "0.2542984858577529`", 
   "\[InvisibleSpace]", "\<\" \[Sigma]F=\[InvisibleComma]\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.02092544128208726`", ",", "0.02180345837192897`", ",", 
     "0.022825982012882357`", ",", "0.01982326153064346`", ",", 
     "0.01605257248194355`", ",", "0.015370739964620498`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]B0=\"\>", "\[InvisibleSpace]", 
   "0.018482559773725152`", "\[InvisibleSpace]", "\<\" xbar=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.017047800390621638`"}]}],
  SequenceForm[
  "BF=", 0.2542984858577529, " \[Sigma]F=\[InvisibleComma]", {
   0.02092544128208726, 0.02180345837192897, 0.022825982012882357`, 
   0.01982326153064346, 0.01605257248194355, 0.015370739964620498`}, 
   " \[Sigma]B0=", 0.018482559773725152`, " xbar=", -0.017047800390621638`],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919262998258605`*^9, 3.391926357967602*^9, 
  3.391927152373479*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Lambda]=\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "49.90500608204028`"}], "\[InvisibleSpace]", "\<\" xi=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.017392963720797024`"}], ",", 
     RowBox[{"-", "0.019304942592311605`"}], ",", 
     RowBox[{"-", "0.020815509909063466`"}], ",", 
     RowBox[{"-", "0.01796042059155939`"}], ",", 
     RowBox[{"-", "0.013995077771911814`"}], ",", 
     RowBox[{"-", "0.013133534627409033`"}]}], "}"}]}],
  SequenceForm[
  "\[Lambda]=", -49.90500608204028, 
   " xi=", {-0.017392963720797024`, -0.019304942592311605`, \
-0.020815509909063466`, -0.01796042059155939, -0.013995077771911814`, \
-0.013133534627409033`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919262998258605`*^9, 3.391926357967602*^9, 
  3.391927152373479*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"equ1=\"\>", "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8287348236139089`"}], ",", 
         RowBox[{"-", "0.8496622731688581`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8792663225836097`"}], ",", 
         RowBox[{"-", "0.9056140806197019`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8982326250073346`"}], ",", 
         RowBox[{"-", "0.9332894592287383`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8917010607409944`"}], ",", 
         RowBox[{"-", "0.9276971963855988`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8597278388430548`"}], ",", 
         RowBox[{"-", "0.8930588202702153`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.842845350850507`"}], ",", 
         RowBox[{"-", "0.8753497414263017`"}]}], "}"}]}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{{-0.8287348236139089, -0.8496622731688581}, \
{-0.8792663225836097, -0.9056140806197019}, {-0.8982326250073346, \
-0.9332894592287383}, {-0.8917010607409944, -0.9276971963855988}, \
{-0.8597278388430548, -0.8930588202702153}, {-0.842845350850507, \
-0.8753497414263017}}],
    Editable->False]}],
  SequenceForm["equ1=", 
   ColumnForm[{{-0.8287348236139089, -0.8496622731688581}, \
{-0.8792663225836097, -0.9056140806197019}, {-0.8982326250073346, \
-0.9332894592287383}, {-0.8917010607409944, -0.9276971963855988}, \
{-0.8597278388430548, -0.8930588202702153}, {-0.842845350850507, \
-0.8753497414263017}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919262998258605`*^9, 3.391926357967602*^9, 
  3.391927152639109*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"equ2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.2500009451872301`", ",", "0.25`"}], "}"}]}],
  SequenceForm["equ2=", {0.2500009451872301, 0.25}],
  Editable->False]], "Print",
 CellChangeTimes->{3.3919262998258605`*^9, 3.391926357967602*^9, 
  3.3919271526547346`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckSol", "[", "B_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "p1", ",", "xbar", ",", "\[Sigma]B0", ",", "\[Lambda]0", ",", 
      "\[Lambda]b", ",", "\[Sigma]F", ",", "xi", ",", "xi2", ",", 
      "linearized", ",", "p0", ",", "xbar0", ",", 
      RowBox[{"leglst", "=", 
       RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], ",", "equ1"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xi", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
         "}"}], "//.", "sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]0", "=", 
      RowBox[{"\[Lambda]", " ", "//.", " ", "sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"equ1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"eqnGauche", "[", 
           RowBox[{"i", ",", "leglst", ",", 
            RowBox[{"xi", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"\[Lambda]0", "  ", 
           RowBox[{"eqnDroite", "[", 
            RowBox[{"i", ",", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<equ1=\>\"", ",", 
       RowBox[{"equ1", "//", " ", "ColumnForm"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
         "]"}], "//.", "sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xbar", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "//.", "sol"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p0", "=", 
      RowBox[{"p", "[", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]F", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"DupireVolSABR1", "[", 
         RowBox[{
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "Maturity", ",", 
          RowBox[{"alphaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"betaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"rhoVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nuVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]B0", "=", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CorrelationMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], 
          RowBox[{"p0", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"p0", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"\[Sigma]F", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"\[Sigma]F", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]b", "=", 
      RowBox[{"xbar", "/", 
       SuperscriptBox["\[Sigma]B0", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xbar0", "=", 
      RowBox[{"\[Lambda]0", " ", 
       SuperscriptBox["\[Sigma]B0", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xi2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CorrelationMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], 
            RowBox[{"p0", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"\[Sigma]F", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"\[Sigma]F", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], "\[Lambda]0"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"linearized", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CorrelationMatrix", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"p0", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"\[Sigma]F", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"\[Sigma]F", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<xbar=\>\"", ",", "xbar", ",", "\"\< \[Lambda]0=\>\"", ",", 
       "\[Lambda]0", ",", "\"\< \[Lambda]b=\>\"", ",", "\[Lambda]b", ",", 
       "\"\< xi2=\>\"", ",", "xi2"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391859789854775*^9, 3.3918600468597097`*^9}, {
   3.391860509384215*^9, 3.391860600729718*^9}, {3.391860756326456*^9, 
   3.3918607814363127`*^9}, {3.3918608505782657`*^9, 
   3.3918608851101785`*^9}, {3.391860920532734*^9, 3.3918609271578608`*^9}, {
   3.3918610329880176`*^9, 3.3918610366443377`*^9}, {3.3918610676918087`*^9, 
   3.3918610690043344`*^9}, 3.391861254773526*^9, 3.391861783502427*^9, {
   3.3918618302845755`*^9, 3.3918618975358667`*^9}, {3.3918645345552464`*^9, 
   3.3918645910407057`*^9}, {3.3918646219788*^9, 3.391864739559182*^9}, {
   3.391864799529084*^9, 3.391864852623853*^9}, {3.391864894077774*^9, 
   3.391864961516569*^9}, {3.3918653079607205`*^9, 3.3918653120232983`*^9}, {
   3.391866919851043*^9, 3.3918670919168468`*^9}, {3.3918673093585215`*^9, 
   3.3918673197805967`*^9}, {3.391867438064118*^9, 3.3918674389703856`*^9}, {
   3.391867486690051*^9, 3.3918675438942747`*^9}, {3.391916686891296*^9, 
   3.3919166912820053`*^9}, {3.391924260286702*^9, 3.391924260442955*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"eqnDroite", "[", 
    RowBox[{
    "1", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
    "]"}]}], " ", "//.", " ", "sol"}]], "Input",
 CellChangeTimes->{{3.391867630270933*^9, 3.3918676921002455`*^9}}],

Cell[BoxData[
 RowBox[{"0.016035735669827418`", "\[InvisibleSpace]", "-", 
  RowBox[{"0.0009269490589370517`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.391867653036995*^9, 3.391867693787778*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CheckSol", "[", "0.2", "]"}]], "Input",
 CellChangeTimes->{{3.391859874809531*^9, 3.3918598766533165`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"equ1=\"\>", "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{"0.20092884135080236`", ",", 
         RowBox[{"0.3430722170392297`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.1504302810133254`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0.10229510758791015`", ",", 
         RowBox[{"0.3779584158676229`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.16639033069733564`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0.007963918876371224`", ",", 
         RowBox[{"0.40220278606889676`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.17815071695001475`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.1482304088587429`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.003678119657255588`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.40973886272213533`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.18326137266486292`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0.017477899177331363`", ",", 
         RowBox[{"0.39852731975258315`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.1773323174750366`", " ", "\[ImaginaryI]"}]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0.03865742163301624`", ",", 
         RowBox[{"0.39111982904963366`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.17410618427064437`", " ", "\[ImaginaryI]"}]}]}], "}"}]}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{{0.20092884135080236`, 
       Complex[0.3430722170392297, -0.1504302810133254]}, {
      0.10229510758791015`, 
       Complex[0.3779584158676229, -0.16639033069733564`]}, {
      0.007963918876371224, 
       Complex[0.40220278606889676`, -0.17815071695001475`]}, {
       Complex[0.1482304088587429, -0.003678119657255588], 
       Complex[0.40973886272213533`, -0.18326137266486292`]}, {
      0.017477899177331363`, 
       Complex[0.39852731975258315`, -0.1773323174750366]}, {
      0.03865742163301624, 
       Complex[0.39111982904963366`, -0.17410618427064437`]}}],
    Editable->False]}],
  SequenceForm["equ1=", 
   ColumnForm[{{0.20092884135080236`, 
      Complex[0.3430722170392297, -0.1504302810133254]}, {
     0.10229510758791015`, 
      Complex[0.3779584158676229, -0.16639033069733564`]}, {
     0.007963918876371224, 
      Complex[0.40220278606889676`, -0.17815071695001475`]}, {
      Complex[0.1482304088587429, -0.003678119657255588], 
      Complex[0.40973886272213533`, -0.18326137266486292`]}, {
     0.017477899177331363`, 
      Complex[0.39852731975258315`, -0.1773323174750366]}, {
     0.03865742163301624, 
      Complex[0.39111982904963366`, -0.17410618427064437`]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.391864856295799*^9, 3.391864948641322*^9, 
  3.3918653149921055`*^9, 3.391867102963934*^9, 3.391867413673024*^9, 
  3.3918675196438093`*^9, 3.3918675505506525`*^9, 3.39191663737472*^9, 
  3.3919167017665815`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"xbar=\"\>", "\[InvisibleSpace]", "0.01729478232709981`", 
   "\[InvisibleSpace]", "\<\" \[Lambda]0=\"\>", "\[InvisibleSpace]", 
   "1.0016787425690492`", "\[InvisibleSpace]", "\<\" \[Lambda]b=\"\>", 
   "\[InvisibleSpace]", "50.628010502533016`", 
   "\[InvisibleSpace]", "\<\" xi2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.00034910650047324424`", ",", "0.0003874831833392654`", ",", 
     "0.00041780285042682114`", ",", "0.000360496329458196`", ",", 
     "0.00028090512365992184`", ",", "0.0002636124806686388`"}], "}"}]}],
  SequenceForm[
  "xbar=", 0.01729478232709981, " \[Lambda]0=", 1.0016787425690492`, 
   " \[Lambda]b=", 50.628010502533016`, " xi2=", {0.00034910650047324424`, 
   0.0003874831833392654, 0.00041780285042682114`, 0.000360496329458196, 
   0.00028090512365992184`, 0.0002636124806686388}],
  Editable->False]], "Print",
 CellChangeTimes->{3.391864856295799*^9, 3.391864948641322*^9, 
  3.3918653149921055`*^9, 3.391867102963934*^9, 3.391867413673024*^9, 
  3.3918675196438093`*^9, 3.3918675505506525`*^9, 3.39191663737472*^9, 
  3.3919167017822065`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApproximatedOptimizep", "[", 
   RowBox[{"B_", ",", "leglst_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]", ",", "p1", ",", "xbar", ",", "BF", ",", "\[Sigma]B0", ",", 
      "\[Sigma]F", ",", "\[Sigma]B01", ",", "p0", ",", "xi", ",", "egalites1",
       ",", "egalites2", ",", "X1", ",", "X2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BF", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"forwardVec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", 
         RowBox[{"Weigths", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]F", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"DupireVolSABR1", "[", 
         RowBox[{
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "Maturity", ",", 
          RowBox[{"alphaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"betaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"rhoVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nuVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p0", "=", 
      RowBox[{"p", "[", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]B0", "=", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CorrelationMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], 
          RowBox[{"p0", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"p0", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"\[Sigma]F", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"\[Sigma]F", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xbar", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"B", "/", "BF"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<BF=\>\"", ",", "BF", ",", "\"\< \[Sigma]F=\[InvisibleComma]\>\"", 
       ",", "\[Sigma]F", ",", "\"\< \[Sigma]B0=\>\"", ",", "\[Sigma]B0", ",", 
       "\"\< xbar=\>\"", ",", "xbar"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"xbar", "/", 
       SuperscriptBox["\[Sigma]B0", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xi", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CorrelationMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], 
            RowBox[{"p0", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"\[Sigma]F", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"\[Sigma]F", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], 
       RowBox[{"xbar", "/", 
        SuperscriptBox["\[Sigma]B0", "2"]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Lambda]=\>\"", ",", "\[Lambda]", ",", "\"\< xi=\>\"", ",", 
       "xi"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"egalites1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"X1", "=", 
           RowBox[{"eqnGauche", "[", 
            RowBox[{"i", ",", "leglst", ",", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"X2", "=", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{"i", ",", 
              RowBox[{"xi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"xi", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"xi", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"xi", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"xi", "[", 
               RowBox[{"[", "5", "]"}], "]"}], ",", 
              RowBox[{"xi", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"X1", "-", "X2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"egalites2", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"X1", "=", 
         RowBox[{"ForwardBasket", "[", 
          RowBox[{
           RowBox[{"xi", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"X2", "=", "B"}], ",", 
        RowBox[{"X1", "-", "X2"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<equ1=\>\"", ",", 
       RowBox[{"egalites1", "//", " ", "ColumnForm"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<equ2=\>\"", ",", "egalites2"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"xi", ",", "\[Lambda]"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.391775412050701*^9, 3.3917754693174257`*^9}, {
   3.3918333228780713`*^9, 3.3918333449878707`*^9}, {3.3918397423292446`*^9, 
   3.3918397622983785`*^9}, 3.391839840143623*^9, 3.3918400332410803`*^9, {
   3.3918555226634717`*^9, 3.391855663353673*^9}, {3.391856139315936*^9, 
   3.3918561550506134`*^9}, {3.391856241052264*^9, 3.391856416243128*^9}, 
   3.3918564826194024`*^9, {3.3918565289640417`*^9, 3.3918566419974623`*^9}, {
   3.3918567563277826`*^9, 3.391857968710435*^9}, {3.391858211840103*^9, 
   3.3918582386062417`*^9}, {3.3918583098732347`*^9, 
   3.3918583736088333`*^9}, {3.391858454985396*^9, 3.3918585054394894`*^9}, {
   3.3918585403776608`*^9, 3.391858596503738*^9}, {3.3918592309377937`*^9, 
   3.3918592502975407`*^9}, {3.3918593030016775`*^9, 3.391859400378547*^9}, {
   3.391860936329912*^9, 3.3918609371424274`*^9}, {3.391861968068471*^9, 
   3.39186202010072*^9}, {3.3918620578201942`*^9, 3.3918620643203187`*^9}, {
   3.391864166860687*^9, 3.3918641829234953`*^9}, 3.3918643391296196`*^9, 
   3.3918643798804016`*^9, 3.391864543555419*^9, {3.3919241131120014`*^9, 
   3.391924127518528*^9}, {3.391924242364483*^9, 3.391924322459771*^9}, {
   3.3919245479953513`*^9, 3.391924577636545*^9}, {3.391924620699872*^9, 
   3.391924645590975*^9}, {3.3919249173930683`*^9, 3.391925004754121*^9}, {
   3.3919361040800414`*^9, 3.3919361101271873`*^9}, {3.391942134422649*^9, 
   3.391942173439023*^9}, 3.391942264831403*^9, {3.3919423863806114`*^9, 
   3.391942386771244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewtonFindRoot", "[", 
   RowBox[{
   "func_", ",", "initial_", ",", "shift_", ",", "accuracy_", ",", 
    "nbloopmax_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derf", ",", 
      RowBox[{"x", "=", "initial"}], ",", 
      RowBox[{"i", "=", "0"}], ",", "fx"}], "}"}], ",", "\[IndentingNewLine]",
     
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<initial x=\>\"", ",", "x"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fx", "=", 
      RowBox[{"func", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<initial fx=\>\"", ",", "fx"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", "fx", "]"}], ">", "accuracy"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"i", "<", "nbloopmax"}], ")"}]}], ",", "\[IndentingNewLine]",
        
       RowBox[{
        RowBox[{"derf", "=", 
         FractionBox[
          RowBox[{
           RowBox[{"func", "[", 
            RowBox[{"x", "+", "shift"}], "]"}], "-", "fx"}], "shift"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"x", "-=", 
         RowBox[{"fx", "/", "derf"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< new x=\>\"", ",", "x"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"fx", "=", 
         RowBox[{"func", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<fx=\>\"", ",", "fx"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "i", ",", 
       RowBox[{"Abs", "[", "fx", "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3919406856448326`*^9, 3.3919407286612835`*^9}, {
  3.391940829866352*^9, 3.391940867492074*^9}}],

Cell["The system to solve is :", "Text",
 CellChangeTimes->{{3.3919442140250764`*^9, 3.391944220040817*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", 
    SubscriptBox["x", "i"]], 
   FractionBox[
    RowBox[{"\[DifferentialD]", "u"}], 
    RowBox[{
     SubscriptBox["\[Sigma]", "i"], "[", "u", "]"}]]}], "=", 
  RowBox[{"\[Lambda]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"j", "=", "1"}], "n"], 
    RowBox[{
     SubscriptBox["\[Rho]", "ij"], 
     RowBox[{
      SubscriptBox["p", "j"], "[", 
      SuperscriptBox["x", "*"], "]"}], 
     RowBox[{
      SubscriptBox["\[Sigma]", "j"], "[", 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["x", "*"], ")"}], "j"], "]"}]}]}]}]}]], "Text",
 CellChangeTimes->{{3.391944249416381*^9, 3.3919443599497533`*^9}, 
   3.391944578235194*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], "n"], 
   RowBox[{
    SubscriptBox["w", "i"], 
    SubscriptBox["F", "i"], 
    SuperscriptBox["\[ExponentialE]", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["x", "*"], ")"}], "i"]]}]}], "=", "B"}]], "Text",
 CellChangeTimes->{{3.3919443744031553`*^9, 3.391944417513358*^9}}],

Cell["we approximate the integral by a simpson rule : ", "Text",
 CellChangeTimes->{{3.3919444321230135`*^9, 3.391944445576397*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", 
    SubscriptBox["x", "i"]], 
   FractionBox[
    RowBox[{"\[DifferentialD]", "u"}], 
    RowBox[{
     SubscriptBox["\[Sigma]", "i"], "[", "u", "]"}]]}], "=", 
  RowBox[{
   FractionBox[
    SubscriptBox["x", "i"], "6"], 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SubscriptBox["\[Sigma]", "i"], "[", "0", "]"}]], "+", 
     FractionBox["4", 
      RowBox[{
       SubscriptBox["\[Sigma]", "i"], "[", 
       RowBox[{
        SubscriptBox["x", "i"], "/", "2"}], "]"}]], "+", 
     FractionBox["1", 
      RowBox[{
       SubscriptBox["\[Sigma]", "i"], "[", 
       SubscriptBox["x", "i"], "]"}]]}], ")"}]}]}]], "Text",
 CellChangeTimes->{{3.3919444590297804`*^9, 3.391944527171714*^9}}],

Cell["So this give us ", "Text",
 CellChangeTimes->{{3.3919446259079847`*^9, 3.391944629798684*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["x", "i"], "=", 
  RowBox[{"6", "\[Lambda]", 
   FractionBox[
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "n"], 
     RowBox[{
      SubscriptBox["\[Rho]", "ij"], 
      RowBox[{
       SubscriptBox["p", "j"], "[", 
       SuperscriptBox["x", "*"], "]"}], 
      RowBox[{
       SubscriptBox["\[Sigma]", "j"], "[", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["x", "*"], ")"}], "j"], "]"}]}]}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SubscriptBox["\[Sigma]", "i"], "[", "0", "]"}]], "+", 
      FractionBox["4", 
       RowBox[{
        SubscriptBox["\[Sigma]", "i"], "[", 
        RowBox[{
         SubscriptBox["x", "i"], "/", "2"}], "]"}]], "+", 
      FractionBox["1", 
       RowBox[{
        SubscriptBox["\[Sigma]", "i"], "[", 
        SubscriptBox["x", "i"], "]"}]]}], ")"}]]}]}]], "Text",
 CellChangeTimes->{{3.3919446904873495`*^9, 3.3919447279411936`*^9}}],

Cell["and the equations : ", "Text",
 CellChangeTimes->{{3.391944737035118*^9, 3.391944741566455*^9}, 
   3.3919448044739127`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], "n"], 
   RowBox[{
    SubscriptBox["w", "i"], 
    SubscriptBox["F", "i"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", "\[Lambda]", 
      FractionBox[
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", "1"}], "n"], 
        RowBox[{
         SubscriptBox["\[Rho]", "ij"], 
         RowBox[{
          SubscriptBox["p", "j"], "[", 
          SuperscriptBox["x", "*"], "]"}], 
         RowBox[{
          SubscriptBox["\[Sigma]", "j"], "[", 
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["x", "*"], ")"}], "j"], "]"}]}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SubscriptBox["\[Sigma]", "i"], "[", "0", "]"}]], "+", 
         FractionBox["4", 
          RowBox[{
           SubscriptBox["\[Sigma]", "i"], "[", 
           RowBox[{
            SubscriptBox["x", "i"], "/", "2"}], "]"}]], "+", 
         FractionBox["1", 
          RowBox[{
           SubscriptBox["\[Sigma]", "i"], "[", 
           SubscriptBox["x", "i"], "]"}]]}], ")"}]]}]]}]}], "=", 
  "B"}]], "Text",
 CellChangeTimes->{3.391944765832546*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IterationOptimizep", "[", 
   RowBox[{"ruleSet_", ",", "B_", ",", "leglst_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]", ",", "p1", ",", "xbar", ",", "BF", ",", "\[Sigma]B0", ",", 
      "\[Sigma]F", ",", "\[Sigma]Fi", ",", "\[Sigma]Fm", ",", "\[Sigma]B01", 
      ",", "pF", ",", "xi1", ",", "xi2", ",", "\[Lambda]1", ",", "\[Lambda]2",
       ",", "egalites1", ",", "egalites2", ",", "X1", ",", "X2", ",", "sol"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xi1", "=", 
      RowBox[{"ruleSet", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]1", "=", 
      RowBox[{"ruleSet", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"BF", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"forwardVec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", 
         RowBox[{"Weigths", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pF", "=", 
      RowBox[{"p", "[", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]F", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"DupireVolSABR1", "[", 
         RowBox[{
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "Maturity", ",", 
          RowBox[{"alphaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"betaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"rhoVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nuVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]Fm", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"DupireVolSABR1", "[", 
         RowBox[{
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"forwardVec", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"xi1", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "/", "2"}], "]"}]}], ",", 
          "Maturity", ",", 
          RowBox[{"alphaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"betaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"rhoVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nuVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]Fi", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"DupireVolSABR1", "[", 
         RowBox[{
          RowBox[{"forwardVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"forwardVec", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"xi1", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", "Maturity", ",", 
          RowBox[{"alphaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"betaVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"rhoVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"nuVec", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<BF=\>\"", ",", "BF", ",", "\"\< \[Sigma]F=\[InvisibleComma]\>\"", 
       ",", "\[Sigma]F", ",", "\"\< \[Sigma]Fm=\>\"", ",", "\[Sigma]Fm", ",", 
       "\"\< \[Sigma]Fi=\>\"", ",", "\[Sigma]Fi"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<BF=\>\"", ",", "BF", ",", "\"\< \[Sigma]F=\[InvisibleComma]\>\"", 
       ",", "\[Sigma]F", ",", "\"\< \[Sigma]Fm=\>\"", ",", "\[Sigma]Fm", ",", 
       "\"\< \[Sigma]Fi=\>\"", ",", "\[Sigma]Fi"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<BF=\>\"", ",", "BF", ",", "\"\< \[Sigma]F=\[InvisibleComma]\>\"", 
       ",", "\[Sigma]F", ",", "\"\< \[Sigma]Fm=\>\"", ",", "\[Sigma]Fm", ",", 
       "\"\< \[Sigma]Fi=\>\"", ",", "\[Sigma]Fi"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"p", "[", 
       RowBox[{
        RowBox[{"xi1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"xi1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"xi1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"xi1", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"xi1", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", 
        RowBox[{"xi1", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<p1=\>\"", ",", "p1"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"forwardVec", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", 
             RowBox[{"Weigths", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"2", 
               FractionBox["\[Lambda]", 
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"\[Sigma]F", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                 RowBox[{"1", "/", 
                  RowBox[{"\[Sigma]Fi", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}]], 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"CorrelationMatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], 
                  RowBox[{"p1", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], 
                  RowBox[{"\[Sigma]Fi", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], "-", "B"}], 
         "\[Equal]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "\[Lambda]1"}], "}"}], ",", 
        RowBox[{"MaxIterations", "\[Rule]", "10"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<sol(new \[Lambda])=\>\"", ",", "sol"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]2", "=", 
      RowBox[{"\[Lambda]", " ", "/.", " ", "sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"forwardVec", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", 
               RowBox[{"Weigths", "[", 
                RowBox[{"[", "i", "]"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{"6", 
                 FractionBox["\[Lambda]", 
                  RowBox[{
                   RowBox[{"1", "/", 
                    RowBox[{"\[Sigma]F", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"4", "/", 
                    RowBox[{"\[Sigma]Fm", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], 
                    RowBox[{"+", "1", "/", 
                    RowBox[{"\[Sigma]Fi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}]}]], 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"CorrelationMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], 
                    RowBox[{"\[Sigma]Fi", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], "-", "B"}], 
           "\[Equal]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", "\[Lambda]1"}], "}"}], ",", 
          RowBox[{"MaxIterations", "\[Rule]", "5"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<sol(new \[Lambda])=\>\"", ",", "sol"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2", "=", 
        RowBox[{"\[Lambda]", " ", "/.", " ", "sol"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"sol", "=", 
        RowBox[{"NewtonFindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"forwardVec", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", 
                RowBox[{"Weigths", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], 
                RowBox[{"Exp", "[", 
                 RowBox[{"2", 
                  FractionBox["#", 
                   RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"\[Sigma]F", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                    RowBox[{"1", "/", 
                    RowBox[{"\[Sigma]Fi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}]], 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"CorrelationMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], 
                    RowBox[{"\[Sigma]Fi", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], "-", "B"}],
             ")"}], "&"}], ",", "\[Lambda]1", ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"\[Lambda]1", "/", "100"}], "]"}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}], ",", "10"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<sol(new \[Lambda])=\>\"", ",", "sol"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"xi2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CorrelationMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], 
             RowBox[{"pF", "[", 
              RowBox[{"[", "j", "]"}], "]"}], 
             FractionBox[
              RowBox[{"6", "\[Lambda]2"}], 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"\[Sigma]F", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"4", "/", 
                 RowBox[{"\[Sigma]Fm", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], 
                RowBox[{"+", "1", "/", 
                 RowBox[{"\[Sigma]Fi", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}]}]], 
             RowBox[{"\[Sigma]F", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"xi2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CorrelationMatrix", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"pF", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           FractionBox[
            RowBox[{"2", "\[Lambda]2", " ", 
             RowBox[{"\[Sigma]F", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"\[Sigma]F", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "+", 
             RowBox[{"1", "/", 
              RowBox[{"\[Sigma]Fi", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Lambda]=\>\"", ",", "\[Lambda]2", ",", "\"\< xi=\>\"", ",", 
       "xi2"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"egalites1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"X1", "=", 
           RowBox[{"eqnGauche", "[", 
            RowBox[{"i", ",", "leglst", ",", 
             RowBox[{"xi2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"X2", "=", 
           RowBox[{"\[Lambda]2", " ", 
            RowBox[{"eqnDroite", "[", 
             RowBox[{"i", ",", 
              RowBox[{"xi2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"xi2", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"xi2", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"xi2", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"xi2", "[", 
               RowBox[{"[", "5", "]"}], "]"}], ",", 
              RowBox[{"xi2", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"X1", "-", "X2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"egalites2", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"X1", "=", 
         RowBox[{"ForwardBasket", "[", 
          RowBox[{
           RowBox[{"xi2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"xi2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"xi2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"xi2", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"xi2", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", 
           RowBox[{"xi2", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"X2", "=", "B"}], ",", 
        RowBox[{"X1", "-", "X2"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<equ1=\>\"", ",", 
       RowBox[{"egalites1", "//", " ", "ColumnForm"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<equ2=\>\"", ",", "egalites2"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"xi2", ",", "\[Lambda]2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3919361973029675`*^9, 3.391936257336907*^9}, {
   3.3919362908381357`*^9, 3.391936372371995*^9}, {3.391936428264408*^9, 
   3.3919365202361016`*^9}, 3.3919368477898974`*^9, {3.3919369296195936`*^9, 
   3.391936965479657*^9}, {3.3919370305121555`*^9, 3.3919370347778625`*^9}, {
   3.3919373311429276`*^9, 3.391937335799267*^9}, {3.3919387411231236`*^9, 
   3.39193889250103*^9}, {3.3919389285017214`*^9, 3.3919390045344315`*^9}, {
   3.391939086364127*^9, 3.391939161381192*^9}, {3.3919391946162057`*^9, 
   3.3919392071789465`*^9}, {3.3919392483203616`*^9, 3.39193933027506*^9}, {
   3.39193997453743*^9, 3.3919399853032618`*^9}, {3.3919402366362123`*^9, 
   3.391940381904626*^9}, {3.3919405367513494`*^9, 3.391940553314167*^9}, {
   3.3919411085123267`*^9, 3.391941119731292*^9}, {3.3919414204870663`*^9, 
   3.391941467534845*^9}, {3.3919417146020885`*^9, 3.391941752602818*^9}, {
   3.391941906699527*^9, 3.3919419189653873`*^9}, {3.3919425133830495`*^9, 
   3.391942517242499*^9}, {3.391942556305749*^9, 3.391942560696458*^9}, {
   3.3919432268811235`*^9, 3.391943255334795*^9}, {3.391943440947734*^9, 
   3.3919435132772474`*^9}, {3.391944015302511*^9, 3.39194404545934*^9}, {
   3.391944937679595*^9, 3.3919449486798067`*^9}, {3.391944980524168*^9, 
   3.391944984477369*^9}, {3.3919452407947903`*^9, 3.3919453035772457`*^9}, {
   3.3919454327359753`*^9, 3.3919454573301973`*^9}, 3.3919454978778505`*^9, {
   3.3919456417868643`*^9, 3.3919456441619096`*^9}, {3.3919490863061223`*^9, 
   3.3919491357133207`*^9}, {3.3919493494986753`*^9, 3.3919493504361935`*^9}}],\


Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"leglst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], ",", 
     RowBox[{"iter", "=", "1"}], ",", 
     RowBox[{"B", "=", "0.4"}], ",", "sol1", ",", "sol2"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol1", "=", 
     RowBox[{"ApproximatedOptimizep", "[", 
      RowBox[{"B", ",", "leglst"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sol2", "=", 
        RowBox[{"IterationOptimizep", "[", 
         RowBox[{"sol1", ",", "B", ",", "leglst"}], "]"}]}], ";", 
       RowBox[{"sol1", "=", "sol2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "iter"}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.391939642609182*^9, 3.391939737673507*^9}, {
   3.391942575368615*^9, 3.3919426506200595`*^9}, {3.391942681355025*^9, 
   3.39194268187066*^9}, {3.3919449928994055`*^9, 3.391944993196286*^9}, {
   3.391945081401105*^9, 3.3919451294176517`*^9}, {3.391945588426464*^9, 
   3.3919455894264836`*^9}, {3.391948996398146*^9, 3.391948996929406*^9}, {
   3.391949177167242*^9, 3.3919492066678085`*^9}, 3.3919492391215563`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BF=\"\>", "\[InvisibleSpace]", "0.2542984858577529`", 
   "\[InvisibleSpace]", "\<\" \[Sigma]F=\[InvisibleComma]\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.02092544128208726`", ",", "0.02180345837192897`", ",", 
     "0.022825982012882357`", ",", "0.01982326153064346`", ",", 
     "0.01605257248194355`", ",", "0.015370739964620498`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]B0=\"\>", "\[InvisibleSpace]", 
   "0.018482559773725152`", "\[InvisibleSpace]", "\<\" xbar=\"\>", 
   "\[InvisibleSpace]", "0.45295582885511393`"}],
  SequenceForm[
  "BF=", 0.2542984858577529, " \[Sigma]F=\[InvisibleComma]", {
   0.02092544128208726, 0.02180345837192897, 0.022825982012882357`, 
   0.01982326153064346, 0.01605257248194355, 0.015370739964620498`}, 
   " \[Sigma]B0=", 0.018482559773725152`, " xbar=", 0.45295582885511393`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.391949357186323*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Lambda]=\"\>", "\[InvisibleSpace]", "1325.963636126654`", 
   "\[InvisibleSpace]", "\<\" xi=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.46212673294406553`", ",", "0.5129275374265477`", ",", 
     "0.553062936441261`", ",", "0.47720392128192857`", ",", 
     "0.3718457458919686`", ",", "0.34895475818851224`"}], "}"}]}],
  SequenceForm[
  "\[Lambda]=", 1325.963636126654, " xi=", {0.46212673294406553`, 
   0.5129275374265477, 0.553062936441261, 0.47720392128192857`, 
   0.3718457458919686, 0.34895475818851224`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.391949357186323*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"equ1=\"\>", "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{"17.779627456728164`", ",", "37.31426151438459`", ",", 
         RowBox[{"-", "19.534634057656426`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"19.28550500965847`", ",", "39.505451472472934`", ",", 
         RowBox[{"-", "20.219946462814466`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"21.91196565038161`", ",", "40.26752233650539`", ",", 
         RowBox[{"-", "18.355556686123776`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"23.15123450140802`", ",", "39.604767686162496`", ",", 
         RowBox[{"-", "16.453533184754477`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"23.281023335257654`", ",", "37.72244835607398`", ",", 
         RowBox[{"-", "14.441425020816329`"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"23.271116330109766`", ",", "36.85747934537963`", ",", 
         RowBox[{"-", "13.586363015269864`"}]}], "}"}]}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{{17.779627456728164`, 
     37.31426151438459, -19.534634057656426`}, {19.28550500965847, 
     39.505451472472934`, -20.219946462814466`}, {21.91196565038161, 
     40.26752233650539, -18.355556686123776`}, {23.15123450140802, 
     39.604767686162496`, -16.453533184754477`}, {23.281023335257654`, 
     37.72244835607398, -14.441425020816329`}, {23.271116330109766`, 
     36.85747934537963, -13.586363015269864`}}],
    Editable->False]}],
  SequenceForm["equ1=", 
   ColumnForm[{{17.779627456728164`, 
    37.31426151438459, -19.534634057656426`}, {19.28550500965847, 
    39.505451472472934`, -20.219946462814466`}, {21.91196565038161, 
    40.26752233650539, -18.355556686123776`}, {23.15123450140802, 
    39.604767686162496`, -16.453533184754477`}, {23.281023335257654`, 
    37.72244835607398, -14.441425020816329`}, {23.271116330109766`, 
    36.85747934537963, -13.586363015269864`}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.391949357389452*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"equ2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.4010627470831216`", ",", "0.4`", ",", "0.0010627470831215957`"}], 
    "}"}]}],
  SequenceForm["equ2=", {0.4010627470831216, 0.4, 0.0010627470831215957`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.391949357420703*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BF=\"\>", "\[InvisibleSpace]", "0.2542984858577529`", 
   "\[InvisibleSpace]", "\<\" \[Sigma]F=\[InvisibleComma]\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.02092544128208726`", ",", "0.02180345837192897`", ",", 
     "0.022825982012882357`", ",", "0.01982326153064346`", ",", 
     "0.01605257248194355`", ",", "0.015370739964620498`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]Fm=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.025506751387042344`", ",", "0.025906853801203226`", ",", 
     "0.02385749747121317`", ",", "0.019250944031914297`", ",", 
     "0.01494054335950091`", ",", "0.014039654597689381`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]Fi=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.039479117437831016`", ",", "0.04142799475156941`", ",", 
     "0.039028720223934256`", ",", "0.030060320144638133`", ",", 
     "0.021328293297462646`", ",", "0.019366016227220024`"}], "}"}]}],
  SequenceForm[
  "BF=", 0.2542984858577529, " \[Sigma]F=\[InvisibleComma]", {
   0.02092544128208726, 0.02180345837192897, 0.022825982012882357`, 
   0.01982326153064346, 0.01605257248194355, 0.015370739964620498`}, 
   " \[Sigma]Fm=", {0.025506751387042344`, 0.025906853801203226`, 
   0.02385749747121317, 0.019250944031914297`, 0.01494054335950091, 
   0.014039654597689381`}, " \[Sigma]Fi=", {0.039479117437831016`, 
   0.04142799475156941, 0.039028720223934256`, 0.030060320144638133`, 
   0.021328293297462646`, 0.019366016227220024`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.391949357467579*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BF=\"\>", "\[InvisibleSpace]", "0.2542984858577529`", 
   "\[InvisibleSpace]", "\<\" \[Sigma]F=\[InvisibleComma]\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.02092544128208726`", ",", "0.02180345837192897`", ",", 
     "0.022825982012882357`", ",", "0.01982326153064346`", ",", 
     "0.01605257248194355`", ",", "0.015370739964620498`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]Fm=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.025506751387042344`", ",", "0.025906853801203226`", ",", 
     "0.02385749747121317`", ",", "0.019250944031914297`", ",", 
     "0.01494054335950091`", ",", "0.014039654597689381`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]Fi=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.039479117437831016`", ",", "0.04142799475156941`", ",", 
     "0.039028720223934256`", ",", "0.030060320144638133`", ",", 
     "0.021328293297462646`", ",", "0.019366016227220024`"}], "}"}]}],
  SequenceForm[
  "BF=", 0.2542984858577529, " \[Sigma]F=\[InvisibleComma]", {
   0.02092544128208726, 0.02180345837192897, 0.022825982012882357`, 
   0.01982326153064346, 0.01605257248194355, 0.015370739964620498`}, 
   " \[Sigma]Fm=", {0.025506751387042344`, 0.025906853801203226`, 
   0.02385749747121317, 0.019250944031914297`, 0.01494054335950091, 
   0.014039654597689381`}, " \[Sigma]Fi=", {0.039479117437831016`, 
   0.04142799475156941, 0.039028720223934256`, 0.030060320144638133`, 
   0.021328293297462646`, 0.019366016227220024`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.391949357498829*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BF=\"\>", "\[InvisibleSpace]", "0.2542984858577529`", 
   "\[InvisibleSpace]", "\<\" \[Sigma]F=\[InvisibleComma]\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.02092544128208726`", ",", "0.02180345837192897`", ",", 
     "0.022825982012882357`", ",", "0.01982326153064346`", ",", 
     "0.01605257248194355`", ",", "0.015370739964620498`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]Fm=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.025506751387042344`", ",", "0.025906853801203226`", ",", 
     "0.02385749747121317`", ",", "0.019250944031914297`", ",", 
     "0.01494054335950091`", ",", "0.014039654597689381`"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \[Sigma]Fi=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.039479117437831016`", ",", "0.04142799475156941`", ",", 
     "0.039028720223934256`", ",", "0.030060320144638133`", ",", 
     "0.021328293297462646`", ",", "0.019366016227220024`"}], "}"}]}],
  SequenceForm[
  "BF=", 0.2542984858577529, " \[Sigma]F=\[InvisibleComma]", {
   0.02092544128208726, 0.02180345837192897, 0.022825982012882357`, 
   0.01982326153064346, 0.01605257248194355, 0.015370739964620498`}, 
   " \[Sigma]Fm=", {0.025506751387042344`, 0.025906853801203226`, 
   0.02385749747121317, 0.019250944031914297`, 0.01494054335950091, 
   0.014039654597689381`}, " \[Sigma]Fi=", {0.039479117437831016`, 
   0.04142799475156941, 0.039028720223934256`, 0.030060320144638133`, 
   0.021328293297462646`, 0.019366016227220024`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.3919493575457053`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"p1=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.1602312472222718`", ",", "0.17009001229694456`", ",", 
     "0.18244431264605832`", ",", "0.17460301599012226`", ",", 
     "0.15884567989238246`", ",", "0.15378573195222073`"}], "}"}]}],
  SequenceForm[
  "p1=", {0.1602312472222718, 0.17009001229694456`, 0.18244431264605832`, 
   0.17460301599012226`, 0.15884567989238246`, 0.15378573195222073`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.391949357592581*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"sol(new \[Lambda])=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]$150911", "\[Rule]", "642.5094756283182`"}], "}"}]}],
  SequenceForm[
  "sol(new \[Lambda])=", {$CellContext`\[Lambda]$150911 -> 
    642.5094756283182}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.3919493576238317`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Lambda]=\"\>", "\[InvisibleSpace]", "642.5094756283182`", 
   "\[InvisibleSpace]", "\<\" xi=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.2927094409586648`", ",", "0.3256826959074241`", ",", 
     "0.33819257153147114`", ",", "0.2786877603226289`", ",", 
     "0.20561153932214846`", ",", "0.18853764332243672`"}], "}"}]}],
  SequenceForm[
  "\[Lambda]=", 642.5094756283182, " xi=", {0.2927094409586648, 
   0.3256826959074241, 0.33819257153147114`, 0.2786877603226289, 
   0.20561153932214846`, 0.18853764332243672`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.3919493576707077`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"equ1=\"\>", "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
        "12.698278887572664`", ",", "12.63591877830876`", ",", 
         "0.06236010926390456`"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "13.873993521219315`", ",", "13.357704997360935`", ",", 
         "0.5162885238583801`"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "15.137989168885825`", ",", "13.610148293114532`", ",", 
         "1.5278408757712931`"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "15.018884747525771`", ",", "13.389724660872815`", ",", 
         "1.6291600866529556`"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "13.905009829262656`", ",", "12.761486820255561`", ",", 
         "1.1435230090070956`"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "13.415456045216613`", ",", "12.473192326829496`", ",", 
         "0.9422637183871174`"}], "}"}]}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{{12.698278887572664`, 12.63591877830876, 
     0.06236010926390456}, {13.873993521219315`, 13.357704997360935`, 
     0.5162885238583801}, {15.137989168885825`, 13.610148293114532`, 
     1.5278408757712931`}, {15.018884747525771`, 13.389724660872815`, 
     1.6291600866529556`}, {13.905009829262656`, 12.761486820255561`, 
     1.1435230090070956`}, {13.415456045216613`, 12.473192326829496`, 
     0.9422637183871174}}],
    Editable->False]}],
  SequenceForm["equ1=", 
   ColumnForm[{{12.698278887572664`, 12.63591877830876, 
    0.06236010926390456}, {13.873993521219315`, 13.357704997360935`, 
    0.5162885238583801}, {15.137989168885825`, 13.610148293114532`, 
    1.5278408757712931`}, {15.018884747525771`, 13.389724660872815`, 
    1.6291600866529556`}, {13.905009829262656`, 12.761486820255561`, 
    1.1435230090070956`}, {13.415456045216613`, 12.473192326829496`, 
    0.9422637183871174}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.3919493577019577`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"equ2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.33374434905225014`", ",", "0.4`", ",", 
     RowBox[{"-", "0.06625565094774988`"}]}], "}"}]}],
  SequenceForm["equ2=", {0.33374434905225014`, 0.4, -0.06625565094774988}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.391941046683015*^9, 3.391941517910812*^9, 3.3919420670463552`*^9, 
   3.391942182986081*^9, 3.391942279159803*^9, 3.3919424433035793`*^9, 
   3.391942525945791*^9, 3.391942568227853*^9, {3.3919426007753525`*^9, 
   3.3919426513700743`*^9}, 3.3919426823394184`*^9, 3.39194353138697*^9, 
   3.3919440505219374`*^9, 3.391944994352558*^9, {3.391945082151119*^9, 
   3.391945130011413*^9}, 3.391945334343461*^9, 3.3919454625646725`*^9, 
   3.3919455040967207`*^9, 3.3919455910983906`*^9, 3.391948998882569*^9, 
   3.391949147182291*^9, {3.3919491779172564`*^9, 3.3919492074021974`*^9}, 
   3.3919492398715706`*^9, 3.3919493577332087`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1154, 932},
WindowMargins->{{Automatic, -3}, {32, Automatic}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (April 20, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 155, 4, 31, "Input",
 InitializationCell->True],
Cell[726, 27, 225, 5, 31, "Input",
 InitializationCell->True],
Cell[954, 34, 269, 6, 31, "Input",
 InitializationCell->True],
Cell[1226, 42, 1496, 46, 54, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[2747, 92, 705, 21, 31, "Input"],
Cell[3455, 115, 5742, 100, 244, "Output"]
}, Open  ]],
Cell[9212, 218, 4562, 122, 297, "Input",
 InitializationCell->True],
Cell[13777, 342, 6749, 179, 385, "Input",
 InitializationCell->True],
Cell[20529, 523, 6829, 181, 416, "Input",
 InitializationCell->True],
Cell[27361, 706, 9509, 250, 517, "Input",
 InitializationCell->True],
Cell[36873, 958, 1566, 38, 142, "Input",
 InitializationCell->True],
Cell[38442, 998, 1080, 26, 117, "Input",
 InitializationCell->True],
Cell[39525, 1026, 1592, 38, 142, "Input",
 InitializationCell->True],
Cell[41120, 1066, 1050, 25, 117, "Input",
 InitializationCell->True],
Cell[42173, 1093, 786, 15, 52, "Input",
 InitializationCell->True],
Cell[42962, 1110, 823, 16, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[43810, 1130, 923, 23, 52, "Input"],
Cell[44736, 1155, 258, 3, 30, "Output"]
}, Open  ]],
Cell[45009, 1161, 915, 22, 52, "Input",
 InitializationCell->True],
Cell[45927, 1185, 229, 8, 57, "Input",
 InitializationCell->True],
Cell[46159, 1195, 888, 28, 58, "Input",
 InitializationCell->True],
Cell[47050, 1225, 455, 15, 61, "Text"],
Cell[47508, 1242, 3778, 106, 174, "Input",
 InitializationCell->True],
Cell[51289, 1350, 2140, 46, 77, "Input",
 InitializationCell->True],
Cell[53432, 1398, 2229, 47, 55, "Input",
 InitializationCell->True],
Cell[55664, 1447, 2249, 47, 76, "Input",
 InitializationCell->True],
Cell[57916, 1496, 2261, 47, 76, "Input",
 InitializationCell->True],
Cell[60180, 1545, 2263, 47, 76, "Input",
 InitializationCell->True],
Cell[62448, 1595, 1901, 39, 52, "Input",
 InitializationCell->True],
Cell[64352, 1636, 1949, 40, 52, "Input",
 InitializationCell->True],
Cell[66304, 1678, 1959, 40, 52, "Input",
 InitializationCell->True],
Cell[68266, 1720, 2019, 41, 52, "Input",
 InitializationCell->True],
Cell[70288, 1763, 2016, 41, 52, "Input",
 InitializationCell->True],
Cell[72307, 1806, 3081, 70, 159, "Input",
 InitializationCell->True],
Cell[75391, 1878, 3037, 70, 159, "Input",
 InitializationCell->True],
Cell[78431, 1950, 3079, 70, 158, "Input",
 InitializationCell->True],
Cell[81513, 2022, 3199, 71, 158, "Input",
 InitializationCell->True],
Cell[84715, 2095, 3199, 71, 158, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[87939, 2170, 765, 19, 31, "Input"],
Cell[88707, 2191, 319, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89063, 2201, 121, 2, 31, "Input"],
Cell[89187, 2205, 116, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89340, 2211, 1815, 35, 31, "Input"],
Cell[91158, 2248, 6723, 114, 243, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97918, 2367, 1873, 36, 31, "Input"],
Cell[99794, 2405, 6970, 118, 235, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106801, 2528, 1607, 34, 39, "Input"],
Cell[108411, 2564, 10950, 186, 238, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119398, 2755, 1553, 33, 39, "Input"],
Cell[120954, 2790, 11455, 194, 238, "Output"]
}, Open  ]],
Cell[132424, 2987, 40, 0, 31, "Input"],
Cell[CellGroupData[{
Cell[132489, 2991, 1557, 33, 39, "Input"],
Cell[134049, 3026, 8707, 150, 235, "Output"]
}, Open  ]],
Cell[142771, 3179, 147, 4, 34, "Input"],
Cell[CellGroupData[{
Cell[142943, 3187, 1964, 39, 39, "Input"],
Cell[144910, 3228, 13061, 216, 235, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158008, 3449, 2064, 40, 39, "Input"],
Cell[160075, 3491, 11506, 190, 235, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171618, 3686, 101, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[171744, 3691, 144, 2, 36, "Subsection"],
Cell[171891, 3695, 291, 8, 31, "Input"],
Cell[172185, 3705, 75, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[172285, 3711, 243, 5, 31, "Input"],
Cell[172531, 3718, 483, 7, 30, "Output"]
}, Open  ]],
Cell[173029, 3728, 244, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[173298, 3740, 1559, 43, 52, "Input"],
Cell[174860, 3785, 773, 13, 30, "Output"]
}, Open  ]],
Cell[175648, 3801, 1093, 32, 112, "Input"],
Cell[CellGroupData[{
Cell[176766, 3837, 149, 3, 31, "Input"],
Cell[176918, 3842, 663, 12, 30, "Output"]
}, Open  ]],
Cell[177596, 3857, 96, 1, 31, "Input"],
Cell[177695, 3860, 187, 4, 29, "Text"],
Cell[CellGroupData[{
Cell[177907, 3868, 290, 7, 31, "Input"],
Cell[178200, 3877, 670, 12, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178907, 3894, 237, 6, 31, "Input"],
Cell[179147, 3902, 599, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179783, 3918, 234, 6, 31, "Input"],
Cell[180020, 3926, 590, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180647, 3941, 951, 26, 31, "Input"],
Cell[181603, 3970, 609, 11, 30, "Output"]
}, Open  ]],
Cell[182227, 3984, 112, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[182364, 3989, 851, 20, 31, "Input"],
Cell[CellGroupData[{
Cell[183240, 4013, 276, 6, 23, "Print"],
Cell[183519, 4021, 313, 7, 23, "Print"],
Cell[183835, 4030, 305, 6, 23, "Print"],
Cell[184143, 4038, 296, 6, 23, "Print"],
Cell[184442, 4046, 303, 6, 23, "Print"],
Cell[184748, 4054, 298, 6, 23, "Print"],
Cell[185049, 4062, 303, 6, 23, "Print"],
Cell[185355, 4070, 299, 6, 23, "Print"],
Cell[185657, 4078, 278, 6, 23, "Print"],
Cell[185938, 4086, 311, 7, 23, "Print"],
Cell[186252, 4095, 305, 6, 23, "Print"],
Cell[186560, 4103, 297, 6, 23, "Print"],
Cell[186860, 4111, 305, 6, 23, "Print"],
Cell[187168, 4119, 301, 6, 23, "Print"],
Cell[187472, 4127, 305, 6, 23, "Print"],
Cell[187780, 4135, 301, 6, 23, "Print"],
Cell[188084, 4143, 278, 6, 23, "Print"],
Cell[188365, 4151, 311, 7, 23, "Print"],
Cell[188679, 4160, 302, 6, 23, "Print"],
Cell[188984, 4168, 297, 6, 23, "Print"],
Cell[189284, 4176, 305, 6, 23, "Print"],
Cell[189592, 4184, 299, 6, 23, "Print"],
Cell[189894, 4192, 305, 6, 23, "Print"],
Cell[190202, 4200, 296, 6, 23, "Print"],
Cell[190501, 4208, 276, 6, 23, "Print"],
Cell[190780, 4216, 309, 7, 23, "Print"],
Cell[191092, 4225, 303, 6, 23, "Print"],
Cell[191398, 4233, 292, 6, 23, "Print"],
Cell[191693, 4241, 303, 6, 23, "Print"],
Cell[191999, 4249, 298, 6, 23, "Print"],
Cell[192300, 4257, 303, 6, 23, "Print"],
Cell[192606, 4265, 298, 6, 23, "Print"],
Cell[192907, 4273, 278, 6, 23, "Print"],
Cell[193188, 4281, 315, 7, 23, "Print"],
Cell[193506, 4290, 305, 6, 23, "Print"],
Cell[193814, 4298, 297, 6, 23, "Print"],
Cell[194114, 4306, 305, 6, 23, "Print"],
Cell[194422, 4314, 296, 6, 23, "Print"],
Cell[194721, 4322, 305, 6, 23, "Print"],
Cell[195029, 4330, 298, 6, 23, "Print"],
Cell[195330, 4338, 278, 6, 23, "Print"],
Cell[195611, 4346, 311, 7, 23, "Print"],
Cell[195925, 4355, 300, 6, 23, "Print"],
Cell[196228, 4363, 295, 6, 23, "Print"],
Cell[196526, 4371, 305, 6, 23, "Print"],
Cell[196834, 4379, 300, 6, 23, "Print"],
Cell[197137, 4387, 305, 6, 23, "Print"],
Cell[197445, 4395, 301, 6, 23, "Print"]
}, Open  ]],
Cell[197761, 4404, 671, 11, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[198481, 4421, 118, 1, 36, "Subsection"],
Cell[198602, 4424, 5006, 146, 492, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203645, 4575, 161, 2, 36, "Subsection"],
Cell[203809, 4579, 952, 25, 92, "Input"],
Cell[204764, 4606, 121, 1, 29, "Text"],
Cell[204888, 4609, 220, 4, 29, "Text"],
Cell[205111, 4615, 6147, 138, 332, "Input"],
Cell[CellGroupData[{
Cell[211283, 4757, 146, 2, 31, "Input"],
Cell[211432, 4761, 745, 12, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[212238, 4780, 101, 1, 71, "Section"],
Cell[212342, 4783, 160, 2, 29, "Text"],
Cell[212505, 4787, 258, 7, 31, "Input",
 InitializationCell->True],
Cell[212766, 4796, 939, 28, 33, "Input",
 InitializationCell->True],
Cell[213708, 4826, 2481, 66, 119, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[216214, 4896, 306, 6, 31, "Input"],
Cell[216523, 4904, 374, 7, 30, "Output"]
}, Open  ]],
Cell[216912, 4914, 108, 1, 29, "Text"],
Cell[217023, 4917, 1843, 40, 72, "Input",
 InitializationCell->True],
Cell[218869, 4959, 2266, 56, 72, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[221160, 5019, 555, 12, 31, "Input"],
Cell[221718, 5033, 209, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221964, 5041, 637, 14, 31, "Input"],
Cell[222604, 5057, 261, 4, 30, "Output"]
}, Open  ]],
Cell[222880, 5064, 198, 4, 31, "Input"],
Cell[223081, 5070, 5462, 127, 241, "Input",
 InitializationCell->True],
Cell[228546, 5199, 6112, 144, 262, "Input",
 InitializationCell->True],
Cell[234661, 5345, 282, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[234968, 5355, 346, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[235339, 5365, 1044, 21, 23, "Print"],
Cell[236386, 5388, 864, 20, 23, "Print"],
Cell[237253, 5410, 1979, 53, 98, "Print"],
Cell[239235, 5465, 335, 8, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[239597, 5477, 7454, 182, 350, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[247076, 5663, 290, 7, 31, "Input"],
Cell[247369, 5672, 213, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247619, 5680, 131, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[247775, 5686, 3219, 71, 98, "Print"],
Cell[250997, 5759, 1152, 21, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[252176, 5784, 7918, 186, 333, "Input",
 InitializationCell->True],
Cell[260097, 5972, 2077, 54, 333, "Input",
 InitializationCell->True],
Cell[262177, 6028, 108, 1, 29, "Text"],
Cell[262288, 6031, 746, 24, 53, "Text"],
Cell[263037, 6057, 391, 12, 51, "Text"],
Cell[263431, 6071, 132, 1, 29, "Text"],
Cell[263566, 6074, 796, 26, 46, "Text"],
Cell[264365, 6102, 100, 1, 29, "Text"],
Cell[264468, 6105, 1006, 32, 64, "Text"],
Cell[265477, 6139, 130, 2, 29, "Text"],
Cell[265610, 6143, 1240, 39, 72, "Text"],
Cell[266853, 6184, 18262, 438, 946, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[285142, 6627, 1297, 29, 112, "Input"],
Cell[CellGroupData[{
Cell[286464, 6660, 1587, 28, 23, "Print"],
Cell[288054, 6690, 1274, 23, 23, "Print"],
Cell[289331, 6715, 2844, 59, 98, "Print"],
Cell[292178, 6776, 961, 18, 23, "Print"],
Cell[293142, 6796, 2250, 41, 43, "Print"],
Cell[295395, 6839, 2250, 41, 43, "Print"],
Cell[297648, 6882, 2252, 41, 43, "Print"],
Cell[299903, 6925, 1153, 21, 23, "Print"],
Cell[301059, 6948, 978, 18, 23, "Print"],
Cell[302040, 6968, 1278, 23, 23, "Print"],
Cell[303321, 6993, 2825, 65, 98, "Print"],
Cell[306149, 7060, 973, 17, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
